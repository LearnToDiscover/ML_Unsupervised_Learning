<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Machine Learning - Supervised: Classification</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png"><link rel="manifest" href="site.webmanifest"><link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav l2d"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="l2d" src="assets/images/l2d-logo.svg"></div>
    </div>
    <div class="selector-container">


      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/01-classification_intro.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav l2d" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="l2d" src="assets/images/l2d-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Machine Learning - Supervised
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Machine Learning - Supervised
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"></ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Machine Learning - Supervised
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 0%" class="percentage">
    0%
  </div>
  <div class="progress l2d">
    <div class="progress-bar l2d" role="progressbar" style="width: 0%" aria-valuenow="0" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar" style="display: flex">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle sticky-top" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner sticky-top">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/01-classification_intro.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        1. Classification
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#example-visual-classification">Example: Visual Classification</a></li>
<li><a href="#supervised-learning-training-a-model">Supervised Learning: Training a Model</a></li>
<li><a href="#scikit-learn">Scikit Learn</a></li>
<li><a href="#classification">Classification</a></li>
<li><a href="#application">Application</a></li>
<li><a href="#exercises">Exercises</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-improvement.html">2. Improvement</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>

                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="index.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="02-improvement.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="index.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Home
        </a>
        <a class="chapter-link float-end" href="02-improvement.html" rel="next">
          Next: Improvement...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Classification</h1>
        <p>Last updated on 2025-03-17 |

        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/01-classification_intro.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<p><a href="https://drive.usercontent.google.com/u/1/uc?id=16T85vbrDYu4Z62ryFA5xVHpwrl7okIvy&amp;export=download" class="external-link"><strong>Download
Chapter notebook (ipynb)</strong></a></p>
<p><a href="https://drive.usercontent.google.com/u/1/uc?id=1nb6HmNUYC4RXMHv3bVY0NvLBikw_cH0m&amp;export=download" class="external-link"><strong>Download
Chapter PDF</strong></a></p>
<p><a href="https://docs.google.com/forms/d/e/1FAIpQLSdr0capF7jloJhPH3Pki1B3LZoKOG16poOpuVJ7SL2LkwLHQA/viewform?pli=1" class="external-link"><span style="color: rgb(255, 0, 0);"><strong>Mandatory Lesson Feedback
Survey</strong></span></a></p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How to prepare data for classification?</li>
<li>Why do we need to train a model?</li>
<li>What does a state space plot represent?</li>
<li>How to obtain prediction probabilities?</li>
<li>What are the important features?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Understanding the classification challenge.</li>
<li>Training a classifier model.</li>
<li>Understanding the state space plot of model predictions.</li>
<li>Obtaining prediction probabilities.</li>
<li>Finding important features.</li>
</ul></div>
</div>
</div>
</div>
</div>
<div id="prereq1" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Prerequisite</h3>
<div class="callout-content">
<ul><li><a href="https://learntodiscover.github.io/Data_Handling/" class="external-link">Data
Handling</a></li>
<li><a href="index.html#numpy">Numpy arrays (see accompanying
tutorial)</a></li>
<li><a href="https://matplotlib.org" class="external-link">Basic Matplotlib plotting</a></li>
</ul></div>
</div>
</div>
<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/NIU1JO26Jgk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</p>
<br><p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/3f627wXK6z0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</p>
<br><p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/EUrxpMr5bG4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</p>
<p><br></p>
<div class="section level3">
<h3 id="import-functions"><strong>Import functions</strong><a class="anchor" aria-label="anchor" href="#import-functions"></a></h3>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">from</span> pandas <span class="im">import</span> read_csv</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> arange, asarray, linspace, c_, meshgrid, zeros, ones</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="im">from</span> numpy.random <span class="im">import</span> uniform, seed</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> subplots, scatter, xlabel, ylabel, xticks, show</span></code></pre>
</div>
</div>
<section><h2 class="section-heading" id="example-visual-classification">Example: Visual Classification<a class="anchor" aria-label="anchor" href="#example-visual-classification"></a></h2>
<hr class="half-width"><p>Import the ‘patients_data’ toy dataset and scatter the data for
Height and Weight.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Please adjust your path to the file</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>df <span class="op">=</span> read_csv(<span class="st">'data/patients_data.csv'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="bu">print</span>(df.shape)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co"># Convert inches to cm and pounds to kg:</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>df[<span class="st">'Height'</span>] <span class="op">=</span> <span class="fl">2.540</span><span class="op">*</span>df[<span class="st">'Height'</span>]</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>df[<span class="st">'Weight'</span>] <span class="op">=</span> <span class="fl">0.454</span><span class="op">*</span>df[<span class="st">'Weight'</span>]</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>df.head(<span class="dv">10</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>(100, 8)
   Age  Height  Weight  Systolic  Diastolic  Smoker  Gender  Peak Flow
0   38  180.34  79.904       124         93       1    Male        200
1   43  175.26  74.002       109         77       0    Male        615
2   38  162.56  59.474       125         83       0  Female        642
3   40  170.18  60.382       117         75       0  Female        511
4   49  162.56  54.026       122         80       0  Female        497
5   46  172.72  64.468       121         70       0  Female        528
6   33  162.56  64.468       130         88       1  Female        269
7   40  172.72  81.720       115         82       0    Male        324
8   28  172.72  83.082       115         78       0    Male        501
9   31  167.64  59.928       118         86       0  Female        723</code></pre>
</div>
<p style="text-align: justify;">
Note that data in the first five columns are either integers (age) or
real numbers (floating point). The classes (categorical data) in the
last two columns come as binary (0/1) for ‘smokers/non-smokers’ and as
strings for ‘male/female’. Both can be used for classification.
</p>
<div id="the-classification-challenge" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="the-classification-challenge" class="callout-inner">
<h3 class="callout-title">The classification challenge</h3>
<div class="callout-content">
<p style="text-align: justify;">
I am given a set of data from a single subject and feed them to a
computational model. The model then predicts to what (predefined)
<em>class</em> this subject belongs. Example: given height and weight
data, the model might try to predict whether the subject is a smoker or
a non-smoker. A naive model will, of course, not be able to predict
reasonably. The <em>supervised</em> approach in machine learning is to
provide the model with a set of data where the class has been verified
beforehand and the model can test its (initially random) predictions
against the provided class. An optimisation algorithm is then run to
adjust the (internal) model setting such that the predictions improve as
much as possible. When no further improvement is achieved, the algorithm
stops. The model is then <em>trained</em> and ready to predict.
</p>
</div>
</div>
</div>
<p style="text-align: justify;">
The act of classification is to assign labels to unlabelled data after
model exposure to previously labelled data (e.g. based on medical
knowledge in the case of disease data).
</p>
<p style="text-align: justify;">
In contrast, in <em>unsupervised machine learning</em> the assignment is
done based on exposure to unlabelled data following a search for
distinctive features or ‘structure’ in the data.
</p>
<p style="text-align: justify;">
We can first check if we are able to distinguish classes visually. For
this, we scatter the data of two columns of a dataframe using the column
names. That is, we look at the distribution of points in a plane. Then
we use the class <strong>label</strong> to color each point in the plane
according to the class it belongs to. String labels like ‘male’ /
‘female’ first need to be converted to Boolean (binary). 0/1 labels as
in the ‘smokers/non-smokers’ column can be used directly.
</p>
<p>Let us plot the height-weight data and label them for both cases.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">6</span>),ncols<span class="op">=</span><span class="dv">2</span>,nrows<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>gender_boolean <span class="op">=</span> df[<span class="st">'Gender'</span>] <span class="op">==</span> <span class="st">'Female'</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>ax[<span class="dv">0</span>].scatter(df[<span class="st">'Height'</span>], df[<span class="st">'Weight'</span>], c<span class="op">=</span>gender_boolean, cmap<span class="op">=</span><span class="st">'bwr'</span>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'Height'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'Weight'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Female (red), Male (blue)'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>ax[<span class="dv">1</span>].scatter(df[<span class="st">'Height'</span>], df[<span class="st">'Weight'</span>], c<span class="op">=</span>df[<span class="st">'Smoker'</span>], cmap<span class="op">=</span><span class="st">'bwr'</span>)</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'Height'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">'Weight'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Smoker (red), Non-Smoker (blue)'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="fig/01-classification_intro-rendered-unnamed-chunk-3-1.png" width="1152" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
It appears from these graphs that based on height and weight data it is
possible to distinguish male and female. Based on visual inspection one
could conclude that everybody with a weight lower than 70kg is female
and everybody with a weight above 70kg is male. That would be a
classification based on the weight alone. It also appears that the data
points classified as ‘male’ are taller on average, so it might be
helpful to have the height recorded as well. E.g it could improve the
prediction of gender for new subjects with a weight around 70 kg. But it
would not be the best choice if only a single quantity was used. Thus, a
second conclusion is that based on these data the weight is more
important for the classification than the height.
</p>
<p style="text-align: justify;">
On the other hand, based on the smoker / non-smoker data it will not be
possible to distinguish smokers from non-smokers. Red dots and blue dots
are scattered throughout the graph. The conclusion is that height and
weight cannot be used to predict whether a subject is a smoker.
</p>
</section><section><h2 class="section-heading" id="supervised-learning-training-a-model">Supervised Learning: Training a Model<a class="anchor" aria-label="anchor" href="#supervised-learning-training-a-model"></a></h2>
<hr class="half-width"><p style="text-align: justify;">
This lesson deals with labelled data. Labelled data are numerical data
with an extra column of a <strong>label</strong> for each sample. A
sample can consist of any number of individual observations but must be
at least two.
</p>
Examples of labels include ‘control group / test group’; ‘male /
female’; ‘healthy / diseased’; ‘before treatment / after treatment’.
<p style="text-align: justify;">
The task in Supervised Machine Learning is to fit (train) a model to
distinguish between the groups by ‘learning’ from so-called training
data. After training, the optimised model automatically labels incoming
(unlabeled) data. The better the model, the better the labelling
(prediction).
</p>
<p style="text-align: justify;">
The model itself is a black box. It has set default parameters to start
with and thus performs badly in the beginning. Essentially, it starts by
predicting a label at random. The process of training consists in
repeatedly changing the model parameters such that the performance
improves. After the training, the model parameters are supposed to be
optimal. Of course, the model cannot be expected to reveal anything
about the mechanism or cause that underlies the distinction between the
labels.
</p>
<p>The performance of the model is tested by splitting a dataset with
labels into:</p>
<ul><li><p>the <code>train data</code>, those that will be used for model
fitting, and</p></li>
<li><p>the <code>test data</code>, those that will be used to check how
well the model predicts.</p></li>
</ul><p style="text-align: justify;">
The result of the model fitting is then assessed by checking how many of
the (withheld) labels in the test data were correctly predicted by the
trained model. We can also retrieve the confidence of the model
prediction, i.e. the probability that the assigned label is correct.
</p>
<p style="text-align: justify;">
As an additional result, the procedure will generate the so-called
feature importances: similar to how we concluded above that weight is
more important than height for gender prediction, the feature importance
informs to which degree each of the data columns actually contributes to
the predictions.
</p>
</section><section><h2 class="section-heading" id="scikit-learn">Scikit Learn<a class="anchor" aria-label="anchor" href="#scikit-learn"></a></h2>
<hr class="half-width"><p>We will import our machine learning functionality from the <a href="https://scikit-learn.org/stable/" class="external-link">SciKit Learn library</a>.</p>
<div id="scikit-learn-1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="scikit-learn-1" class="callout-inner">
<h3 class="callout-title">SciKit Learn</h3>
<div class="callout-content">
<p style="text-align: justify;">
SciKit Learn is a renowned open source application programming interface
(API) for machine learning. It enjoys a vibrant community and is well
maintained. It is always beneficial to use the official documentations
for every API. SciKit Learn provides an exceptional documentation with
detailed explanations and examples at every level.
</p>
</div>
</div>
</div>
<p style="text-align: justify;">
The implementation of algorithms in SciKit Learn follows a very specific
protocol. First and foremost, it uses a programming paradigm known as
object-oriented programming (OOP). Thanks to Python, this does not mean
that you as the user are also forced to use OOP. But you need to follow
a specific protocol to use the tools that are provided by SciKit Learn.
</p>
<p style="text-align: justify;">
Unlike functions that perform a specific task and return the results, in
OOP, we use <em>classes</em> to encapsulate interconnected components
and functionalities. In accordance with the convention of best practices
for Python programming (also known as PEP8), classes are implemented
with camel-case characters; e.g. <code>RandomForestClassifier</code>. In
contrast, functions should be implemented using lower-case characters
only; e.g. <code>min</code> or <code>round</code>.
</p>
</section><section><h2 class="section-heading" id="classification">Classification<a class="anchor" aria-label="anchor" href="#classification"></a></h2>
<hr class="half-width"><div class="section level3">
<h3 id="prepare-data-with-labels"><strong>Prepare data with labels</strong><a class="anchor" aria-label="anchor" href="#prepare-data-with-labels"></a></h3>
<p style="text-align: justify;">
The terminology that is widely used in Machine Learning (including
Scikit Learn) refers to data points as <strong>samples</strong>, and the
different types of recordings(columns in our case) are referred to as
<strong>features</strong>. In <code>Numpy</code> notation, samples are
organised in rows, features in columns.
</p>
<p style="text-align: justify;">
We can use the function <code>uniform</code> from numpy.random to
generate uniformly distributed random data. Here we create 100 samples
of two features (as in the visualisation above). We decide to have
values distributed between 0 and 100.
</p>
<p style="text-align: justify;">
The convention in machine learning is to call the training data ‘X’.
This array must be <strong>two dimensional</strong>, where rows are the
samples and columns are the features.
</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>low  <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>high <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>n_samples, m_features <span class="op">=</span> <span class="dv">100</span>, <span class="dv">2</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>RANDOM_SEED  <span class="op">=</span> <span class="dv">1234</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>seed(RANDOM_SEED)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>random_numbers <span class="op">=</span> uniform(low<span class="op">=</span>low, high<span class="op">=</span>high, size<span class="op">=</span>(n_samples, m_features))</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>X <span class="op">=</span> random_numbers.<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Dimensions of training data'</span>)</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="bu">print</span>(<span class="st">''</span>)</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of samples:  '</span>, X.shape[<span class="dv">0</span>])</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of features: '</span>, X.shape[<span class="dv">1</span>])</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="bu">print</span>(<span class="st">''</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Dimensions of training data

Number of samples:   100
Number of features:  2</code></pre>
</div>
<div id="note" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note" class="callout-inner">
<h3 class="callout-title">Note</h3>
<div class="callout-content">
<p style="text-align: justify;">
This code uses a <strong>random number generator</strong>. The output of
a random number generator is different each time it is run. On the one
hand, this is good because it allows us to create many realisations of
samples drawn from a fixed distribution. On the other hand, when testing
and sharing code this prevents exact reproduction of results. We
therefore use the <code>seed</code> function to reset the generator such
that with a given number for the seed (the parameter called
<code>RANDOM_SEED</code>) the same numbers are produced.
</p>
</div>
</div>
</div>
<p>Let us check the histograms of both features:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>ax.hist(X, bins<span class="op">=</span><span class="dv">10</span>)<span class="op">;</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="fig/01-classification_intro-rendered-unnamed-chunk-5-3.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
We find that both features are distributed over the selected range of
values. Due to the small number of samples, the distribution is not very
even.
</p>
<p style="text-align: justify;">
The categorical data used to distinguish between different classes are
called <strong>labels</strong>. Let us create an artificial set of
labels for our first classification task.
</p>
<p style="text-align: justify;">
We pick an arbitrary threshold and call all values <code>True</code> if
the values in both the first and the second feature are above the
threshold. The resulting labels <code>True</code> and <code>False</code>
can be viewed as 0/1 using the method <code>astype</code> with argument
<code>int</code>.
</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>threshold <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>y <span class="op">=</span> (X[:,<span class="dv">0</span>] <span class="op">&gt;</span> threshold) <span class="op">&amp;</span> (X[:,<span class="dv">1</span>] <span class="op">&gt;</span> threshold)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>y.astype(<span class="bu">int</span>)</span></code></pre>
</div>
<p>array([0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0,
0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0,
0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0,
0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0,
0, 0, 0, 0, 0, 0, 1])</p>
<p>If both features (columns) were risk factors, this might be
interpreted as: only if both risk factors are above the threshold, a
subject is classified as ‘at risk’, meaning it gets label ‘True’ or
‘1’.</p>
<p>Labels must be <strong>one-dimensional</strong>. You can check this
by printing the <code>shape</code>. The output should be a single
number:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of labels:'</span>, y.shape)</span></code></pre>
</div>
<p>Number of labels: (100,)</p>
</div>
<div class="section level3">
<h3 id="the-random-forest-classifier"><strong>The Random Forest Classifier</strong><a class="anchor" aria-label="anchor" href="#the-random-forest-classifier"></a></h3>
<p>To start with our learning algorithm, we import one of the many
classifiers from Scikit Learn: it is called Random Forest.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span></code></pre>
</div>
<p>The Random Forest is a member of the ensemble learning family, whose
objective is to combine the predictions of several optimisations to
improve their performance, generalisability, and robustness.</p>
<p>Ensemble methods are often divided into two different categories:</p>
<ol style="list-style-type: decimal"><li><p>Averaging methods: Build several estimators independently, and
average their predictions. In general, the combined estimator tends to
perform better than any single estimator due to the reduction in
variance. Examples: Random Forest and Decision Tree.</p></li>
<li><p>Boosting methods: Build the estimators sequentially, and attempt
to reduce the bias of the combined estimator. Although the performance
of individual estimators may be weak, upon combination, they amount to a
powerful ensemble. Examples: Gradient Boosting and AdaBoost.</p></li>
</ol><p style="text-align: justify;">
We now train a model using the Python class for the Random Forest
classifier. Unlike a function (which we can use out of the box) a class
needs to be <em>instantiated</em> before it can be used. In Python, we
instantiate a class as follows:
</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>clf <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span>RANDOM_SEED)</span></code></pre>
</div>
<p style="text-align: justify;">
where <code>clf</code> now represents an <em>instance</em> of class
<code>RandomForestClassifier</code>. Note that we have set the keyword
argument <code>random_state</code> to a number. This is to assure
reproducibility of the results. (It does not have to be the same as
above, pick any integer).
</p>
<p>The instance of a class is typically referred to as an object, whose
type is the class that it represents:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Type of clf:'</span>, <span class="bu">type</span>(clf))</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="bu">print</span>(<span class="st">''</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Type of clf: &lt;class 'sklearn.ensemble._forest.RandomForestClassifier'&gt;</code></pre>
</div>
<p style="text-align: justify;">
Once instantiated, we can use this object, <code>clf</code>, to access
the methods that are associated with that class. Methods are essentially
functions that are encapsulated inside a class.
</p>
<p style="text-align: justify;">
In SciKit Learn all classes have a <code>.fit()</code> method. Its
function is to receive the training data and perform the training of the
model.
</p>
</div>
<div class="section level3">
<h3 id="train-a-model">Train a model<a class="anchor" aria-label="anchor" href="#train-a-model"></a></h3>
<p>To train a model, we apply the fit method to the training data,
labelled ‘X’, given the corresponding labels ‘y’:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>clf.fit(X, y)</span></code></pre>
</div>
<style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-1 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container">
<div class="sk-text-repr-fallback">
<pre>RandomForestClassifier(random_state=1234)</pre>
<b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b>
</div>
<div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable">
<input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>RandomForestClassifier</div></div>
<div>
<a class="external-link sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.ensemble.RandomForestClassifier.html">?<span>Documentation for RandomForestClassifier</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span>
</div></label><div class="sk-toggleable__content fitted"><pre>RandomForestClassifier(random_state=1234)</pre></div> </div></div></div>
</div>
<p>And that’s it. All the machine learning magic done. <code>clf</code>
is now a trained model with optimised parameters which we can use to
predict new data.</p>
</div>
<div class="section level3">
<h3 id="predict-test-data"><strong>Predict Test Data</strong><a class="anchor" aria-label="anchor" href="#predict-test-data"></a></h3>
</div>
<div class="section level3">
<h3 id="categorical-prediction">Categorical Prediction<a class="anchor" aria-label="anchor" href="#categorical-prediction"></a></h3>
<p style="text-align: justify;">
We start by creating a number of test data in the same way as we created
the training data. Note that the number of test samples is arbitrary.
You can create any number of samples. However, you must provide the same
number of features (columns) used in the training of the classifier. In
our case that is 2.
</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>RANDOM_SEED_2 <span class="op">=</span> <span class="dv">123</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>seed(RANDOM_SEED_2)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>new_samples <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>features <span class="op">=</span> X.shape[<span class="dv">1</span>]</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>new_data <span class="op">=</span> uniform(low<span class="op">=</span>low, high<span class="op">=</span>high, size<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">2</span>))</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Shape of new data'</span>, new_data.shape)</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="bu">print</span>(<span class="st">''</span>)</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="bu">print</span>(new_data)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Shape of new data (10, 2)

[[69.64691856 28.6139335 ]
 [22.68514536 55.13147691]
 [71.94689698 42.31064601]
 [98.07641984 68.48297386]
 [48.09319015 39.21175182]
 [34.31780162 72.90497074]
 [43.85722447  5.96778966]
 [39.80442553 73.79954057]
 [18.24917305 17.54517561]
 [53.15513738 53.18275871]]</code></pre>
</div>
<p style="text-align: justify;">
There are 10 randomly created pairs of numbers in the same range as the
training data. They represent ‘unlabelled’ incoming data which we offer
to the trained model.
</p>
<p>The method <code>.predict()</code> helps us to find out what the
model claims these data to be:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>predictions <span class="op">=</span> clf.predict(new_data)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Predictions: '</span>, predictions)</span></code></pre>
</div>
<p>Predictions: [False False False True False False False False False
True]</p>
<p>They can also be viewed as zeros and ones:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>predictions.astype(<span class="bu">int</span>)</span></code></pre>
</div>
<p>array([0, 0, 0, 1, 0, 0, 0, 0, 0, 1])</p>
<p>According to the model, data points with indices 3, and 9 are in
class <code>True</code> (or <code>1</code>).</p>
<p style="text-align: justify;">
Predicting individual samples is fine, but does not tell us whether the
classifier was able to create a good model of the class distinction. To
check the training result systematically, we create a state space grid
over the state space. This is the same as creating a coordinate system
of data points (as in a scatter plot), in our case with values from 0 to
100 in each feature.
</p>
<p>Here we use a resolution of 100, ie. we create a 100 by 100 grid:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>resolution <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>vec_a <span class="op">=</span> linspace(low, high, resolution)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>vec_b <span class="op">=</span> vec_a</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>grid_a, grid_b <span class="op">=</span> meshgrid(vec_a, vec_b)</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>grid_a_flat <span class="op">=</span> grid_a.ravel()</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>grid_b_flat <span class="op">=</span> grid_b.ravel()</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>XY_statespace <span class="op">=</span> c_[grid_a_flat, grid_b_flat]</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="bu">print</span>(XY_statespace.shape)</span></code></pre>
</div>
<p>(10000, 2)</p>
<p style="text-align: justify;">
Now we can offer the grid of the X-Y state space as ‘new data’ to the
classifier and obtain the predictions. We can then plot the grid points
and colour them according to the labels assigned by the trained model.
</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>predictions <span class="op">=</span> clf.predict(XY_statespace)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>predictions.shape</span></code></pre>
</div>
<p>(10000,)</p>
<p>We obtain 10,000 predictions, one for each point on the grid.</p>
<p>To compare the data with the original thresholds and the model
predictions we can use plots of the state space:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>feature_1, feature_2 <span class="op">=</span> <span class="dv">0</span>, <span class="dv">1</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(ncols<span class="op">=</span><span class="dv">2</span>, nrows<span class="op">=</span><span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>ax[<span class="dv">0</span>].scatter(X[:, feature_1], X[:, feature_2], c<span class="op">=</span>y, s<span class="op">=</span><span class="dv">4</span>, cmap<span class="op">=</span><span class="st">'bwr'</span>)<span class="op">;</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>ax[<span class="dv">1</span>].scatter(XY_statespace[:, feature_1], XY_statespace[:, feature_2], c<span class="op">=</span>predictions, s<span class="op">=</span><span class="dv">1</span>, cmap<span class="op">=</span><span class="st">'bwr'</span>)<span class="op">;</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>p1, p2 <span class="op">=</span> [threshold, threshold], [<span class="dv">100</span>, threshold]</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>p3, p4 <span class="op">=</span> [threshold, <span class="dv">100</span>], [threshold, threshold]</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(p1, p2, c<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(p3, p4, c<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'Feature 1'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'Feature 2'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'Feature 1'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="fig/01-classification_intro-rendered-unnamed-chunk-17-5.png" width="960" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
Left is a scatter plot of the data points used for training. They are
coloured according to their labels. The black lines indicate the
threshold boundaries that we introduced to distinguish the two classes.
On the right hand side are the predictions for the coordinate grid.
Label 0 is blue, label 1 is red.
</p>
<p style="text-align: justify;">
Based on the training samples (left), a good classification can be
achieved with the model (right). But some problems persist. In
particular, the boundaries are not sharp.
</p>
</div>
<div class="section level3">
<h3 id="probability-prediction">Probability Prediction<a class="anchor" aria-label="anchor" href="#probability-prediction"></a></h3>
<p style="text-align: justify;">
Let us pick a sample near the boundary. We can get its predicted label.
In addition, using <code>.predict_proba()</code> we can get the
probability of this prediction. This reflects the confidence in the
prediction. 50% probability means, the prediction is at chance level,
i.e. equivalent to a coin toss.
</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>pos <span class="op">=</span> <span class="dv">55</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>test_sample <span class="op">=</span> [[pos, pos]]</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>test_sample_label <span class="op">=</span> clf.predict(test_sample)</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>test_sample_proba <span class="op">=</span> clf.predict_proba(test_sample)</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Prediction:'</span>, test_sample_label)</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="bu">print</span>(clf.classes_, test_sample_proba)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Prediction: [False]
[False  True] [[0.57 0.43]]</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>bins <span class="op">=</span> arange(test_sample_proba.shape[<span class="dv">1</span>])</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>ax.bar(bins, test_sample_proba[<span class="dv">0</span>,:], color<span class="op">=</span>(<span class="st">'b'</span>, <span class="st">'r'</span>))</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Probability'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>xticks(bins, (<span class="st">'Label 0'</span>, <span class="st">'Label 1'</span>), fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="fig/01-classification_intro-rendered-unnamed-chunk-19-7.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
Even though the sample is from the region that (according to the
creation of the data) is in the ‘True’ region, it is labelled as false.
The reason is that there were few or no training data points in that
specific region.
</p>
<p style="text-align: justify;">
Here is a plot of the probability for the state space. White represents
False and Black represents True, the values in between are gray coded.
Note that the probability values are complementary. We only need the
probabilities for one of our classes.
</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>state_space_proba <span class="op">=</span> clf.predict_proba(XY_statespace)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>grid_shape <span class="op">=</span> grid_a.shape</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>proba_grid <span class="op">=</span> state_space_proba[:, <span class="dv">1</span>].reshape(grid_shape)</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>contour_levels <span class="op">=</span> linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">6</span>)</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">5</span>))</span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>cax <span class="op">=</span> ax.contourf(grid_a, grid_b, proba_grid, cmap<span class="op">=</span><span class="st">'Greys'</span>, levels<span class="op">=</span>contour_levels)</span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a>fig.colorbar(cax)</span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a>ax.scatter(test_sample[<span class="dv">0</span>][<span class="dv">0</span>], test_sample[<span class="dv">0</span>][<span class="dv">1</span>], c<span class="op">=</span><span class="st">'r'</span>, marker<span class="op">=</span><span class="st">'o'</span>, s<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a>ax.plot(p1, p2, p3, p4, c<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Feature 1'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Feature 2'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a></span>
<span id="cb25-22"><a href="#cb25-22" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="fig/01-classification_intro-rendered-unnamed-chunk-20-9.png" width="576" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The single red dot marks the individual data point we used to
illustrate the prediction probability above.</p>
</div>
<div class="section level3">
<h3 id="feature-importances">Feature Importances<a class="anchor" aria-label="anchor" href="#feature-importances"></a></h3>
<p style="text-align: justify;">
We can check the contribution of each feature for the success of the
classification. The feature importance is given as the fraction
contribution of each feature to the prediction.
</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>importances <span class="op">=</span> clf.feature_importances_</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Relative importance:'</span>)</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>template <span class="op">=</span> <span class="st">'Feature 1: </span><span class="sc">{:.1f}</span><span class="st">%; Feature 2: </span><span class="sc">{:.1f}</span><span class="st">%'</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="bu">print</span>(template.<span class="bu">format</span>(importances[<span class="dv">0</span>]<span class="op">*</span><span class="dv">100</span>, importances[<span class="dv">1</span>]<span class="op">*</span><span class="dv">100</span>))</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>bins <span class="op">=</span> arange(importances.shape[<span class="dv">0</span>])</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>ax.bar(bins, importances, color<span class="op">=</span>(<span class="st">'g'</span>, <span class="st">'m'</span>))<span class="op">;</span></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Feature Importance'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a>xticks(bins, (<span class="st">'Feature 1'</span>, <span class="st">'Feature 2'</span>), fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a>show()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Relative importance:
Feature 1: 61.6%; Feature 2: 38.4%</code></pre>
</div>
<figure><img src="fig/01-classification_intro-rendered-unnamed-chunk-21-11.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>In this case, the predictions are based on a 61% contribution from
feature 1 and a 38% contribution from feature 2.</p>
</div>
</section><section><h2 class="section-heading" id="application">Application<a class="anchor" aria-label="anchor" href="#application"></a></h2>
<hr class="half-width"><p>Now we pick the ‘Height’ and ‘Weight’ columns from the patients data
to predict the gender labels. We use a split of 4/5 of the data for
training and 1/5 for testing.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>df <span class="op">=</span> read_csv(<span class="st">'data/patients_data.csv'</span>)</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="bu">print</span>(df.shape)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="co"># Convert pounds to kg and inches to cm:</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>df[<span class="st">'Weight'</span>] <span class="op">=</span> <span class="fl">0.454</span><span class="op">*</span>df[<span class="st">'Weight'</span>]</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>df[<span class="st">'Height'</span>] <span class="op">=</span> <span class="fl">2.540</span><span class="op">*</span>df[<span class="st">'Height'</span>]</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>df.head(<span class="dv">10</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>(100, 8)
   Age  Height  Weight  Systolic  Diastolic  Smoker  Gender  Peak Flow
0   38  180.34  79.904       124         93       1    Male        200
1   43  175.26  74.002       109         77       0    Male        615
2   38  162.56  59.474       125         83       0  Female        642
3   40  170.18  60.382       117         75       0  Female        511
4   49  162.56  54.026       122         80       0  Female        497
5   46  172.72  64.468       121         70       0  Female        528
6   33  162.56  64.468       130         88       1  Female        269
7   40  172.72  81.720       115         82       0    Male        324
8   28  172.72  83.082       115         78       0    Male        501
9   31  167.64  59.928       118         86       0  Female        723</code></pre>
</div>
<div class="section level3">
<h3 id="prepare-training-data-and-labels"><strong>Prepare training data and labels</strong><a class="anchor" aria-label="anchor" href="#prepare-training-data-and-labels"></a></h3>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co"># Extract data as numpy array</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>df_np <span class="op">=</span> df.to_numpy()</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="co"># Pick a fraction of height and weight data as training data</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>samples <span class="op">=</span> <span class="dv">80</span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>X <span class="op">=</span> df_np[:samples, [<span class="dv">1</span>, <span class="dv">2</span>]]</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a><span class="bu">print</span>(X.shape)</span></code></pre>
</div>
<p>(80, 2)</p>
<p>For the labels of the training data we convert the ‘Male’ and
‘Female’ strings to categorical values.</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>gender_boolean <span class="op">=</span> df[<span class="st">'Gender'</span>] <span class="op">==</span> <span class="st">'Female'</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>y <span class="op">=</span> gender_boolean[:<span class="dv">80</span>]</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a><span class="co"># printed as 0 and 1:</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>y.astype(<span class="st">'int'</span>)</span></code></pre>
</div>
<p>0 0 1 0 2 1 3 1 4 1 .. 75 0 76 1 77 0 78 0 79 1 Name: Gender, Length:
80, dtype: int64</p>
</div>
<div class="section level3">
<h3 id="train-classifier-and-predict"><strong>Train classifier and predict</strong><a class="anchor" aria-label="anchor" href="#train-classifier-and-predict"></a></h3>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>seed(RANDOM_SEED)</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>clf <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span>RANDOM_SEED)</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>clf.fit(X, y)</span></code></pre>
</div>
<style>#sk-container-id-2 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-2 {
  color: var(--sklearn-color-text);
}

#sk-container-id-2 pre {
  padding: 0;
}

#sk-container-id-2 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-2 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-2 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-2 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-2 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-2 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-2 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-2 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-2 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-2 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-2 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-2 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-2 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-2 div.sk-label label.sk-toggleable__label,
#sk-container-id-2 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-2 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-2 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-2 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-2 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-2 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-2 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-2 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-2 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-2 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-2" class="sk-top-container">
<div class="sk-text-repr-fallback">
<pre>RandomForestClassifier(random_state=1234)</pre>
<b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b>
</div>
<div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable">
<input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked><label for="sk-estimator-id-2" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>RandomForestClassifier</div></div>
<div>
<a class="external-link sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.ensemble.RandomForestClassifier.html">?<span>Documentation for RandomForestClassifier</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span>
</div></label><div class="sk-toggleable__content fitted"><pre>RandomForestClassifier(random_state=1234)</pre></div> </div></div></div>
</div>
<p>We now take the remaining fifth of the data to predict.</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>X_test <span class="op">=</span> df.loc[<span class="dv">80</span>:, [<span class="st">'Height'</span>, <span class="st">'Weight'</span>]]</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>X_test <span class="op">=</span> X_test.values</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>predict_test <span class="op">=</span> clf.predict(X_test)</span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>probab_test <span class="op">=</span> clf.predict_proba(X_test)</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Predictions: '</span>, predict_test, <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>, <span class="st">'Probabilities: '</span>, <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>,  probab_test)</span></code></pre>
</div>
<p>Predictions: [False False False True True False True True True True
False False True False True False False False False False]
Probabilities:<br>
[[1. 0. ] [1. 0. ] [1. 0. ] [0. 1. ] [0. 1. ] [1. 0. ] [0. 1. ] [0. 1. ]
[0. 1. ] [0. 1. ] [1. 0. ] [1. 0. ] [0.02 0.98] [1. 0. ] [0. 1. ] [1. 0.
] [1. 0. ] [1. 0. ] [1. 0. ] [0.97 0.03]]</p>
<p>As in the example above, we create a state space grid to visualise
the outcome for the two features.</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>X1_min, X1_max <span class="op">=</span> <span class="bu">min</span>(X[:, <span class="dv">0</span>]), <span class="bu">max</span>(X[:, <span class="dv">0</span>])</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>X2_min, X2_max <span class="op">=</span> <span class="bu">min</span>(X[:, <span class="dv">1</span>]), <span class="bu">max</span>(X[:, <span class="dv">1</span>])</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>resolution <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>vec_a <span class="op">=</span> linspace(X1_min, X1_max, resolution)</span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>vec_b <span class="op">=</span> linspace(X2_min, X2_max, resolution)</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>grid_a, grid_b <span class="op">=</span> meshgrid(vec_a, vec_b)</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>grid_a_flat <span class="op">=</span> grid_a.ravel()</span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a>grid_b_flat <span class="op">=</span> grid_b.ravel()</span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a>X_statespace <span class="op">=</span> c_[grid_a_flat, grid_b_flat]</span></code></pre>
</div>
<p>We can now obtain the categorical and probability predictions from
the trained classifier for all points of the grid.</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>predict <span class="op">=</span> clf.predict(X_statespace)</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>probabs <span class="op">=</span> clf.predict_proba(X_statespace)</span></code></pre>
</div>
<p>Here is the plot of the state space and the predicted
probabilities:</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>feature_1, feature_2 <span class="op">=</span> <span class="dv">0</span>, <span class="dv">1</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(ncols<span class="op">=</span><span class="dv">3</span>, nrows<span class="op">=</span><span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>ax[<span class="dv">0</span>].scatter(X[:, feature_1], X[:, feature_2], c<span class="op">=</span>y, s<span class="op">=</span><span class="dv">40</span>, cmap<span class="op">=</span><span class="st">'bwr'</span>)<span class="op">;</span></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlim(X1_min, X1_max)<span class="op">;</span></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylim(X2_min, X2_max)<span class="op">;</span></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'Feature 1'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'Feature 2'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>cax1 <span class="op">=</span> ax[<span class="dv">1</span>].scatter(X_statespace[:, feature_1], X_statespace[:, feature_2], c<span class="op">=</span>predict, s<span class="op">=</span><span class="dv">1</span>, cmap<span class="op">=</span><span class="st">'bwr'</span>)<span class="op">;</span></span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a>ax[<span class="dv">1</span>].scatter(X_test[:, feature_1], X_test[:, feature_2], c<span class="op">=</span>predict_test, s<span class="op">=</span><span class="dv">40</span>, cmap<span class="op">=</span><span class="st">'Greys'</span>)<span class="op">;</span></span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'Feature 1'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlim(X1_min, X1_max)<span class="op">;</span></span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylim(X2_min, X2_max)<span class="op">;</span></span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a>fig.colorbar(cax1, ax<span class="op">=</span>ax[<span class="dv">1</span>])<span class="op">;</span></span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a>grid_shape <span class="op">=</span> grid_a.shape</span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a></span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a>probab_grid <span class="op">=</span> probabs[:, <span class="dv">1</span>].reshape(grid_shape)</span>
<span id="cb36-21"><a href="#cb36-21" tabindex="-1"></a></span>
<span id="cb36-22"><a href="#cb36-22" tabindex="-1"></a><span class="co"># Subject with 170cm and 70 kg</span></span>
<span id="cb36-23"><a href="#cb36-23" tabindex="-1"></a>pos1, pos2 <span class="op">=</span> <span class="dv">170</span>, <span class="dv">70</span></span>
<span id="cb36-24"><a href="#cb36-24" tabindex="-1"></a></span>
<span id="cb36-25"><a href="#cb36-25" tabindex="-1"></a>test_sample <span class="op">=</span> [pos1, pos2]</span>
<span id="cb36-26"><a href="#cb36-26" tabindex="-1"></a></span>
<span id="cb36-27"><a href="#cb36-27" tabindex="-1"></a>contour_levels <span class="op">=</span> linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb36-28"><a href="#cb36-28" tabindex="-1"></a></span>
<span id="cb36-29"><a href="#cb36-29" tabindex="-1"></a>cax2 <span class="op">=</span> ax[<span class="dv">2</span>].contourf(grid_a, grid_b, probab_grid, cmap<span class="op">=</span><span class="st">'Greys'</span>, levels<span class="op">=</span>contour_levels)<span class="op">;</span></span>
<span id="cb36-30"><a href="#cb36-30" tabindex="-1"></a>fig.colorbar(cax2, ax<span class="op">=</span>ax[<span class="dv">2</span>])<span class="op">;</span></span>
<span id="cb36-31"><a href="#cb36-31" tabindex="-1"></a></span>
<span id="cb36-32"><a href="#cb36-32" tabindex="-1"></a>ax[<span class="dv">2</span>].scatter(test_sample[<span class="dv">0</span>], test_sample[<span class="dv">1</span>], c<span class="op">=</span><span class="st">'r'</span>, marker<span class="op">=</span><span class="st">'o'</span>, s<span class="op">=</span><span class="dv">100</span>)<span class="op">;</span></span>
<span id="cb36-33"><a href="#cb36-33" tabindex="-1"></a>ax[<span class="dv">2</span>].set_xlabel(<span class="st">'Feature 1'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb36-34"><a href="#cb36-34" tabindex="-1"></a>ax[<span class="dv">2</span>].set_xlim(X1_min, X1_max)<span class="op">;</span></span>
<span id="cb36-35"><a href="#cb36-35" tabindex="-1"></a>ax[<span class="dv">2</span>].set_ylim(X2_min, X2_max)<span class="op">;</span></span>
<span id="cb36-36"><a href="#cb36-36" tabindex="-1"></a></span>
<span id="cb36-37"><a href="#cb36-37" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="fig/01-classification_intro-rendered-unnamed-chunk-29-13.png" width="1440" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
The left panel shows the original data with labels as colours, i.e. the
training data. Central panel shows the classified state space with the
test samples as black dots in predicted category ‘Female’ and white dots
in predicted category ‘Male’. Right panel shows the state space with
prediction probabilities with black for ‘Female’ and white for ‘Male’.
The red dot represents the simulated subject with 170cm and 70 kg (see
below).
</p>
</div>
<div class="section level3">
<h3 id="probability-of-a-single-observation"><strong>Probability of a single observation</strong><a class="anchor" aria-label="anchor" href="#probability-of-a-single-observation"></a></h3>
<p style="text-align: justify;">
Let us pick that subject and obtain its predicted label and probability.
Note the use of double brackets to create a sample that is a
two-dimensional array.
</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>test_sample <span class="op">=</span> [[pos1, pos2]]</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>test_predict <span class="op">=</span> clf.predict(test_sample)</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>test_proba   <span class="op">=</span> clf.predict_proba(test_sample)</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Predicted class:'</span>, test_predict, <span class="st">'Female'</span>)</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Probability:'</span>, test_proba[<span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a><span class="bu">print</span>(<span class="st">''</span>)</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a>bins <span class="op">=</span> arange(test_proba.shape[<span class="dv">1</span>])</span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a>ax.bar(bins, test_proba[<span class="dv">0</span>,:], color<span class="op">=</span>(<span class="st">'r'</span>, <span class="st">'b'</span>))<span class="op">;</span></span>
<span id="cb37-15"><a href="#cb37-15" tabindex="-1"></a>xticks(bins, (<span class="st">'Female'</span>, <span class="st">'Male'</span>), fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb37-16"><a href="#cb37-16" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Probability'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb37-17"><a href="#cb37-17" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" tabindex="-1"></a>show()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Predicted class: [False] Female
Probability: 0.66</code></pre>
</div>
<figure><img src="fig/01-classification_intro-rendered-unnamed-chunk-30-15.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
This shows that the predicted label is female but the probability is
less than 70 % and, e.g. if a clinical decision was to be taken based on
the outcome of the classification, it might suggest looking for
additional evidence before the decision is made.
</p>
</div>
<div class="section level3">
<h3 id="feature-importances-1"><strong>Feature Importances</strong><a class="anchor" aria-label="anchor" href="#feature-importances-1"></a></h3>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>importances <span class="op">=</span> clf.feature_importances_</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Features importances:'</span>)</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>template <span class="op">=</span> <span class="st">'Feature 1: </span><span class="sc">{:.1f}</span><span class="st">%; Feature 2: </span><span class="sc">{:.1f}</span><span class="st">%'</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a><span class="bu">print</span>(template.<span class="bu">format</span>(importances[<span class="dv">0</span>]<span class="op">*</span><span class="dv">100</span>, importances[<span class="dv">1</span>]<span class="op">*</span><span class="dv">100</span>))</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a><span class="bu">print</span>(<span class="st">''</span>)</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>bins <span class="op">=</span> arange(importances.shape[<span class="dv">0</span>])</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>ax.bar(bins, importances, color<span class="op">=</span>(<span class="st">'m'</span>, <span class="st">'g'</span>))<span class="op">;</span></span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a>xticks(bins, (<span class="st">'Feature 1'</span>, <span class="st">'Feature 2'</span>), fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Feature Importance'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a>show()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Features importances:
Feature 1: 31.7%; Feature 2: 68.3%</code></pre>
</div>
<figure><img src="fig/01-classification_intro-rendered-unnamed-chunk-31-17.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
Feature Height contributes about one third and feature Weight about two
thirds to the decisions.
<p style="text-align: justify;">
Feature importances can be used in data sets with many features, e.g. to
reduce the number of features used for classification. Some features
might not contribute to the classification and could therefore be left
out of the process.
</p>
<p>In the next lesson, we are going to test multiple classifiers and
quantify their performance to improve the outcome of the
classification.</p>
<p><br></p>
</div>
</section><section><h2 class="section-heading" id="exercises">Exercises<a class="anchor" aria-label="anchor" href="#exercises"></a></h2>
<hr class="half-width"><div id="end-of-chapter-exercises" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="end-of-chapter-exercises" class="callout-inner">
<h3 class="callout-title">End of chapter Exercises</h3>
<div class="callout-content">
<p style="text-align: justify;">
</p>
<p>Repeat the training and prediction workflow as described in the
Classification lesson for two other independant features in the data,
namely: - Peak Flow - Pulse Pressure <em>(Hint: use a column operation
to add an additional ‘PP’ column to the data given the equation
below).</em></p>
<p><br>
Pulse Pressure (PP) is a metric that represents the force the heart
generates each time it contracts, and can be used to give clinical
indicators of arterial stiffness or cardiovascular disease.<br><br>
The equation for pulse pressure is:</p>
<p><span class="math display">\[
PP = \text{Systolic BP} - \text{Diastolic BP}
\]</span></p>
<p><br>
Use 70 training and 30 testing samples where the labels are assigned
according to the condition:</p>
<ul><li>0 / False for ‘non-smoker’</li>
<li>1 / True for ‘smoker’</li>
</ul><p>Use the above code to:</p>
<ol style="list-style-type: decimal"><li><p>Train the random forest classifier.</p></li>
<li><p>Create state space scatter plots, making use of categorical
colouring. Include a probability contour plot.</p></li>
<li>
<p>Create a plot of the probability of the predicted label given a
chosen pair of observations (features):</p>
<ul><li>Choose a pair of observations that are at the classifcation
boundary. <em>(Use the probability contour plot as a guide)</em>
</li>
<li>Print and plot the model probabilities for both labels</li>
<li>Observe and comment on how well the model is able to predict
observations that are on or near to the boundary <em>(Hint: Play around
with multiple observations to get a feel for this)</em>
</li>
</ul></li>
<li>
<p>Create multiple scatter plots with predicted labels, true labels
and use a Boolean array that compares predicted and true labels.</p>
<ul><li>How many of the 30 test data points are correctly predicted?</li>
<li>Which observations are incorrectly predicted, and why?</li>
</ul></li>
<li><p>Plot feature importance to understand how much each feature
contributes to the predictions.</p></li>
</ol></div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Solutions are provided after assignments are marked.
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<div id="further-practice-iris-data" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="further-practice-iris-data" class="callout-inner">
<h3 class="callout-title">Further Practice: Iris data</h3>
<div class="callout-content">
<p>You can try to use the Random Forest classifier on the <a href="https://en.wikipedia.org/wiki/Iris_flower_data_set" class="external-link">Iris
data</a>:</p>
<p>The Iris data are a collection of five features (sepal length, sepal
width, petal length, petal width and species) from 3 species of Iris
(Iris setosa, Iris virginica and Iris versicolor). The species name is
used for training in classification.</p>
<p>Import the data from <a href="https://scikit-learn.org/stable/auto_examples/datasets/plot_iris_dataset.html" class="external-link">scikit-learn</a>
as:</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> datasets</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a><span class="co"># Import Iris data</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>iris <span class="op">=</span> datasets.load_iris()</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a><span class="co"># Get first two features and labels</span></span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>X <span class="op">=</span> iris.data[:, :<span class="dv">2</span>]</span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a>y <span class="op">=</span> iris.target</span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a><span class="bu">print</span>(X.shape, y.shape)</span></code></pre>
</div>
<p>(150, 2) (150,)</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul><li>Classification is to assign labels to unlabeled data.</li>
<li>
<code>SciKit Learn</code> is an open source application programming
interface (API) for machine learning.</li>
<li>
<code>.fit()</code> function is used to receive the training data
and perform the training of the model.</li>
<li>
<code>.predict()</code> function helps to find out what the model
claims these data to be.</li>
<li>
<code>.predict_proba()</code> function predicts the probability of
any predictions.</li>
</ul></div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="index.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="02-improvement.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="index.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Home
        </a>
        <a class="chapter-link float-end" href="02-improvement.html" rel="next">
          Next: Improvement...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/01-classification_intro.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/carpentries/workbench-template-md/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries/workbench-template-md/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries/workbench-template-md/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/69aaefee46a17928e2a1694825599e169b9793e3" class="external-link">sandpaper (0.16.10)</a>, <a href="https://github.com/carpentries/pegboard/tree/bad0be19a12f0c6545801b276ddf26c945f8bfd1" class="external-link">pegboard (0.7.7)</a>, and <a href="https://github.com/milanmlft/varnish/tree/milanmlft/sticky-sidebar" class="external-link">varnish (1.0.3.9000)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://carpentries.github.io/workbench-template-md/01-classification_intro.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Classification",
  "creativeWorkStatus": "active",
  "url": "https://carpentries.github.io/workbench-template-md/01-classification_intro.html",
  "identifier": "https://carpentries.github.io/workbench-template-md/01-classification_intro.html",
  "dateCreated": "2022-07-05",
  "dateModified": "2025-03-17",
  "datePublished": "2025-03-17"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

