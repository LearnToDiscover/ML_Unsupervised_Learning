<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Data Handling: DataFrames - Part 2</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="manifest" href="../site.webmanifest"><link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav l2d"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="l2d" src="../assets/images/l2d-logo.svg"></div>
    </div>
    <div class="selector-container">


      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../02-data_frames_2.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav l2d" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="l2d" src="../assets/images/l2d-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Data Handling
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Data Handling
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr></ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Data Handling
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 33%" class="percentage">
    33%
  </div>
  <div class="progress l2d">
    <div class="progress-bar l2d" role="progressbar" style="width: 33%" aria-valuenow="33" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar" style="display: flex">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle sticky-top" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner sticky-top">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../02-data_frames_2.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-data_frames_1.html">1. DataFrames - Part 1</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        2. DataFrames - Part 2
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#introduction">Introduction</a></li>
<li><a href="#work-through-properties-of-a-dataset">Work-Through: Properties of a Dataset</a></li>
<li><a href="#the-correlation-coefficient">The Correlation Coefficient</a></li>
<li><a href="#the-correlation-matrix">The Correlation Matrix</a></li>
<li><a href="#analysis-of-the-correlation-matrix">Analysis of the Correlation matrix</a></li>
<li><a href="#application-the-diabetes-dataset">Application: The Diabetes Dataset</a></li>
<li><a href="#exercises">Exercises</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-image_handling.html">3. Image Handling</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr></ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/01-data_frames_1.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/03-image_handling.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/01-data_frames_1.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: DataFrames - Part 1
        </a>
        <a class="chapter-link float-end" href="../instructor/03-image_handling.html" rel="next">
          Next: Image Handling...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>DataFrames - Part 2</h1>
        <p>Last updated on 2025-01-05 |

        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/02-data_frames_2.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 120 minutes</p>

        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<p><a href="https://drive.usercontent.google.com/u/1/uc?id=1rs3CrdFd_Ilcb5dmL3KL8N6V3n99fOhZ&amp;export=download" class="external-link"><strong>Download
chapter PDF (.pdf).</strong></a></p>
<p><a href="https://drive.usercontent.google.com/u/1/uc?id=1vBj8V2sZwU7W3fah8ui6ijyJHwRANBtF&amp;export=download" class="external-link"><strong>Download
chapter notebook (.ipynb).</strong></a></p>
<p><a href="https://docs.google.com/forms/d/e/1FAIpQLSdr0capF7jloJhPH3Pki1B3LZoKOG16poOpuVJ7SL2LkwLHQA/viewform?pli=1" class="external-link"><span style="color: rgb(255, 0, 0);"><strong>Mandatory Lesson Feedback
Survey</strong></span></a></p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>What is bivariate or multivariate analysis?</li>
<li>How are bivariate properties of data interpreted?</li>
<li>How can a bivariate quantity be explained?</li>
<li>When to use a correlation matrix?</li>
<li>What are ways to study relationships in data?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Practise working with Pandas DataFrames and NumPy arrays.</li>
<li>Bivariate analysis of Pandas DataFrame / NumPy array.</li>
<li>The Pearson correlation coefficient (<span class="math inline">\(PCC\)</span>).</li>
<li>Correlation Matrix as an example of bivariate summary
statistics.</li>
</ul></div>
</div>
</div>
</div>
</div>
<br><p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/NjvFh7i74pI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</p>
<p><br></p>
<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/Z8eX4ncHjyQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</p>
<p><br></p>
<div id="prerequisites" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="prerequisites" class="callout-inner">
<h3 class="callout-title">Prerequisites</h3>
<div class="callout-content">
<ul><li>Python Arrays</li>
<li>Basic statistics, in particular, the <a href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient" class="external-link">correlation
coefficient</a>
</li>
<li>Pandas DataFrames: import and handling</li>
</ul></div>
</div>
</div>
<div id="remember" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="remember" class="callout-inner">
<h3 class="callout-title">Remember</h3>
<div class="callout-content">
<p>Any dataset associated with this lesson is present in
<code>Data</code> folder of your assignment repository, and can also be
downloaded using the link given above in <a href="index.html#setup">Summary
and Setup</a> for this Lesson.</p>
</div>
</div>
</div>
<p>The following cell contains functions that need to be imported,
please execute it before continuing with the Introduction.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># To import data from a csv file into a Pandas DataFrame</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">from</span> pandas <span class="im">import</span> read_csv</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># To import a dataset from scikit-learn</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> datasets</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co"># To create figure environments and plots</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> subplots, show</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co"># Specific numpy functions, description in the main body</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> corrcoef, fill_diagonal, triu_indices, arange</span></code></pre>
</div>
<div id="note" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note" class="callout-inner">
<h3 class="callout-title">Note</h3>
<div class="callout-content">
<p>In many online tutorials you can find the following convention when
importing functions:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre>
</div>
<p>(or similar). In this case, the whole library is imported and any
function in that library is then available using
e.g. <code>pd.read_csv(my_file)</code></p>
<p>We don’t recommend this as the import of the whole library uses a lot
of working memory (e.g. on the order of 100 MB for NumPy).</p>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a></h2>
<hr class="half-width"><p style="text-align: justify;">
In the previous lesson, we obtained some basic data quantifications
using the <kbd>describe</kbd> function. Each of these quantities was
calculated for individual columns, where each column contained a
different measured variable. However, in data analysis in general (and
in machine learning in particular), one of the main points of analysis
is to try and exploit the presence of information that lies in
relationships <em>between</em> variables (i.e. columns in our data).
</p>
<p style="text-align: justify;">
Quantities that are based on data from two variables are referred to as
<strong>bivariate</strong> measures. Analyses that make use of bivariate
(and potentially higher order) quantities are referred to as bivariate
or more broadly, <strong>multivariate data analyses</strong>.
</p>
<p>When we combine uni- and multivariate analyses, we can often obtain a
thorough, comprehensive overview of the basic properties of a
dataset.</p>
<div id="example-the-diabetes-dataset" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="example-the-diabetes-dataset" class="callout-inner">
<h3 class="callout-title"><strong>Example: The diabetes
dataset</strong></h3>
<div class="callout-content">
<p style="text-align: justify;">
Using the diabetes dataset (introduced in the Data Handling 1 lesson),
we can begin by looking at the data from three of its columns: The upper
row of the below figure shows three histograms. A histogram is a
summarising plot of the recordings of a single variable. The histograms
of columns with indices 3, 4, and 5 have similar means and variances,
which can be explained by prior normalisation of the data. The shapes
differ, but this does not tell us anything about a relationship between
the measurements.
</p>
<p style="text-align: justify;">
Before the application of any machine learning methods, its is important
to understand whether there is evidence of any relationships between the
individual variables in a DataFrame. One potential relationships is that
the variables are ‘similar’. One way to check for the similarity between
variables in a dataset, is to create a <a href="https://en.wikipedia.org/wiki/Scatter_plot" class="external-link">scatter plot</a>. The
bottom row of the figure below contains the three scatter plots between
variables used to create the histograms in the top row.
</p>
<p>(Please execute the code in order to generate the figures. We will
describe the scatter plot and its features, later.)</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Figure Code</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>diabetes <span class="op">=</span> datasets.load_diabetes()</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>diabetes_data <span class="op">=</span> diabetes.data</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">21</span>, <span class="dv">10</span>), ncols<span class="op">=</span><span class="dv">3</span>, nrows<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co"># Histograms</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">0</span>].hist(diabetes_data[:,<span class="dv">3</span>], bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">0</span>].set_ylabel(<span class="st">'Count'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].hist(diabetes_data[:,<span class="dv">4</span>], bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].set_ylabel(<span class="st">'Count'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">2</span>].hist(diabetes_data[:,<span class="dv">5</span>], bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">2</span>].set_ylabel(<span class="st">'Count'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co"># Scatter plots</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].scatter(diabetes_data[:,<span class="dv">3</span>], diabetes_data[:,<span class="dv">4</span>])<span class="op">;</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].set_xlabel(<span class="st">'Column 3'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].set_ylabel(<span class="st">'Column 4'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].scatter(diabetes_data[:,<span class="dv">4</span>], diabetes_data[:,<span class="dv">5</span>])<span class="op">;</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].set_xlabel(<span class="st">'Column 4'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].set_ylabel(<span class="st">'Column 5'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">2</span>].scatter(diabetes_data[:,<span class="dv">5</span>], diabetes_data[:,<span class="dv">3</span>])<span class="op">;</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">2</span>].set_xlabel(<span class="st">'Column 5'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">2</span>].set_ylabel(<span class="st">'Column 3'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-3-1.png" width="2016" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
When plotting the data against each other in pairs (as displayed in the
bottom row of the figure), data column 3 plotted against column 4 (left)
and column 5 against 3 (right) both show a fairly uniform circular
distribution of points. This is what would be expected if the data in
the two columns were independent of each other.
</p>
<p style="text-align: justify;">
In contrast, column 4 against 5 (centre, bottom) shows an elliptical,
pointed shape along the main diagonal. This shows that there is a clear
relationship between these data. Specifically, it indicates that the two
variables recorded in these columns (indices 4 and 5) are <em>not</em>
independent of each other. They exhibit more similarity than would be
expected of independent variables.
</p>
<p style="text-align: justify;">
In this lesson, we aim to obtain an overview of the similarities in a
dataset. We will firstly introduce <strong>bivariate</strong>
visualisation using Matplotlib. We will then go on to demonstrate the
use of NumPy functions in calculating correlation coefficients and
obtaining a correlation matrix, as a means of introducing
<strong>multivariate</strong> analysis. Combined with the basic
statistics covered in the previous lesson, we can obtain a good overview
of a high-dimensional dataset, prior to the application of machine
learning algorithms.
</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="work-through-properties-of-a-dataset">Work-Through: Properties of a Dataset<a class="anchor" aria-label="anchor" href="#work-through-properties-of-a-dataset"></a></h2>
<hr class="half-width"><div class="section level3">
<h3 id="univariate-properties"><strong>Univariate properties</strong><a class="anchor" aria-label="anchor" href="#univariate-properties"></a></h3>
<p style="text-align: justify;">
For recordings of variables that are contained, for example, in the
columns of a DataFrame, we often assume the independence of samples: the
measurement in one row does not depend on the recording present in
another row. Therefore results of the features obtained under the output
of the <kbd>describe</kbd> function, for instance, will not depend on
the order of the rows. Also, while the numbers obtained from different
rows can be similar (or even the same) by chance, there is no way to
<em>predict</em> the values in one row based on the values of another.
</p>
<p style="text-align: justify;">
Contrastingly, when comparing different variables arranged in columns,
this is not necessarily the case. Let us firstly assume that they are
consistent: that all values in a single row are obtained from the same
subject. The values in one column can be related to the numbers in
another column and, specifically, they can show degrees of similarity.
If, for instance, we have a number of subjects investigated (some of
whom have an inflammatory disease and some of whom are healthy controls)
an inflammatory marker might be expected to be elevated in the diseased
subjects. If several markers are recorded from each subject (i.e. more
than one column in the data frame), the values of several inflammatory
markers may be elevated simultaneously in the diseased subjects. Thus,
the profiles of these markers across the whole group will show a certain
similarity.
</p>
<p style="text-align: justify;">
The goal of multivariate data analysis is to find out whether or not any
relationships exist between recorded variables.
</p>
Let us first import a demonstration dataset and check its basic
statistics.
<p style="text-align: justify;">
For a work-through example, we can start with the ‘patients’ dataset.
Let’s firstly import the data from the .csv file using the function
<kbd>read_csv</kbd> from Pandas and load this into a DataFrame. We can
then assess the number of columns and rows using the <kbd>len</kbd>
function. We can also determine the data type of each column, which will
reveal which columns can be analysed, quantitatively.
</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Please adjust path according to operating system &amp; personal path to file</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>df <span class="op">=</span> read_csv(<span class="st">'data/patients.csv'</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>df.head()</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of columns: '</span>, <span class="bu">len</span>(df.columns))</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of rows: '</span>, <span class="bu">len</span>(df))</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>df.head()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   Age  Height  Weight  Systolic  Diastolic  Smoker  Gender
0   38      71   176.0     124.0       93.0       1    Male
1   43      69   163.0     109.0       77.0       0    Male
2   38      64   131.0     125.0       83.0       0  Female
3   40      67   133.0     117.0       75.0       0  Female
4   49      64   119.0     122.0       80.0       0  Female
Number of columns:  7
Number of rows:  100
   Age  Height  Weight  Systolic  Diastolic  Smoker  Gender
0   38      71   176.0     124.0       93.0       1    Male
1   43      69   163.0     109.0       77.0       0    Male
2   38      64   131.0     125.0       83.0       0  Female
3   40      67   133.0     117.0       75.0       0  Female
4   49      64   119.0     122.0       80.0       0  Female</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The columns are of the following data types:'</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>df.dtypes</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The columns are of the following data types:
Age            int64
Height         int64
Weight       float64
Systolic     float64
Diastolic    float64
Smoker         int64
Gender        object
dtype: object</code></pre>
</div>
<p style="text-align: justify;">
Out of the seven columns, three contain integers, three contain
floating-point (decimal) numbers, and the last one contains gender
specification as ‘female’ or ‘male’ - held as string data. The sixth
column in this dataset contains a binary classification, with a value of
‘0’ indicating a non-smoker individual and ‘1’ indicating a smoker.
Numerical analysis can thus be restricted to columns with indices 0 to
4.
</p>
<div id="practice-exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="practice-exercise-1" class="callout-inner">
<h3 class="callout-title">Practice Exercise 1</h3>
<div class="callout-content">
<p><strong>Univariate properties of the patients dataset</strong></p>
<ol style="list-style-type: decimal"><li><p>Obtain the basic statistical properties of the first five columns
using the <code>describe</code> function.</p></li>
<li><p>Plot a bar chart of the means of each column. To access a row by
its name, you can use the convention
<code>df_describe.loc['name']</code>.</p></li>
<li><p><strong>Optional:</strong> In the bar chart of the means, try to
add the standard deviation as an errorbar, using the keyword argument
<code>yerr</code> in the form
<code>yerr = df_describe.loc['std']</code>.</p></li>
</ol></div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Q1 </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>df <span class="op">=</span> read_csv(<span class="st">'data/patients.csv'</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>df_describe <span class="op">=</span> df.iloc[:, :<span class="dv">5</span>].describe()</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>df_describe.<span class="bu">round</span>(<span class="dv">2</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          Age  Height  Weight  Systolic  Diastolic
count  100.00  100.00  100.00    100.00     100.00
mean    38.28   67.07  154.00    122.78      82.96
std      7.22    2.84   26.57      6.71       6.93
min     25.00   60.00  111.00    109.00      68.00
25%     32.00   65.00  130.75    117.75      77.75
50%     39.00   67.00  142.50    122.00      81.50
75%     44.00   69.25  180.25    127.25      89.00
max     50.00   72.00  202.00    138.00      99.00</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Q2 </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>bins <span class="op">=</span> arange(<span class="dv">5</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>ax.bar(bins, df_describe.loc[<span class="st">'min'</span>])</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-7-3.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Q3 </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>bins <span class="op">=</span> arange(<span class="dv">5</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>ax.bar(bins, df_describe.loc[<span class="st">'min'</span>], yerr<span class="op">=</span>df_describe.loc[<span class="st">'std'</span>])</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>ax.set_xticks(bins)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>ax.set_xticklabels(df.columns[:<span class="dv">5</span>], fontsize<span class="op">=</span><span class="dv">12</span>)<span class="op">;</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-8-5.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="visual-search-for-similarity-the-scatter-plot"><strong>Visual Search for Similarity: the Scatter Plot</strong><a class="anchor" aria-label="anchor" href="#visual-search-for-similarity-the-scatter-plot"></a></h3>
<p style="text-align: justify;">
In Matplotlib, the function <code>scatter</code> allows a user to plot
one variable against another. This is a common way to visually eyeball
your data for relationships between individual columns in a DataFrame.
</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()<span class="op">;</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>ax.scatter(df[<span class="st">'Weight'</span>], df[<span class="st">'Height'</span>])<span class="op">;</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Weight (pounds)'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Height (inches)'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-9-7.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
The data points appear to be grouped into two clouds. We will not deal
with this qualitative aspect further, at this point. Grouping will be
discussed in more detail in L2D’s later lessons on Unsupervised Machine
Learning and Clustering.
</p>
<p style="text-align: justify;">
However, from the information shown on the plot, it is reasonable to
suspect a trend where heavier people are also taller. For instance, we
note that there are no points in the lower right corner of the plot
(weight &gt;160 pounds and height &lt; 65 inches).
</p>
<div id="practice-exercise-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="practice-exercise-2" class="callout-inner">
<h3 class="callout-title">## Practice Exercise 2</h3>
<div class="callout-content">
<p><strong>DIY2: Scatter plot from the patients data</strong></p>
<p style="text-align: justify;">
Plot systolic against diastolic blood pressure. Do the two variables
appear to be independent, or related?
</p>
<p style="text-align: justify;">
Scatter plots are useful for the inspection of select pairs of data.
However, they are only qualitative and thus, it is generally preferred
to have a numerical quantity.
</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()<span class="op">;</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>ax.scatter(df[<span class="st">'Systolic'</span>], df[<span class="st">'Diastolic'</span>])<span class="op">;</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Systolic'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Diastolic'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-10-9.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
From the plot one might suspect that a larger systolic value is
connected with a larger diastolic value. However, the plot in itself is
not conclusive in that respect.
</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="the-correlation-coefficient">The Correlation Coefficient<a class="anchor" aria-label="anchor" href="#the-correlation-coefficient"></a></h2>
<hr class="half-width"><p style="text-align: justify;">
Bivariate measures are quantities that are calculated from two variables
of data. Bivariate features are the most widely used subset of
multivariate features - all of which require more than one variable in
order to be calculated.
</p>
<p style="text-align: justify;">
The concept behind many bivariate measures is to quantify “similarity”
between two datasets. If any similarity is observed, it is assumed that
there is a connection or relationship in the data. For variables
exhibiting similarity, knowledge of one understandably leads to an
expectation surrounding the other.
</p>
<p style="text-align: justify;">
Here we are going to look at a specific bivariate quantity: the <a href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient" class="external-link">Pearson
correlation coefficient</a> <span class="math inline">\(PCC\)</span>.
</p>
<p style="text-align: justify;">
The formula for the <span class="math inline">\(PCC\)</span> is set up
such that two identical datasets yield a <span class="math inline">\(PCC\)</span> of 1. Technically, this is achieved
by normalising all variances to be equal to 1. This also implies that
all data points in a scatter plot of one variable plotted against itself
are aligned along the main diagonal (with a positive slope).
</p>
<p style="text-align: justify;">
In two perfectly antisymmetrical datasets, where one variable can be
obtained by multiplying the other by -1, a value of -1 is obtained. This
implies that all data points in a scatter plot are aligned along the
negative, or anti diagonal, (with a negative slope). All other
possibilities lie in between. A value of 0 refers to precisely balanced
positive and negative contributions to the measure. However - strictly
speaking - the latter does not necessarily indicate that there is no
relationship between the variables.
</p>
<p style="text-align: justify;">
The <span class="math inline">\(PCC\)</span> is an
<strong>undirected</strong> measure. This means that its value for the
comparison between dataset 1 and dataset 2 is exactly the same as the
<span class="math inline">\(PCC\)</span> between dataset 2 and dataset
1.
</p>
<p style="text-align: justify;">
A method to directly calculate the <span class="math inline">\(PCC\)</span> of two datasets, is to use the
function <code>corr</code> and apply this to your DataFrame. For
instance, we can apply it to the Everleys dataset:
</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>df_everley <span class="op">=</span> read_csv(<span class="st">'data/everleys_data.csv'</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>df_everley.corr()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          calcium    sodium
calcium  1.000000 -0.258001
sodium  -0.258001  1.000000</code></pre>
</div>
<p style="text-align: justify;">
The result as a matrix of two-by-two numbers. Along the diagonal (top
left and bottom right) are the values for the comparison of a column to
itself. As any dataset is identical with itself, the values are one by
definition.
</p>
<p style="text-align: justify;">
The non-diagonal elements indicate that <span class="math inline">\(CC
\approx-0.26\)</span> for the two datasets. Both <span class="math inline">\(CC(12)\)</span> and <span class="math inline">\(CC(21)\)</span> are given in the matrix, however
because of the symmetry, we would only need to report one out of the
two.
</p>
<div id="note-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="note-1" class="callout-inner">
<h3 class="callout-title">Note</h3>
<div class="callout-content">
<p style="text-align: justify;">
In this lesson we introduce how to calculate the <span class="math inline">\(PCC\)</span> but do not discuss its significance.
For example, interpreting the value above requires consideration of the
fact that we only have only 18 data points. Specifically, we refrain
from concluding that because the <span class="math inline">\(PCC\)</span> is negative, a high value for the
calcium concentration is associated with a small value for sodium
concentration (relative to their respective means).
</p>
<p style="text-align: justify;">
One quantitative way to assess whether or not a given value of the <span class="math inline">\(PCC\)</span> is meaningful or not, is to use
surrogate data. In our example, we could create random numbers in an
array with shape (18, 2), for instance - such that the two means and
standard deviations are the same as in the Everley dataset, but the two
columns are independent of each other. Creating many realisations, we
can check what distribution of <span class="math inline">\(PCC\)</span>
values is expected from the randomly generated data, and compare this
against the values obtained from the Everleys dataset.
</p>
</div>
</div>
</div>
<p style="text-align: justify;">
Much of what we will cover in the Machine Learning component of L2D will
involve NumPy arrays. Let us, therefore, convert the Everleys dataset
from a Pandas DataFrame into a NumPy array.
</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>everley_numpy <span class="op">=</span> df_everley.to_numpy()</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>everley_numpy</span></code></pre>
</div>
<p>array([[ 3.4555817 , 112.69098 ], [ 3.6690263 , 125.66333 ], [
2.7899104 , 105.82181 ], [ 2.9399 , 98.172772 ], [ 5.42606 , 97.931489
], [ 0.71581063, 120.85833 ], [ 5.6523902 , 112.8715 ], [ 3.5713201 ,
112.64736 ], [ 4.3000669 , 132.03172 ], [ 1.3694191 , 118.49901 ], [
2.550962 , 117.37373 ], [ 2.8941294 , 134.05239 ], [ 3.6649873 ,
105.34641 ], [ 1.3627792 , 123.35949 ], [ 3.7187978 , 125.02106 ], [
1.8658681 , 112.07542 ], [ 3.2728091 , 117.58804 ], [ 3.9175915 ,
101.00987 ]])</p>
<p style="text-align: justify;">
We can see that the numbers remain the same, but the format has changed;
we have lost the names of the columns. Similar to a Pandas DataFrame, we
can also make use of the <kbd>shape</kbd> function to see the dimensions
of the data array.
</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>everley_numpy.shape</span></code></pre>
</div>
<p>(18, 2)</p>
<p>We can now use the NumPy function <kbd>corrcoef</kbd> to calculate
the Pearson correlation:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> corrcoef</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>corr_matrix <span class="op">=</span> corrcoef(everley_numpy, rowvar<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="bu">print</span>(corr_matrix)</span></code></pre>
</div>
<p>[[ 1. -0.25800058] [-0.25800058 1. ]]</p>
<p style="text-align: justify;">
The function <kbd>corrcoef</kbd> takes a two-dimensional array as its
input. The keyword argument <code>rowvar</code> is True by default,
which means that the correlation will be calculated along the rows of
the dataset. As we have the data features contained in the columns, the
value of <code>rowvar</code> needs to be set to False. (You can check
what happens if you set it to ‘True’. Instead of a 2x2 matrix for two
columns you will get a 18x18 matrix for eighteen pair comparisons.)
</p>
<p style="text-align: justify;">
We mentioned that the values of the <span class="math inline">\(PCC\)</span> are calculated such that they must
lie between -1 and 1. This is achieved by normalisation with the
variance. If, for any reason, we don’t want the similarity calculated
using this normalisation, what results is the so-called
<strong>covariance</strong>. In contrast to the <span class="math inline">\(PCC\)</span>, its values will depend on the
absolute size of the numbers in the data array. From the NumPy library,
we can use the function <kbd>cov</kbd> in order to calculate the
covariance:
</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> cov</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>cov_matrix <span class="op">=</span> cov(everley_numpy, rowvar<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="bu">print</span>(cov_matrix)</span></code></pre>
</div>
<p>[[ 1.70733842 -3.62631625] [ -3.62631625 115.70986192]]</p>
<p style="text-align: justify;">
The result shows how covariance is strongly dependent on the actual
numerical values in a data column. The two values along the diagonal are
identical with the variances obtained by squaring the standard deviation
(calculated, for example, using the <kbd>describe</kbd> function).
</p>
<div id="practice-exercise-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="practice-exercise-3" class="callout-inner">
<h3 class="callout-title">Practice Exercise 3</h3>
<div class="callout-content">
<p><strong>Correlations from the patients dataset</strong></p>
<p>Calculate the Pearson <span class="math inline">\(PCC\)</span>
between the systolic and the diastolic blood pressure from the patients
data using:</p>
<ol style="list-style-type: lower-roman"><li><p>The Pandas DataFrame and</p></li>
<li><p>The data as a NumPy array.</p></li>
</ol></div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Q1 </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>df <span class="op">=</span> read_csv(<span class="st">'data/patients.csv'</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>df[[<span class="st">'Systolic'</span>, <span class="st">'Diastolic'</span>]].corr()</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>       <span class="ex">Systolic</span>  Diastolic</span></code></pre>
</div>
<p>Systolic 1.000000 0.511843 Diastolic 0.511843 1.000000</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Q2 </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>df_SysDia_numpy <span class="op">=</span> df[[<span class="st">'Systolic'</span>, <span class="st">'Diastolic'</span>]].to_numpy()</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>df_SysDia_corr <span class="op">=</span> corrcoef(df_SysDia_numpy, rowvar<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Correlation coefficient between Systole and Diastole:'</span>, <span class="bu">round</span>(df_SysDia_corr[<span class="dv">0</span>, <span class="dv">1</span>], <span class="dv">2</span>))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Correlation coefficient between Systole and Diastole: 0.51</code></pre>
</div>
<p style="text-align: justify;">
It is worth noting that it is equally possible to calculate the
correlation between rows of a two-dimension array
(i.e. <code>rowvar=True</code>) but the interpretation will differ.
Imagine a dataset where for two subjects a large number, call it <span class="math inline">\(N\)</span>, of metabolites were determined
quantitatively (a Metabolomics dataset). If that dataset is of shape (2,
N) then one can calculate the correlation between the two rows. This
would be done to determine the correlation of the metabolite profiles
between the two subjects.
</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="the-correlation-matrix">The Correlation Matrix<a class="anchor" aria-label="anchor" href="#the-correlation-matrix"></a></h2>
<hr class="half-width"><p style="text-align: justify;">
If we have more than two columns of data, we can obtain a Pearson
correlation coefficient for each pair. In general, for N columns, we get
<span class="math inline">\(N^2\)</span> pairwise values. We will omit
the correlations of each column relative to itself, of which there are
<span class="math inline">\(N\)</span>, which means we are left with
<span class="math inline">\(N*(N-1)\)</span> pairs. Since each value
appears twice, due to the symmetry of the calculation, we can ignore
half of them, leaving us with <span class="math inline">\(N*(N-1) /
2\)</span> coefficients for <span class="math inline">\(N\)</span>
columns.
</p>
<p>Here is an example using the ‘patients’ data:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>df <span class="op">=</span> read_csv(<span class="st">'data/patients.csv'</span>)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>df.corr()</span></code></pre>
</div>
<p>ValueError: could not convert string to float: ‘Male’</p>
<p style="text-align: justify;">
If we do the calculation with the Pandas DataFrame, the ‘Gender’ is
automatically ignored and, by default, we get <span class="math inline">\(6*5/2=15\)</span> coefficients for the remaining
six columns. Note that the values that involves the ‘Smoker’ column are
meaningless, since they represent a True/False-like binary.
</p>
<p>Let us now convert the DataFrame into a NumPy array, and check its
shape:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>patients_numpy <span class="op">=</span> df.to_numpy()</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>patients_numpy.shape</span></code></pre>
</div>
<p>(100, 7)</p>
<p style="text-align: justify;">
Next, we can try to calculate the correlation matrix for the first five
columns of this data array. If we do this directly to the array, we get
an AttributeError: ‘float’ object has no attribute ‘shape’.
</p>
<p style="text-align: justify;">
This is amended by converting the array to a floating point prior to
using the <kbd>corrcoef</kbd> function. For this, we can convert the
data type using the method <code>astype(float)</code>:
</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>cols <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>patients_numpy_float <span class="op">=</span> patients_numpy[:, :cols].astype(<span class="bu">float</span>)</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>patients_corr <span class="op">=</span> corrcoef(patients_numpy_float, rowvar<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>patients_corr</span></code></pre>
</div>
<p>array([[1. , 0.11600246, 0.09135615, 0.13412699, 0.08059714],
[0.11600246, 1. , 0.6959697 , 0.21407555, 0.15681869], [0.09135615,
0.6959697 , 1. , 0.15578811, 0.22268743], [0.13412699, 0.21407555,
0.15578811, 1. , 0.51184337], [0.08059714, 0.15681869, 0.22268743,
0.51184337, 1. ]])</p>
<p style="text-align: justify;">
The result is called the <strong>correlation matrix</strong>. It
contains all the bivariate comparisons possible for the five chosen
columns.
</p>
<p style="text-align: justify;">
In the calculation above, we used the <span class="math inline">\(PCC\)</span> in order to calculate the matrix. In
general, any bivariate measure can be used to obtain a matrix of the
same shape.
</p>
<div class="section level3">
<h3 id="heatmaps-in-matplotlib"><strong>Heatmaps in Matplotlib</strong><a class="anchor" aria-label="anchor" href="#heatmaps-in-matplotlib"></a></h3>
<p style="text-align: justify;">
To get an illustration of the correlation pattern in a dataset, we can
plot the correlation matrix as a heatmap.
</p>
<p style="text-align: justify;">
Below are three lines of code, that make use of functionality within
<code>Matplotlib</code>, to plot a heatmap of the correlation matrix
from the ‘patients’ dataset. We make use of the function
<kbd>imshow</kbd>:
</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">5</span>,<span class="dv">5</span>))</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>im <span class="op">=</span> ax.imshow(patients_corr, cmap<span class="op">=</span><span class="st">'coolwarm'</span>)<span class="op">;</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-21-11.png" width="480" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
Note: we have specified the colour map <code>coolwarm</code>, using the
keyword argument <code>cmap</code>. For a list of
<code>Matplotlib</code> colour maps, please refer to the <a href="https://matplotlib.org/3.1.1/gallery/color/colormap_reference.html" class="external-link">gallery
in the documentation</a>. The names to use in the code are on the left
hand side of the colour bar.
</p>
Let us add two more features to improve this figure.
<p style="text-align: justify;">
Firstly, in order to highlight true correlations stand out (rather than
the trivial self-correlations along the diagonal, which are always equal
to 1) we can deliberately set the diagonal as being equal to 0. To
achieve this, we use the NumPy function <kbd>fill_diagonal</kbd>.
</p>
<p style="text-align: justify;">
Secondly, the <kbd>imshow</kbd> function, by default, will scale the
colours to the minimum and maximum values present in the array. As such,
we do not know what red or blue means. To see the colour bar, it can be
added to the figure environment ‘fig’ using <code>colorbar</code>.
</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> fill_diagonal</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>fill_diagonal(patients_corr, <span class="dv">0</span>)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">7</span>,<span class="dv">7</span>))</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>im <span class="op">=</span> ax.imshow(patients_corr, cmap<span class="op">=</span><span class="st">'coolwarm'</span>)<span class="op">;</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>fig.colorbar(im, orientation<span class="op">=</span><span class="st">'horizontal'</span>, shrink<span class="op">=</span><span class="fl">0.7</span>)<span class="op">;</span></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-22-13.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
The result is that the correlation between columns ‘Height’ and ‘Weight’
is the strongest, and presumably higher than would be expected if these
two measures were independent. We can confirm this by plotting a scatter
plot for these two columns, and refer to the scatter plot for columns 2
(Height) and 5 (Diastolic blood pressure):
</p>
<div id="practice-exercise-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="practice-exercise-4" class="callout-inner">
<h3 class="callout-title">Practice Exercise 4</h3>
<div class="callout-content">
<strong>Spearman Correlations from the patients dataset</strong>
<p style="text-align: justify;">
Calculate and plot the correlation matrix of the first five columns, as
above, based on the <a href="https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient" class="external-link">Spearman
rank correlation coefficient</a>. This is based on the ranking of values
instead of their numerical values as for the Pearson coefficient.
Spearman therefore tests for monotonic relationships, whereas Pearson
tests for linear relationships.
</p>
<p>To import the function in question:</p>
<pre><code>from scipy.stats import spearmanr</code></pre>
<p>You can then apply it:</p>
<pre><code>data_spearman_corr = spearmanr(data).correlation</code></pre>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7"> Show me the solution </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" data-bs-parent="#accordionSolution7" aria-labelledby="headingSolution7">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> spearmanr</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>patients_numpy <span class="op">=</span> df.to_numpy()</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>cols <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>patients_numpy_float <span class="op">=</span> patients_numpy[:, :cols].astype(<span class="bu">float</span>)</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>patients_spearman <span class="op">=</span> spearmanr(patients_numpy_float).correlation</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>patients_spearman</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>array([[1.        , 0.11636668, 0.09327152, 0.12105741, 0.08703685],
       [0.11636668, 1.        , 0.65614849, 0.20036338, 0.14976559],
       [0.09327152, 0.65614849, 1.        , 0.12185782, 0.19738765],
       [0.12105741, 0.20036338, 0.12185782, 1.        , 0.48666928],
       [0.08703685, 0.14976559, 0.19738765, 0.48666928, 1.        ]])</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> fill_diagonal</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>fill_diagonal(patients_spearman, <span class="dv">0</span>)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">7</span>,<span class="dv">7</span>))</span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>im <span class="op">=</span> ax.imshow(patients_spearman, cmap<span class="op">=</span><span class="st">'coolwarm'</span>)<span class="op">;</span></span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>fig.colorbar(im, orientation<span class="op">=</span><span class="st">'horizontal'</span>, shrink<span class="op">=</span><span class="fl">0.7</span>)<span class="op">;</span></span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-24-15.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="analysis-of-the-correlation-matrix">Analysis of the Correlation matrix<a class="anchor" aria-label="anchor" href="#analysis-of-the-correlation-matrix"></a></h2>
<hr class="half-width"><div class="section level3">
<h3 id="the-correlation-coefficients"><strong>The Correlation Coefficients</strong><a class="anchor" aria-label="anchor" href="#the-correlation-coefficients"></a></h3>
<p style="text-align: justify;">
To analyse the correlations in a dataset, we are only interested in the
<span class="math inline">\(N*(N-1)/2\)</span> unduplicated correlation
coefficients. Here is a way to extract them and assign them to a
variable.
</p>
<p style="text-align: justify;">
Firstly, we must import the function <kbd>triu_indices</kbd>. It
provides the indices of a matrix with specified size. The required size
is obtained from our correlation matrix, using <kbd>len</kbd>. It is
identical to the number of columns for which we calculated the <span class="math inline">\(CCs\)</span>.
</p>
<p style="text-align: justify;">
We also need to specify that we do not want the diagonal to be included.
For this, there is an offset parameter ‘k’, which collects the indices
excluding the diagonal, provided it is set to 1. (To include the indices
of the diagonal, it would have to be set to 0).
</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> triu_indices</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a><span class="co"># Get the number of rows of the correlation matrix</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>no_cols <span class="op">=</span> <span class="bu">len</span>(patients_corr)</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="co"># Get the indices of the 10 correlation coefficients for 5 data columns</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>corr_coeff_indices <span class="op">=</span> triu_indices(no_cols, k<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a><span class="co"># Get the 10 correlation coefficients</span></span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>corr_coeffs <span class="op">=</span> patients_corr[corr_coeff_indices]</span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a><span class="bu">print</span>(corr_coeffs)</span></code></pre>
</div>
<p>[0.11600246 0.09135615 0.13412699 0.08059714 0.6959697 0.21407555
0.15681869 0.15578811 0.22268743 0.51184337]</p>
<p>Now we plot these correlation coefficients as a bar chart to see them
one next to each other.</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>bins <span class="op">=</span> arange(<span class="bu">len</span>(corr_coeffs))</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>ax.bar(bins, corr_coeffs)<span class="op">;</span></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-26-17.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>If there are a large number of coefficients, we can also display
their histogram or boxplot as summary statistics.</p>
</div>
<div class="section level3">
<h3 id="the-average-correlation-per-column"><strong>The Average Correlation per Column</strong><a class="anchor" aria-label="anchor" href="#the-average-correlation-per-column"></a></h3>
<p style="text-align: justify;">
On a higher level, we can calculate the overall, or average correlation
per data column. This can be achieved by averaging over either the rows
or the columns of the correlation matrix. Because our similarity measure
is undirected, both ways of summing yield the same result.
</p>
<p style="text-align: justify;">
However, we need to consider whether the value is positive or negative.
Correlation coefficients can be either positive or negative. As such,
adding for instance +1 and -1 would yield an average of 0, even though
both indicate perfect correlation and anti-correlation, respectively.
This can be addressed by using the absolute value <code>abs</code>, and
ignoring the sign.
</p>
<p style="text-align: justify;">
In order to average, we can use the NumPy function: <kbd>mean</kbd>.
This function defaults to averaging over all values of the matrix. In
order to obtain the five values by averaging over the columns, we
specify the ‘axis’ keyword argument must be specified as 0.
</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> <span class="bu">abs</span>, mean</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a><span class="co"># Absolute values of correlation matrix</span></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>corr_matrix_abs <span class="op">=</span> <span class="bu">abs</span>(patients_corr)</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a><span class="co"># Average of the correlation strengths</span></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>corr_column_average <span class="op">=</span> mean(corr_matrix_abs, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>bins <span class="op">=</span> arange(corr_column_average.shape[<span class="dv">0</span>])</span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a>ax.bar(bins, corr_column_average )<span class="op">;</span></span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a><span class="bu">print</span>(corr_column_average)</span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a>show()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[0.08441655 0.23657328 0.23316028 0.20316681 0.19438933]</code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-27-19.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
The result is that the average column correlation is on the order of 0.2
for the columns with indices 1 to 4, and less than 0.1 for the column
with index 0 (which is age).
</p>
</div>
<div class="section level3">
<h3 id="the-average-dataset-correlation"><strong>The Average Dataset Correlation</strong><a class="anchor" aria-label="anchor" href="#the-average-dataset-correlation"></a></h3>
<p style="text-align: justify;">
The sum over rows or columns has given us a reduced set of values to
look at. We can now take the final step and average over all correlation
coefficients. This will yield the average correlation of the dataset. It
condenses the full bivariate analysis into a single number, and can be a
starting point when comparing different datasets of the same type, for
example.
</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="co"># Average of the correlation strengths</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>corr_matrix_average <span class="op">=</span> mean(corr_matrix_abs)</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Average correlation strength: '</span>, <span class="bu">round</span>(corr_matrix_average, <span class="dv">3</span>))</span></code></pre>
</div>
<p>Average correlation strength: 0.19</p>
</div>
</section><section><h2 class="section-heading" id="application-the-diabetes-dataset">Application: The Diabetes Dataset<a class="anchor" aria-label="anchor" href="#application-the-diabetes-dataset"></a></h2>
<hr class="half-width"><p style="text-align: justify;">
We now return to the dataset that began our enquiry into DataFrames in
the previous lesson. Let us apply the above, and perform a summary
analysis of its bivariate features.
</p>
<p style="text-align: justify;">
Firstly, import the data. This is one of the example datasets from
scikit-learn: a Python library used for Machine Learning. It is already
included in the Anaconda distribution of Python, and can therefore be
directly imported, if you have installed this.
</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> datasets</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>diabetes <span class="op">=</span> datasets.load_diabetes()</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>data_diabetes <span class="op">=</span> diabetes.data</span></code></pre>
</div>
<p style="text-align: justify;">
For the bivariate features, let us get the correlation matrix and plot
it as a heatmap. We can make use of code that introduced above.
</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> fill_diagonal</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>data_corr_matrix <span class="op">=</span> corrcoef(data_diabetes, rowvar<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>fill_diagonal(data_corr_matrix, <span class="dv">0</span>)</span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a>im <span class="op">=</span> ax.imshow(data_corr_matrix, cmap<span class="op">=</span><span class="st">'coolwarm'</span>)<span class="op">;</span></span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a>fig.colorbar(im, orientation<span class="op">=</span><span class="st">'horizontal'</span>, shrink<span class="op">=</span><span class="fl">0.5</span>)<span class="op">;</span></span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-30-21.png" width="768" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
There is one strongly correlated pair (column indices 4 and 5) and one
strongly anti-correlated pair (column indices 6 and 7).
</p>
<p>Let’s calculate the <span class="math inline">\(10*9/2 = 45\)</span>
correlation coefficients and plot them as a histogram:</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> triu_indices</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>data_corr_coeffs <span class="op">=</span> data_corr_matrix[triu_indices(data_corr_matrix.shape[<span class="dv">0</span>], k<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>ax.hist(data_corr_coeffs, bins<span class="op">=</span><span class="dv">10</span>)<span class="op">;</span></span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-31-23.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
This histogram shows that the data have a distribution that is shifted
towards positive correlations. However, only four values are
(absolutely) larger than 0.5 (three positive, one negative).
</p>
<p>Next, let’s obtain the average (absolute) correlation per column.</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>data_column_average <span class="op">=</span> mean(<span class="bu">abs</span>(data_corr_matrix), axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a>bins <span class="op">=</span> arange(<span class="bu">len</span>(data_column_average))</span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a>ax.bar(bins, data_column_average)<span class="op">;</span></span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a>ax.set_title(<span class="st">'Average Correlation Strength per Column'</span>)</span>
<span id="cb42-9"><a href="#cb42-9" tabindex="-1"></a>ax.set_xticks(arange(<span class="bu">len</span>(diabetes.feature_names)))</span>
<span id="cb42-10"><a href="#cb42-10" tabindex="-1"></a>ax.set_xticklabels(diabetes.feature_names)<span class="op">;</span></span>
<span id="cb42-11"><a href="#cb42-11" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-32-25.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>In the plot, note how the column names were extracted from the
‘diabetes’ data using <code>diabetes.feature_names</code>.</p>
<p>Finally, let’s obtain the average correlation of the entire
dataset.</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="co"># Average of the correlation strengths</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>data_corr_matrix_average <span class="op">=</span> mean(<span class="bu">abs</span>(data_corr_matrix))</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Average Correlation Strength: '</span>, <span class="bu">round</span>(data_corr_matrix_average, <span class="dv">3</span>))</span></code></pre>
</div>
<p>Average Correlation Strength: 0.29</p>
</section><section><h2 class="section-heading" id="exercises">Exercises<a class="anchor" aria-label="anchor" href="#exercises"></a></h2>
<hr class="half-width"><div id="end-of-chapter-exercises" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="end-of-chapter-exercises" class="callout-inner">
<h3 class="callout-title">End of chapter Exercises</h3>
<div class="callout-content">
<p><strong>Assignment: The Breast Cancer Dataset</strong></p>
<p>Import the breast cancer dataset using <kbd>read_csv</kbd>. Based on
the code in this lesson, try to do the following:</p>
<ol style="list-style-type: decimal"><li><p>Get the summary (univariate) statistics of columns 2-10
(accessing indices 1:10) using <kbd>describe</kbd></p></li>
<li><p>Plot the means of each column as a bar chart with standard
deviations displayed as error bars. Why are some bars
invisible?</p></li>
<li><p>Extract the values as a NumPy array using the <kbd>to_numpy</kbd>
function. The shape of the array should be (569, 31).</p></li>
<li><p>Calculate the correlation matrix using <kbd>corrcoef</kbd> from
NumPy and plot it as a heatmap. The shape of the matrix should be (31,
31). Use <code>fill_diagonal</code> to set the diagonal elements to
0.</p></li>
<li><p>Calculate the average column correlation and plot it as a bar
chart.</p></li>
<li><p>Calculate the average correlation strength of the
dataset.</p></li>
</ol><p>In case of doubt, try to get help from the respective documentation
available for Pandas DataFrames, NumPy and Matplotlib.</p>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8"> Solutions are provided after assignments are marked. </h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" data-bs-parent="#accordionSolution8" aria-labelledby="headingSolution8">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul><li>Quantities based on data from two variables are referred to as
bivariate measures.</li>
<li>Bivariate properties can be studied and visualised using
<code>matplotlib</code> and <code>NumPy</code>.</li>
<li>Multivariate data analyses can help to uncover relationships between
recorded variables.</li>
<li>The functions <code>corr</code> and <code>corrcoef</code> can be
used to calculate the <span class="math inline">\(PCC\)</span>.</li>
<li>A correlation matrix can be visualised as a heatmap.</li>
</ul></div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/01-data_frames_1.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/03-image_handling.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/01-data_frames_1.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: DataFrames - Part 1
        </a>
        <a class="chapter-link float-end" href="../instructor/03-image_handling.html" rel="next">
          Next: Image Handling...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/02-data_frames_2.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/carpentries/workbench-template-rmd/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries/workbench-template-rmd/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries/workbench-template-rmd/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/69aaefee46a17928e2a1694825599e169b9793e3" class="external-link">sandpaper (0.16.10)</a>, <a href="https://github.com/carpentries/pegboard/tree/bad0be19a12f0c6545801b276ddf26c945f8bfd1" class="external-link">pegboard (0.7.7)</a>, and <a href="https://github.com/milanmlft/varnish/tree/milanmlft/sticky-sidebar" class="external-link">varnish (1.0.3.9000)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://carpentries.github.io/workbench-template-rmd/instructor/02-data_frames_2.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "DataFrames - Part 2",
  "creativeWorkStatus": "active",
  "url": "https://carpentries.github.io/workbench-template-rmd/instructor/02-data_frames_2.html",
  "identifier": "https://carpentries.github.io/workbench-template-rmd/instructor/02-data_frames_2.html",
  "dateCreated": "2022-06-14",
  "dateModified": "2025-01-05",
  "datePublished": "2025-01-05"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

