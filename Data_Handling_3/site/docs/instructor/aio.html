<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Data Handling: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="manifest" href="../site.webmanifest">
<link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav l2d"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="l2d" src="../assets/images/l2d-logo.svg">
</div>
    </div>
    <div class="selector-container">


      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav l2d" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="l2d" src="../assets/images/l2d-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Data Handling
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Data Handling
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr></ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Data Handling
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress l2d">
    <div class="progress-bar l2d" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar" style="display: flex">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle sticky-top" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner sticky-top">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-data_frames_1.html">1. DataFrames - Part 1</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-data_frames_2.html">2. DataFrames - Part 2</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-image_handling.html">3. Image Handling</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
</ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-01-data_frames_1"><p>Content from <a href="01-data_frames_1.html">DataFrames - Part 1</a></p>
<hr>
<p>Last updated on 2025-01-05 |

        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/01-data_frames_1.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 120 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p><a href="https://drive.usercontent.google.com/u/1/uc?id=1BwmP3qeemi5YFkTGMw-r8-z6L15_gE2B&amp;export=download" class="external-link"><strong>Download
chapter PDF (.pdf).</strong></a></p>
<p><a href="https://drive.usercontent.google.com/u/1/uc?id=10T_wlrFbCu1ijkIc3QtrPUpi4k2oAxBA&amp;export=download" class="external-link"><strong>Download
chapter notebook (.ipynb).</strong></a></p>
<p><a href="https://docs.google.com/forms/d/e/1FAIpQLSdr0capF7jloJhPH3Pki1B3LZoKOG16poOpuVJ7SL2LkwLHQA/viewform?pli=1" class="external-link"><span style="color: rgb(255, 0, 0);"><strong>Mandatory Lesson Feedback
Survey</strong></span></a></p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is a Dataframe, and how can we read data into one?</li>
<li>What are the different methods for manipulating data in
Dataframes?</li>
<li>What makes data visualisation simple, in Python?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Import a dataset as a Pandas Dataframe</li>
<li>Inspect a Dataframe and access data</li>
<li>Produce an overview of data features</li>
<li>Create data plots using Matplotlib</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<br><p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/jdWOAzK81VE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</p>
<p><br></p>
<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/zw6t3yHEqGU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</p>
<p><br></p>
<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/mljXcIzx4ps" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</p>
<p><br></p>
<div id="prerequisites" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="prerequisites" class="callout-inner">
<h3 class="callout-title">Prerequisites</h3>
<div class="callout-content">
<ul>
<li><a href="https://github.com/L2D-July2024-Part-I/Basic_Python/04-arrays.html#sec:list:indexing" class="external-link">Indexing
of arrays</a></li>
<li><a href="https://github.com/L2D-July2024-Part-I/Basic_Python/05-iterations.html#retaining-the-new-values" class="external-link">For-loop
through an array</a></li>
<li>Basic statistics (distributions, mean, median and standard
deviation)</li>
</ul>
</div>
</div>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<p>The diabetes data set is one of the challenging task.</p>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="challenge-the-diabetes-dataset">Challenge: The diabetes dataset<a class="anchor" aria-label="anchor" href="#challenge-the-diabetes-dataset"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
Here is a screenshot of a diabetes dataset. It is taken from <a href="https://www4.stat.ncsu.edu/~boos/var.select/diabetes.tab.txt" class="external-link">this
webpage</a>, and is one of the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_diabetes.html" class="external-link">example
datasets</a> used to illustrate machine learning functionality in
scikit-learn (Part II of the L2D course).
</p>
<figure><img src="../fig/diabetes_data_screenshot.png" title="Screenshot of Diabetes Data" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
This figure captures only the top part of the data. On the webpage, you
will need to scroll down considerably to view all of it. Thus, our first
data science task, will be to obtain an overview of this datset.
</p>
<div id="the-lesson" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="the-lesson" class="callout-inner">
<h3 class="callout-title">The lesson</h3>
<div class="callout-content">
<ul>
<li>Introduces code to read and inspect the data</li>
<li>Works with a specific Dataframe and explains methods used to get an
overview of the data</li>
<li>Discusses the concept of ‘distribution’ as a way of summarising data
within a single figure</li>
</ul>
<div id="to-familiarise-yourself-with-a-dataset-you-need-to" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="to-familiarise-yourself-with-a-dataset-you-need-to" class="callout-inner">
<h3 class="callout-title">To familiarise yourself with a dataset you need to:</h3>
<div class="callout-content">
<ul>
<li>Access the data</li>
<li>Check the content</li>
<li>Produce a summary of basic properties</li>
</ul>
</div>
</div>
</div>
<p style="text-align: justify;">
In this lesson we will look solely at univariate features, where each
data columns are studied independently of the others in the datasets.
Further properties and bivariate features will be the topic of the next
lesson.
</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="work-through-example">Work-Through Example<a class="anchor" aria-label="anchor" href="#work-through-example"></a>
</h2>
<hr class="half-width">
<div id="reading-data-into-a-pandas-dataframe" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="reading-data-into-a-pandas-dataframe" class="callout-inner">
<h3 class="callout-title">Reading data into a Pandas DataFrame</h3>
<div class="callout-content">
<p style="text-align: justify;">
The small practice data file for this section is called
‘everleys_data.csv’, and can be downloaded using the link given above in
<a href="index.html#setup">Summary and Setup</a> for this Lesson. To start,
please create a subfolder called ‘data’ in the current directory and put
the data file in it. It can now be accessed using the relative path
<code>data/everleys_data.csv</code> or
<code>data\everleys_data.csv</code>, respectively.
</p>
<p style="text-align: justify;">
The file <code>everleys_data.csv</code> contains serum concentrations of
calcium and sodium ions, sampled from 17 patients with Everley’s
syndrome - a rare genetic disorder that results in sufferers
experiencing developmental delays, intellectual and physical
abnormalities. The data are taken from a <a href="https://www.bmj.com/about-bmj/resources-readers/publications/statistics-square-one/7-t-tests" class="external-link">BMJ
statistics tutorial</a>, and are stored as comma-separated values (csv):
with two values given for each patient.
</p>
<p style="text-align: justify;">
To get to know a dataset, we will use the Pandas package and the
Matplotlib plotting library. The Pandas package for data science is
included in the Anaconda distribution of Python. Check this <a href="https://pandas.pydata.org/getting_started.html" class="external-link">link for
installation instructions</a> to get started.
</p>
<p>If you are not using the Anaconda distribution, please refer to <a href="https://pandas.pydata.org/docs/getting_started/install.html" class="external-link">these
guidelines</a>.</p>
<p style="text-align: justify;">
In order to use the functions contained in Pandas, they must first to be
imported. Since our dataset is in a ‘.csv’ file, we must first read it
from a csv file. For this, we must import the function
<code>read_csv</code>, which will create a <em>Pandas DataFrame</em>
from data provided in a ‘.csv’ file.
</p>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">from</span> pandas <span class="im">import</span> read_csv</span></code></pre>
</div>
<p style="text-align: justify;">
Executing this code does not lead to any output on the screen. However,
the function is now ready to be used. To use it, we type its name and
provide the required arguments. The following code should import the
Everley’s data into your Python Notebook:
</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># For Mac OS X and Linux:</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co"># (please go to the next cell if using Windows)</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>df <span class="op">=</span> read_csv(<span class="st">"data/everleys_data.csv"</span>)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># For Windows:</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co"># df = read_csv("data\everleys_data.csv")</span></span></code></pre>
</div>
<p style="text-align: justify;">
Note the orientation of backward and forward slashes that differentiate
filepaths given between Unix-based systems, and Windows. This code uses
the <code>read_csv</code> function from Pandas to read data from a data
file, in this case a file with extension ‘.csv’. Note that the location
of the data file is specified within quotes by the relative path to the
subfolder ‘data’, followed by the file name. Use your file browser or
the browser in JupyterLab (or an ‘Explorer’-type pane in your IDE of
choice) to check that subfolder does indeed exists, and contains the
file within it.
</p>
<figure><img src="../fig/subfolder_data.png" title="Screenshot of subfolder 'data'" class="figure mx-auto d-block"></figure><p>After execution of the code, the data are contained in a variable
called <code>df</code>. This is a structure referred to as a Pandas
<em>DataFrame</em>.</p>
<blockquote>
<p>A <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/dsintro.html#dataframe" class="external-link"><strong>Pandas
DataFrame</strong></a> is a 2-dimensional labelled data structure, with
columns of (potentially different) types. You can think of it as a
spreadsheet.</p>
</blockquote>
<p>To see the contents of <code>df</code>, simply use:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>df</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a> <span class="ex">calcium</span>      sodium</span></code></pre>
</div>
<p>0 3.455582 112.690980 1 3.669026 125.663330 2 2.789910 105.821810 3
2.939900 98.172772 4 5.426060 97.931489 5 0.715811 120.858330 6 5.652390
112.871500 7 3.571320 112.647360 8 4.300067 132.031720 9 1.369419
118.499010 10 2.550962 117.373730 11 2.894129 134.052390 12 3.664987
105.346410 13 1.362779 123.359490 14 3.718798 125.021060 15 1.865868
112.075420 16 3.272809 117.588040 17 3.917591 101.009870</p>
<p>(Compare with the result of <code>print(df)</code> which displays the
contents in a different format.)</p>
<p style="text-align: justify;">
The output shows in the first column an index, integers from 0 to 17;
and the calcium and sodium concentrations in columns 2 and 3,
respectively. The default indexing starts from zero (Python is a
‘zero-based’ programming language).
</p>
<p style="text-align: justify;">
In a DataFrame, the first column is referred to as <em>Indices</em>, the
first row is referred to as <em>Labels</em>. Note that the row with the
labels is excluded from the row count. Similarly, the row with the
indices is excluded from the column count.
</p>
<p>For large datasets, the function <code>head</code> is a convenient
way to get a feel of the dataset.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>df.head()</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">calcium</span>      sodium</span></code></pre>
</div>
<p>0 3.455582 112.690980 1 3.669026 125.663330 2 2.789910 105.821810 3
2.939900 98.172772 4 5.426060 97.931489</p>
<p style="text-align: justify;">
Without any input argument, this displays the first five data lines of
data i the newly-created DataFrame. You can specify and alter the number
of rows displayed by including a single integer as argument,
e.g. <code>head(10)</code>.
</p>
<p style="text-align: justify;">
If you feel there are too many decimal places in the default view, you
can restrict their number by using the <code>round</code> method. The
numerical argument that you provide in the round parentheses controls
the number of decimal places the method rounds to, with digits up to 5
being rounded down, and above (and inclusive of) 5, being rounded up:
</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>df.head().<span class="bu">round</span>(<span class="dv">2</span>)</span></code></pre>
</div>
<p>calcium sodium 0 3.46 112.69 1 3.67 125.66 2 2.79 105.82 3 2.94 98.17
4 5.43 97.93</p>
<p style="text-align: justify;">
While it is possible to see how many rows there are in a DataFrame by
displaying the whole DataFrame and looking at the last index, there is a
convenient way to obtain this number, directly:
</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>no_rows <span class="op">=</span> <span class="bu">len</span>(df)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'DataFrame has'</span>, no_rows, <span class="st">'rows'</span>)</span></code></pre>
</div>
<p>DataFrame has 18 rows</p>
<p>You could see above, that the columns of the DataFrame have labels.
To see all labels:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>column_labels <span class="op">=</span> df.columns</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="bu">print</span>(column_labels)</span></code></pre>
</div>
<p>Index([‘calcium’, ‘sodium’], dtype=‘object’)</p>
<p>Now we can count the labels to obtain the number of columns:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>no_columns <span class="op">=</span> <span class="bu">len</span>(column_labels)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'DataFrame has'</span>, no_columns, <span class="st">'columns'</span>)</span></code></pre>
</div>
<p>DataFrame has 2 columns</p>
<p style="text-align: justify;">
And if you want to have both the number of the rows and the number
columns displayed together, you can use the <code>shape</code> method.
Shape returns a tuple of two numbers: the first is the number of rows,
and the second is the number of columns.
</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>df_shape <span class="op">=</span> df.shape</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'DataFrame has'</span>, df_shape[<span class="dv">0</span>], <span class="st">'rows and'</span>,df_shape[<span class="dv">1</span>],  <span class="st">'columns'</span>)</span></code></pre>
</div>
<p>DataFrame has 18 rows and 2 columns</p>
<p>Notice that <code>shape</code> (like <code>columns</code>) is not
followed by round parentheses. It is not a function that can take
arguments. Technically, <code>shape</code> is a ‘property’ of the
DataFrame.</p>
<p>To find out what data type is contained in each of the columns, us
<code>dtypes</code>, another ‘property’:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>df.dtypes</span></code></pre>
</div>
<p>calcium float64 sodium float64 dtype: object</p>
<p>In this case, both columns contain floating point (decimal)
numbers.</p>
<div id="practice-exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="practice-exercise-1" class="callout-inner">
<h3 class="callout-title">Practice Exercise 1</h3>
<div class="callout-content">
<p><strong>Read data into a DataFrame</strong></p>
<p style="text-align: justify;">
Download the data file ‘loan_data.csv’ using the link given above in <a href="index.html#setup">Summary and Setup</a> for this Lesson”. It contains
data that can be used for the assessment of loan applications. Read the
data into a DataFrame. It is best to assign it a name other than ‘df’
(to avoid overwriting the Evereley dataset).
</p>
<p style="text-align: justify;">
Display the first ten rows of the Loan dataset to see its contents. It
is taken from a <a href="https://www.analyticsvidhya.com/blog/2016/01/complete-tutorial-learn-data-science-python-scratch-2/" class="external-link">tutorial
on Data Handling in Python</a> which you might find useful for further
practice.
</p>
<blockquote>
<p>From this exercise we can see that a DataFrame can contain different
types of data: real numbers (e.g. LoanAmount), integers
(ApplicantIncome), categorical data (Gender), and strings (Loan_ID).</p>
</blockquote>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="im">from</span> pandas <span class="im">import</span> read_csv</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co"># dataframe from .csv file</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>df_loan <span class="op">=</span> read_csv(<span class="st">"data/loan_data.csv"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co"># display contents</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>df_loan.head(<span class="dv">10</span>)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">Loan_ID</span>  Gender Married  ... Loan_Amount_Term Credit_History Property_Area</span></code></pre>
</div>
<p>0 LP001015 Male Yes … 360.0 1.0 Urban 1 LP001022 Male Yes … 360.0 1.0
Urban 2 LP001031 Male Yes … 360.0 1.0 Urban 3 LP001035 Male Yes … 360.0
NaN Urban 4 LP001051 Male No … 360.0 1.0 Urban 5 LP001054 Male Yes …
360.0 1.0 Urban 6 LP001055 Female No … 360.0 1.0 Semiurban 7 LP001056
Male Yes … 360.0 0.0 Rural 8 LP001059 Male Yes … 240.0 1.0 Urban 9
LP001067 Male No … 360.0 1.0 Semiurban</p>
<p>[10 rows x 12 columns]</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="accessing-data-in-a-dataframe">Accessing data in a DataFrame<a class="anchor" aria-label="anchor" href="#accessing-data-in-a-dataframe"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
If a datafile is large and you only want to check the format of data in
a specific column, you can limit the display to that column. To access
data contained in a specific column of a DataFrame, we can use a similar
convention as in a Python dictionary, treating the column names as
‘keys’. E.g. to show all rows in column ‘Calcium’, use:
</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>df[<span class="st">'calcium'</span>]</span></code></pre>
</div>
<p>0 3.455582 1 3.669026 2 2.789910 3 2.939900 4 5.426060 5 0.715811 6
5.652390 7 3.571320 8 4.300067 9 1.369419 10 2.550962 11 2.894129 12
3.664987 13 1.362779 14 3.718798 15 1.865868 16 3.272809 17 3.917591
Name: calcium, dtype: float64</p>
<p>To access individual rows of a column we use two pairs of square
brackets:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>df[<span class="st">'calcium'</span>][<span class="dv">0</span>:<span class="dv">3</span>]</span></code></pre>
</div>
<p>0 3.455582 1 3.669026 2 2.789910 Name: calcium, dtype: float64</p>
<p style="text-align: justify;">
Here all rules for <a href="https://docs.python.org/3/tutorial/introduction.html" class="external-link">slicing</a>
can be applied. As for lists and tuples, the indexing of rows is
semi-inclusive, with the lower boundary included and upper boundary
excluded. Note that the first pair of square brackets refers to columns,
and the second pair refers to the rows. However, this is different from
accessing items in a nested list, for instance.
</p>
<p>Accessing items in a Pandas DataFrame is analogous to accessing the
values in a Python dictionary by referring to its keys.</p>
<p>To access non-contiguous elements, we use an additional pair of
square brackets (as if for a list within a list):</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>df[<span class="st">'calcium'</span>][[<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">7</span>]]</span></code></pre>
</div>
<p>1 3.669026 3 2.939900 7 3.571320 Name: calcium, dtype: float64</p>
<p style="text-align: justify;">
</p>
<p>Another method for indexing and slicing a DataFrame is to use the
‘index location’ or <code>iloc</code> property. Note that properties in
Python differ from methods. Syntactically, they use the same dot
notation we are accustomed to with methods, but they differ in their use
of square brackets, rather than the round parentheses that methods
operate with. A property also refers directly to a specific
<strong>attribute</strong> of an object.</p>
In this example <code>iloc</code> refers first to the rows of data, and
then to columns - by index; all contained within a single pair of
brackets. For example, to obtain all the rows of the first column (index
<code>0</code>), you use:

<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>df.iloc[:, <span class="dv">0</span>]</span></code></pre>
</div>
<p>0 3.455582 1 3.669026 2 2.789910 3 2.939900 4 5.426060 5 0.715811 6
5.652390 7 3.571320 8 4.300067 9 1.369419 10 2.550962 11 2.894129 12
3.664987 13 1.362779 14 3.718798 15 1.865868 16 3.272809 17 3.917591
Name: calcium, dtype: float64</p>
<p>To display only the first three calcium concentrations, slicing is
used: note that the upper boundary is excluded):</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>df.iloc[<span class="dv">0</span>:<span class="dv">3</span>, <span class="dv">0</span>]</span></code></pre>
</div>
<p>0 3.455582 1 3.669026 2 2.789910 Name: calcium, dtype: float64</p>
<p>To access non-consecutive values, we can use a pair of square
brackets within the outer pair of square brackets:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>df.iloc[[<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">7</span>], <span class="dv">0</span>]</span></code></pre>
</div>
<p>2 2.78991 4 5.42606 7 3.57132 Name: calcium, dtype: float64</p>
<p>Similarly, we can access values from multiple columns:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>df.iloc[[<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">7</span>], :]</span></code></pre>
</div>
<p>calcium sodium 2 2.78991 105.821810 4 5.42606 97.931489 7 3.57132
112.647360</p>
<p>To pick only the even rows from the two columns, note the following
colon notation:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>df.iloc[:<span class="dv">18</span>:<span class="dv">2</span>, :]</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a> <span class="ex">calcium</span>      sodium</span></code></pre>
</div>
<p>0 3.455582 112.690980 2 2.789910 105.821810 4 5.426060 97.931489 6
5.652390 112.871500 8 4.300067 132.031720 10 2.550962 117.373730 12
3.664987 105.346410 14 3.718798 125.021060 16 3.272809 117.588040</p>
<p>The number after the second colon indicates the
<em>stepsize</em>.</p>
<div id="practice-exercise-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="practice-exercise-2" class="callout-inner">
<h3 class="callout-title">Practice Exercise 2</h3>
<div class="callout-content">
<p><strong>Select data from DataFrame</strong></p>
<p>Display the calcium and sodium concentrations of all patients -
except the first. Check the model solution at the bottom for
options.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>df[[<span class="st">'calcium'</span>, <span class="st">'sodium'</span>]][<span class="dv">1</span>:]</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a> <span class="ex">calcium</span>      sodium</span></code></pre>
</div>
<p>1 3.669026 125.663330 2 2.789910 105.821810 3 2.939900 98.172772 4
5.426060 97.931489 5 0.715811 120.858330 6 5.652390 112.871500 7
3.571320 112.647360 8 4.300067 132.031720 9 1.369419 118.499010 10
2.550962 117.373730 11 2.894129 134.052390 12 3.664987 105.346410 13
1.362779 123.359490 14 3.718798 125.021060 15 1.865868 112.075420 16
3.272809 117.588040 17 3.917591 101.009870</p>
</div>
</div>
</div>
</div>
<p>Mixing the different methods of accessing specific data in a
DataFrame can be confusing, and requires practice and diligence.</p>
<div class="section level3">
<h3 id="search-for-missing-values">
<strong>Search for missing values</strong><a class="anchor" aria-label="anchor" href="#search-for-missing-values"></a>
</h3>
<p>Some tables contain missing entries. You can check a DataFrame for
such missing entries. If no missing entry is found, the function
<code>isnull</code> will return <code>False</code>.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>df.isnull().<span class="bu">any</span>()</span></code></pre>
</div>
<p>calcium False sodium False dtype: bool</p>
<p>This shows that there are no missing entries in our DataFrame.</p>
<div id="practice-exercise-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="practice-exercise-3" class="callout-inner">
<h3 class="callout-title">Practice Exercise 3</h3>
<div class="callout-content">
<p><strong>Find NaN in DataFrame</strong></p>
<p>In the Loan dataset, check the entry ‘Self-employed’ for ID LP001059.
It shows how a missing value is represented as ‘NaN’ (not a number).</p>
<p>Verify that the output of <code>isnull</code> in this case is
<code>True</code></p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>df_loan[<span class="st">'Self_Employed'</span>][<span class="dv">8</span>]</span></code></pre>
</div>
<p>nan</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>df_loan[<span class="st">'Self_Employed'</span>][<span class="dv">8</span>:<span class="dv">9</span>].isnull()</span></code></pre>
</div>
<p>8 True Name: Self_Employed, dtype: bool</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="basic-data-features">Basic data features:<a class="anchor" aria-label="anchor" href="#basic-data-features"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="summary-statistics">
<strong>Summary Statistics</strong><a class="anchor" aria-label="anchor" href="#summary-statistics"></a>
</h3>
<p>To get a summary of basic data features, it is possible to use the
function <code>describe</code>:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>description <span class="op">=</span> df.describe()</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>description</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>     <span class="ex">calcium</span>      sodium</span></code></pre>
</div>
<p>count 18.000000 18.000000 mean 3.174301 115.167484 std 1.306652
10.756852 min 0.715811 97.931489 25% 2.610699 107.385212 50% 3.364195
115.122615 75% 3.706355 122.734200 max 5.652390 134.052390</p>
<p style="text-align: justify;">
The <code>describe</code> function produces a new DataFrame (here called
‘description’) that contains the number of samples, the mean, the
standard deviation, 25th, 50th, 75th percentile, and the minimum and
maximum values for each column of the data. Note that the indices of the
rows have now been replaced by strings. To access rows, it is possible
to refer to those names using the <code>loc</code> property. Thus, in
order to access the mean of the calcium concentrations from the
description, each of the following is valid:
</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co"># Option 1</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>description.loc[<span class="st">'mean'</span>][<span class="st">'calcium'</span>]</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a><span class="co"># Option 2</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>description.loc[<span class="st">'mean'</span>][<span class="dv">0</span>]</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a><span class="co"># Option 3</span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>description[<span class="st">'calcium'</span>][<span class="st">'mean'</span>]</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a><span class="co"># Option 4</span></span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>description[<span class="st">'calcium'</span>][<span class="dv">1</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">3.1743005405555555</span></span>
<span><span class="fl">3.1743005405555555</span></span>
<span><span class="fl">3.1743005405555555</span></span>
<span><span class="fl">3.1743005405555555</span></span></code></pre>
</div>
<div id="practice-exercise-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="practice-exercise-4" class="callout-inner">
<h3 class="callout-title">Practice Exercise 4</h3>
<div class="callout-content">
<p style="text-align: justify;">
Use your own .csv dataset to practice. (If you don’t have a dataset at
hand, any excel table can be exported as .csv.) Firstly, read it into a
DataFrame, and proceed by checking its header, accessing individual
values or sets of values etc. Create a statistical summary using
<code>describe</code>, and check for missing values using
<code>.isnull</code>.
</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>[ad libitum]</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="iterating-through-the-columns">
<strong>Iterating through the columns</strong><a class="anchor" aria-label="anchor" href="#iterating-through-the-columns"></a>
</h3>
<p>Now we know how to access all data in a DataFrame and how to get a
statistical summary statistics over each column.</p>
<p>Here is code to iterate through the columns and access the first two
concentrations:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> df:</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>    <span class="bu">print</span>(df[col][<span class="dv">0</span>:<span class="dv">2</span>])</span></code></pre>
</div>
<p>0 3.455582 1 3.669026 Name: calcium, dtype: float64 0 112.69098 1
125.66333 Name: sodium, dtype: float64</p>
<p>As a slightly more complex example, we access the median (‘50%’) of
each column in the description, and add it to a list:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>conc_medians <span class="op">=</span> <span class="bu">list</span>()</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> df:</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>    conc_medians.append(df[col].describe()[<span class="st">'50%'</span>])</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The columns are: '</span>, <span class="bu">list</span>(df.columns))</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The medians are: '</span>, conc_medians)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The columns are:  ['calcium', 'sodium']
The medians are:  [3.3641954, 115.122615]</code></pre>
</div>
<p style="text-align: justify;">
This approach is useful for DataFrames with a larger number of columns.
For instance, it is possible to follow this by creating a boxplot or
histogram for the means, medians etc. of the DataFrame, thus giving a
comprehensive overview of all (comparable) columns.
</p>
</div>
<div class="section level3">
<h3 id="selecting-a-subset-based-on-a-template">
<strong>Selecting a subset based on a template</strong><a class="anchor" aria-label="anchor" href="#selecting-a-subset-based-on-a-template"></a>
</h3>
<p style="text-align: justify;">
Often, an analysis of a dataset may required on only part of the data.
This can often be formulated by using a logical condition which
specifies the required subset.
</p>
<p style="text-align: justify;">
For this we will assume that some of the data are labelled ‘0’ and some
are labelled ‘1’. Let us therefore see how to add a new column to our
Evereleys DataFrame, which contains the labels (which are, in this
example, arbitrary).
</p>
<p style="text-align: justify;">
Firstly, we can randomly create as many labels as we have rows in the
DataFrame. We can use the <kbd>randint</kbd> function, which can be
imported from the <kbd>numpy.random</kbd> module of the NumPy library.
In its simplest form, the <kbd>randint</kbd> function accepts two
arguments. Firstly, the upper bound of the integer needed, which
defaults to zero. As Python is exclusive of the upper bound, providing
‘2’ will thus yield either ‘0’ or ‘1’ only.
</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="im">from</span> numpy.random <span class="im">import</span> randint</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>no_rows <span class="op">=</span> <span class="bu">len</span>(df)</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>randomLabel <span class="op">=</span> randint(<span class="dv">2</span>, size<span class="op">=</span>no_rows)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of rows:  '</span>, no_rows)</span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of Labels:'</span>, <span class="bu">len</span>(randomLabel))</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Labels:          '</span>, randomLabel)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Number of rows:   18
Number of Labels: 18
Labels:           [1 1 1 1 1 0 0 1 1 0 0 1 0 1 0 0 1 1]</code></pre>
</div>
<p>Note how we obtain the number of rows (18) using <kbd>len</kbd>
function and do not explicitly state it in the code.</p>
<p style="text-align: justify;">
Next, we must create a new data column in our <code>df</code> DataFrame
which contains the labels. In order to create a new column, you may
simply refer to a column name that does not yet exist, and subsequently
assign values to it. Let us call it ‘gender’, assuming that ‘0’
represents male and ‘1’ represents female.
</p>
<p>As gender specification can include more than two labels, try to
create a column with more than two randomly assigned labels e.g. (0, 1,
2).</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>df[<span class="st">'gender'</span>] <span class="op">=</span> randomLabel</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>df.head()</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="ex">calcium</span>      sodium  gender</span></code></pre>
</div>
<p>0 3.455582 112.690980 1 1 3.669026 125.663330 1 2 2.789910 105.821810
1 3 2.939900 98.172772 1 4 5.426060 97.931489 1</p>
<p style="text-align: justify;">
Now we can use the information contained in ‘gender’ to filter the data
by gender. To achieve this, we use a conditional statement. Let us check
which of the rows are labelled as ‘1’:
</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>df[<span class="st">'gender'</span>] <span class="op">==</span> <span class="dv">1</span></span></code></pre>
</div>
<p>0 True 1 True 2 True 3 True 4 True 5 False 6 False 7 True 8 True 9
False 10 False 11 True 12 False 13 True 14 False 15 False 16 True 17
True Name: gender, dtype: bool</p>
<p style="text-align: justify;">
If we assign the result of the conditional statement (a boolean: True or
False) to a variable, then this variable can act as a template to filter
the data. If we call the DataFrame with that variable, we will only get
the rows where the condition was found to be True:
</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>df_female <span class="op">=</span> df[<span class="st">'gender'</span>] <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>df[df_female]</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a> <span class="ex">calcium</span>      sodium  gender</span></code></pre>
</div>
<p>0 3.455582 112.690980 1 1 3.669026 125.663330 1 2 2.789910 105.821810
1 3 2.939900 98.172772 1 4 5.426060 97.931489 1 7 3.571320 112.647360 1
8 4.300067 132.031720 1 11 2.894129 134.052390 1 13 1.362779 123.359490
1 16 3.272809 117.588040 1 17 3.917591 101.009870 1</p>
<p>Using the boolean, we only pick the rows that are labelled ‘1’ and
thus get a subset of the data according to the label.</p>
<div id="practice-exercise-5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="practice-exercise-5" class="callout-inner">
<h3 class="callout-title">Practice Exercise 5</h3>
<div class="callout-content">
<p><strong>Using a template</strong></p>
<p>Modify the code to calculate the number of samples labelled 0 and
check the number of rows of that subset.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="im">from</span> numpy.random <span class="im">import</span> randint</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>no_rows <span class="op">=</span> <span class="bu">len</span>(df)</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>randomLabel <span class="op">=</span> randint(<span class="dv">2</span>, size<span class="op">=</span>no_rows)</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>df[<span class="st">'gender'</span>] <span class="op">=</span> randomLabel</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>df_male <span class="op">=</span> df[<span class="st">'gender'</span>] <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>no_males <span class="op">=</span> <span class="bu">len</span>(df[df_male])</span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a><span class="bu">print</span>(no_males, <span class="st">'samples are labelled "male".'</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>12 samples are labelled "male".</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="visualisation-of-data">Visualisation of data<a class="anchor" aria-label="anchor" href="#visualisation-of-data"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
It is easy to see from the numbers that the concentrations of sodium are
much higher than those of calcium. However, to incorporate comparisons
of medians, percentiles and the spread of the data, it is better to use
visualisation.
</p>
<p style="text-align: justify;">
The simplest way to visualise data, is to use Pandas’ functionality
which offers direct methods of plotting your data. Here is an example
where a boxplot is created for each column:
</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>df <span class="op">=</span> read_csv(<span class="st">"data/everleys_data.csv"</span>)</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>df.boxplot()</span></code></pre>
</div>
<figure><img src="../fig/01-data_frames_1-rendered-unnamed-chunk-34-1.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
By default, boxplots are shown for all columns if no further argument is
given to the function (empty round parentheses). As the calcium plot is
quite condensed, we may wish to visualise it, separately. This can be
done by specifying the calcium column as an argument:
</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co"># Boxplot of calcium results</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>df.boxplot(column<span class="op">=</span><span class="st">'calcium'</span>)</span></code></pre>
</div>
<figure><img src="../fig/01-data_frames_1-rendered-unnamed-chunk-35-3.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="plots-using-matplotlib">Plots using Matplotlib<a class="anchor" aria-label="anchor" href="#plots-using-matplotlib"></a>
</h2>
<hr class="half-width">
<blockquote>
<p><a href="https://matplotlib.org" class="external-link"><strong>Matplotlib</strong></a> is a
comprehensive library for creating static, animated and interactive
visualizations in Python.</p>
</blockquote>
<p style="text-align: justify;">
The above is an easy way to create boxplots directly on the DataFrame.
It is based on the library Matplotlib and specifically uses the
<strong>pyplot library</strong>. For simplicity, this code is put into a
convenient Pandas function.
</p>
<p style="text-align: justify;">
However, we are going to use <strong>Matplotlib</strong> extensively
later on in the course, and we will therefore start by introducing a
more direct and generic way of using it.
</p>
<p>To do this, we import the function <kbd>subplots</kbd> from the <a href="https://matplotlib.org/stable/api/pyplot_summary.html" class="external-link">pyplot
library</a>:</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> subplots, show</span></code></pre>
</div>
<p style="text-align: justify;">
The way to use <kbd>subplots</kbd> is to first set up a figure
environment (below referred to in the code as an object titled ‘fig’)
and an empty coordinate system (below referred to as object ‘ax’). The
plot is then created using one of the many methods available in
Matplotlib. We will proceed by applying it to the coordinate system,
‘ax’.
</p>
<p style="text-align: justify;">
As an example, let us create a <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.boxplot.html#matplotlib.pyplot.boxplot%7C" class="external-link">boxplot</a>
of the calcium variable. As an argument of the function we need to
specify the data. We can use the values of the ‘calcium’ concentrations
from the column with the same name:
</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>ax.boxplot(df[<span class="st">'calcium'</span>])</span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>ax.set_title(<span class="st">'Boxplot of Everley Calcium'</span>)</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-data_frames_1-rendered-unnamed-chunk-37-5.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Note how we define the title of the plot by referring to the same
coordinate system <code>ax</code>.</p>
<p>The value of <kbd>subplots</kbd> becomes apparent when it is used to
generate more than one plot as part of a single figure: one of its many
useful features.</p>
<p style="text-align: justify;">
Here is an example whereby we create two boxplots adjacent to each
other. The keyword arguments to use is ‘ncols’ which is the number of
figures per row. ‘ncols=2’ indicates that you are plotting two plots
adjacent to each other.
</p>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(ncols<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>ax[<span class="dv">0</span>].boxplot(df[<span class="st">'calcium'</span>])</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Calcium'</span>)</span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>ax[<span class="dv">1</span>].boxplot(df[<span class="st">'sodium'</span>])</span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Sodium'</span>)<span class="op">;</span></span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-data_frames_1-rendered-unnamed-chunk-38-7.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Each of these subplots must now be referred to using indexing the
coordinate system ‘ax’. This figure gives a good overview of the
Everley’s data.</p>
<p>If you prefer to have the boxplots of both columns in a single
figure, this can also be done:</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(ncols<span class="op">=</span><span class="dv">1</span>, nrows<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>ax.boxplot([df[<span class="st">'calcium'</span>], df[<span class="st">'sodium'</span>]], positions<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>ax.set_title(<span class="st">'Boxplot of Calcium (left) and Sodium (right)'</span>)</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-data_frames_1-rendered-unnamed-chunk-39-9.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="practice-exercise-6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="practice-exercise-6" class="callout-inner">
<h3 class="callout-title">Practice Exercise 6</h3>
<div class="callout-content">
<p><strong>Boxplot from Loan data</strong></p>
<p>Plot the boxplots of the ‘ApplicantIncome’ and the
‘CoapplicantIncome’ in the Loan data using the above code.</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(ncols<span class="op">=</span><span class="dv">1</span>, nrows<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>ax.boxplot([df_loan[<span class="st">'ApplicantIncome'</span>], df_loan[<span class="st">'CoapplicantIncome'</span>]], positions<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>ax.set_title(<span class="st">'Applicant Income (left) &amp; Co-Applicant Income (right)'</span>)<span class="op">;</span></span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-data_frames_1-rendered-unnamed-chunk-40-11.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="histogram">
<strong>Histogram</strong><a class="anchor" aria-label="anchor" href="#histogram"></a>
</h3>
<p style="text-align: justify;">
Another good visual overview for data is the histogram. Containers or
‘bins’ are created over the range of values found within a column, and
the count of the values for each bin is plotted on the vertical
(y-)axis.
</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(ncols<span class="op">=</span><span class="dv">2</span>, nrows<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>ax[<span class="dv">0</span>].hist(df[<span class="st">'calcium'</span>])</span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>ax[<span class="dv">0</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Calcium'</span>, ylabel<span class="op">=</span><span class="st">'Count'</span>)<span class="op">;</span></span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>ax[<span class="dv">1</span>].hist(df[<span class="st">'sodium'</span>])</span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>ax[<span class="dv">1</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Sodium'</span>, ylabel<span class="op">=</span><span class="st">'Count'</span>)<span class="op">;</span></span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>fig.suptitle(<span class="st">'Histograms of Everley concentrations'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)<span class="op">;</span></span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-data_frames_1-rendered-unnamed-chunk-41-13.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This example code also demonstrates how to use methods from within
subplots to add labels to the axes, together with a title for the
overall figure.</p>
<p>Unless specified, a default value is used for the generation of the
bins. It is set to 10 bins over the range of which values are found. The
number of bins in the histogram can be changed using the keyword
argument ‘bins’:</p>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(ncols<span class="op">=</span><span class="dv">2</span>, nrows<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>ax[<span class="dv">0</span>].hist(df[<span class="st">'calcium'</span>], bins<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>ax[<span class="dv">0</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Calcium, 5 bins'</span>, ylabel<span class="op">=</span><span class="st">'Count'</span>)<span class="op">;</span></span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>ax[<span class="dv">1</span>].hist(df[<span class="st">'calcium'</span>], bins<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>ax[<span class="dv">1</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Calcium, 15 bins'</span>, ylabel<span class="op">=</span><span class="st">'Count'</span>)<span class="op">;</span></span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a>fig.suptitle(<span class="st">'Histograms with Different Binnings'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-data_frames_1-rendered-unnamed-chunk-42-15.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Note how the y-axis label of the right figure is slightly misplaced,
and overlapping the border of the left figure. In order to correct for
the placement of the labels and the title, you can use
<code>tight_layout</code> automatically adjust for this:</p>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(ncols<span class="op">=</span><span class="dv">2</span>, nrows<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>ax[<span class="dv">0</span>].hist(df[<span class="st">'calcium'</span>], bins<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>ax[<span class="dv">0</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Calcium, 5 bins'</span>, ylabel<span class="op">=</span><span class="st">'Count'</span>)<span class="op">;</span></span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>ax[<span class="dv">1</span>].hist(df[<span class="st">'calcium'</span>], bins<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>ax[<span class="dv">1</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Calcium, 15 bins'</span>, ylabel<span class="op">=</span><span class="st">'Count'</span>)<span class="op">;</span></span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>fig.suptitle(<span class="st">'Histograms with Different Binnings'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-data_frames_1-rendered-unnamed-chunk-43-17.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="practice-exercise-7" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="practice-exercise-7" class="callout-inner">
<h3 class="callout-title">Practice Exercise 7:</h3>
<div class="callout-content">
<p><strong>Create the histogram of a column</strong></p>
<p>Take the loan data and display the histogram of the loan amount that
people asked for. (Loan amounts are divided by 1000, i.e. in k£ on the
horizontal axis). Use 20 bins, as an example.</p>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7"> Show me the solution </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" data-bs-parent="#accordionSolution7" aria-labelledby="headingSolution7">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="co"># Histogram of loan amounts in k£</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>ax.hist(df_loan[<span class="st">'LoanAmount'</span>], bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Loan amount'</span>, ylabel<span class="op">=</span><span class="st">'Count'</span>)<span class="op">;</span></span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>ax.set_title(<span class="st">'Histograms of Loan Amounts'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-data_frames_1-rendered-unnamed-chunk-44-19.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="handling-the-diabetes-dataset">Handling the Diabetes Dataset<a class="anchor" aria-label="anchor" href="#handling-the-diabetes-dataset"></a>
</h2>
<hr class="half-width">
<p>Let us return to the dataset that commenced our exploration of the
handling of data within a DataFrame.</p>
<p>Next, we will:</p>
<ul>
<li>Import the diabetes data from ‘sklearn’</li>
<li>Check the shape of the DataFrame and search for NANs</li>
<li>Get a summary plot of one of its statistical quantities (i.e. mean)
for all columns</li>
</ul>
<p>Firstly, let’s import the dataset and check its <code>head</code>. In
some cases, this may take a moment: please be patient, and wait for the
numbers to appear as output below your code cell (if you’re using an
IDE).</p>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> datasets</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>diabetes <span class="op">=</span> datasets.load_diabetes()</span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a>X <span class="op">=</span> diabetes.data</span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a><span class="im">from</span> pandas <span class="im">import</span> DataFrame</span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" tabindex="-1"></a>df_diabetes <span class="op">=</span> DataFrame(data<span class="op">=</span>X)</span>
<span id="cb57-10"><a href="#cb57-10" tabindex="-1"></a></span>
<span id="cb57-11"><a href="#cb57-11" tabindex="-1"></a>df_diabetes.head()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          0         1         2  ...         7         8         9
0  0.038076  0.050680  0.061696  ... -0.002592  0.019907 -0.017646
1 -0.001882 -0.044642 -0.051474  ... -0.039493 -0.068332 -0.092204
2  0.085299  0.050680  0.044451  ... -0.002592  0.002861 -0.025930
3 -0.089063 -0.044642 -0.011595  ...  0.034309  0.022688 -0.009362
4  0.005383 -0.044642 -0.036385  ... -0.002592 -0.031988 -0.046641

[5 rows x 10 columns]</code></pre>
</div>
<p>If you don’t see all the columns, use the cursor to scroll to the
right. Next, let’s check the number of columns and rows.</p>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a>no_rows <span class="op">=</span> <span class="bu">len</span>(df_diabetes)</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>no_cols <span class="op">=</span> <span class="bu">len</span>(df_diabetes.columns)</span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Rows:'</span>, no_rows, <span class="st">'Columns:'</span>, no_cols)</span></code></pre>
</div>
<p>Rows: 442 Columns: 10</p>
<p>There are 442 rows organised in 10 columns.</p>
<p>In order o obtain an overview, let us extract the mean of each column
using the <kbd>describe</kbd> and plot all means as a bar chart. The
Matplotlib function to plot a bar chart is called <kbd>bar</kbd>:</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>conc_means <span class="op">=</span> <span class="bu">list</span>()</span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> df_diabetes:</span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a>    conc_means.append(df_diabetes[col].describe()[<span class="st">'mean'</span>])</span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The columns are: '</span>, <span class="bu">list</span>(df_diabetes.columns))</span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The medians are: '</span>, conc_means, <span class="dv">2</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The columns are:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
The medians are:  [-2.511816797794472e-19, 1.2307902309192911e-17, -2.2455642172282577e-16, -4.7975700837874414e-17, -1.3814992387869595e-17, 3.918434204559376e-17, -5.7771786349272854e-18, -9.042540472060099e-18, 9.293722151839546e-17, 1.1303175590075123e-17] 2</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>bins <span class="op">=</span> <span class="bu">range</span>(<span class="dv">10</span>)</span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>ax.bar(bins, conc_means)<span class="op">;</span></span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-data_frames_1-rendered-unnamed-chunk-48-21.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
Note how the bars in this plot go up and down. The vertical axis,
however, has values ranging from -10<sup>(-16)</sup> to
+10<sup>(-16)</sup>. This means that, for all practical purposes, all
means are zero which is not a coincidence. The original values have been
normalised to mean zero for the purpose of applying a machine learning
algorithm to them.
</p>
<p>In this example, we can clearly observe the importance of checking
the data before working with them.</p>
</section><section><h2 class="section-heading" id="exercises">Exercises<a class="anchor" aria-label="anchor" href="#exercises"></a>
</h2>
<hr class="half-width">
<div id="end-of-chapter-exercises" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="end-of-chapter-exercises" class="callout-inner">
<h3 class="callout-title">End of chapter Exercises</h3>
<div class="callout-content">
<p>Download the cervical cancer dataset provided, import it using
<code>read_csv</code>.</p>
<ol style="list-style-type: decimal">
<li><p>How many rows and columns are there?</p></li>
<li><p>How many columns contain floating point numbers (type
float64)?</p></li>
<li><p>How many of the subjects are smokers?</p></li>
<li><p>Calculate the percentage of smokers</p></li>
<li><p>Plot the age distribution (with, for instance, 50 bins)</p></li>
<li><p>Get the mean and standard distribution of age of first sexual
intercourse</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8"> Solutions are provided after assignments are marked. </h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" data-bs-parent="#accordionSolution8" aria-labelledby="headingSolution8">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>
<kbd>Pandas</kbd> package contains useful functions to work with
DataFrames.</li>
<li>The <kbd>iloc</kbd> property is used to index and slice a
DataFrame.</li>
<li>
<kbd>describe</kbd> function is used to obtain a statistical summary
of basic data features.</li>
<li>The simplest method for data visualisation, is to use Pandas’
in-built functionality.</li>
<li>
<code>Matplotlib</code> is a comprehensive library for creating
static, animated, and interactive visualizations, in Python.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-02-data_frames_2"><p>Content from <a href="02-data_frames_2.html">DataFrames - Part 2</a></p>
<hr>
<p>Last updated on 2025-01-05 |

        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/02-data_frames_2.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 120 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p><a href="https://drive.usercontent.google.com/u/1/uc?id=1rs3CrdFd_Ilcb5dmL3KL8N6V3n99fOhZ&amp;export=download" class="external-link"><strong>Download
chapter PDF (.pdf).</strong></a></p>
<p><a href="https://drive.usercontent.google.com/u/1/uc?id=1vBj8V2sZwU7W3fah8ui6ijyJHwRANBtF&amp;export=download" class="external-link"><strong>Download
chapter notebook (.ipynb).</strong></a></p>
<p><a href="https://docs.google.com/forms/d/e/1FAIpQLSdr0capF7jloJhPH3Pki1B3LZoKOG16poOpuVJ7SL2LkwLHQA/viewform?pli=1" class="external-link"><span style="color: rgb(255, 0, 0);"><strong>Mandatory Lesson Feedback
Survey</strong></span></a></p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is bivariate or multivariate analysis?</li>
<li>How are bivariate properties of data interpreted?</li>
<li>How can a bivariate quantity be explained?</li>
<li>When to use a correlation matrix?</li>
<li>What are ways to study relationships in data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Practise working with Pandas DataFrames and NumPy arrays.</li>
<li>Bivariate analysis of Pandas DataFrame / NumPy array.</li>
<li>The Pearson correlation coefficient (<span class="math inline">\(PCC\)</span>).</li>
<li>Correlation Matrix as an example of bivariate summary
statistics.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<br><p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/NjvFh7i74pI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</p>
<p><br></p>
<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/Z8eX4ncHjyQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</p>
<p><br></p>
<div id="prerequisites" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="prerequisites" class="callout-inner">
<h3 class="callout-title">Prerequisites</h3>
<div class="callout-content">
<ul>
<li>Python Arrays</li>
<li>Basic statistics, in particular, the <a href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient" class="external-link">correlation
coefficient</a>
</li>
<li>Pandas DataFrames: import and handling</li>
</ul>
</div>
</div>
</div>
<div id="remember" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="remember" class="callout-inner">
<h3 class="callout-title">Remember</h3>
<div class="callout-content">
<p>Any dataset associated with this lesson is present in
<code>Data</code> folder of your assignment repository, and can also be
downloaded using the link given above in <a href="index.html#setup">Summary
and Setup</a> for this Lesson.</p>
</div>
</div>
</div>
<p>The following cell contains functions that need to be imported,
please execute it before continuing with the Introduction.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># To import data from a csv file into a Pandas DataFrame</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">from</span> pandas <span class="im">import</span> read_csv</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># To import a dataset from scikit-learn</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> datasets</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co"># To create figure environments and plots</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> subplots, show</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co"># Specific numpy functions, description in the main body</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> corrcoef, fill_diagonal, triu_indices, arange</span></code></pre>
</div>
<div id="note" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note" class="callout-inner">
<h3 class="callout-title">Note</h3>
<div class="callout-content">
<p>In many online tutorials you can find the following convention when
importing functions:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre>
</div>
<p>(or similar). In this case, the whole library is imported and any
function in that library is then available using
e.g. <code>pd.read_csv(my_file)</code></p>
<p>We don’t recommend this as the import of the whole library uses a lot
of working memory (e.g. on the order of 100 MB for NumPy).</p>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
In the previous lesson, we obtained some basic data quantifications
using the <kbd>describe</kbd> function. Each of these quantities was
calculated for individual columns, where each column contained a
different measured variable. However, in data analysis in general (and
in machine learning in particular), one of the main points of analysis
is to try and exploit the presence of information that lies in
relationships <em>between</em> variables (i.e. columns in our data).
</p>
<p style="text-align: justify;">
Quantities that are based on data from two variables are referred to as
<strong>bivariate</strong> measures. Analyses that make use of bivariate
(and potentially higher order) quantities are referred to as bivariate
or more broadly, <strong>multivariate data analyses</strong>.
</p>
<p>When we combine uni- and multivariate analyses, we can often obtain a
thorough, comprehensive overview of the basic properties of a
dataset.</p>
<div id="example-the-diabetes-dataset" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="example-the-diabetes-dataset" class="callout-inner">
<h3 class="callout-title"><strong>Example: The diabetes
dataset</strong></h3>
<div class="callout-content">
<p style="text-align: justify;">
Using the diabetes dataset (introduced in the Data Handling 1 lesson),
we can begin by looking at the data from three of its columns: The upper
row of the below figure shows three histograms. A histogram is a
summarising plot of the recordings of a single variable. The histograms
of columns with indices 3, 4, and 5 have similar means and variances,
which can be explained by prior normalisation of the data. The shapes
differ, but this does not tell us anything about a relationship between
the measurements.
</p>
<p style="text-align: justify;">
Before the application of any machine learning methods, its is important
to understand whether there is evidence of any relationships between the
individual variables in a DataFrame. One potential relationships is that
the variables are ‘similar’. One way to check for the similarity between
variables in a dataset, is to create a <a href="https://en.wikipedia.org/wiki/Scatter_plot" class="external-link">scatter plot</a>. The
bottom row of the figure below contains the three scatter plots between
variables used to create the histograms in the top row.
</p>
<p>(Please execute the code in order to generate the figures. We will
describe the scatter plot and its features, later.)</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Figure Code</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>diabetes <span class="op">=</span> datasets.load_diabetes()</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>diabetes_data <span class="op">=</span> diabetes.data</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">21</span>, <span class="dv">10</span>), ncols<span class="op">=</span><span class="dv">3</span>, nrows<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co"># Histograms</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">0</span>].hist(diabetes_data[:,<span class="dv">3</span>], bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">0</span>].set_ylabel(<span class="st">'Count'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].hist(diabetes_data[:,<span class="dv">4</span>], bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].set_ylabel(<span class="st">'Count'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">2</span>].hist(diabetes_data[:,<span class="dv">5</span>], bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">2</span>].set_ylabel(<span class="st">'Count'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co"># Scatter plots</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].scatter(diabetes_data[:,<span class="dv">3</span>], diabetes_data[:,<span class="dv">4</span>])<span class="op">;</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].set_xlabel(<span class="st">'Column 3'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].set_ylabel(<span class="st">'Column 4'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].scatter(diabetes_data[:,<span class="dv">4</span>], diabetes_data[:,<span class="dv">5</span>])<span class="op">;</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].set_xlabel(<span class="st">'Column 4'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].set_ylabel(<span class="st">'Column 5'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">2</span>].scatter(diabetes_data[:,<span class="dv">5</span>], diabetes_data[:,<span class="dv">3</span>])<span class="op">;</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">2</span>].set_xlabel(<span class="st">'Column 5'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">2</span>].set_ylabel(<span class="st">'Column 3'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-3-1.png" width="2016" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
When plotting the data against each other in pairs (as displayed in the
bottom row of the figure), data column 3 plotted against column 4 (left)
and column 5 against 3 (right) both show a fairly uniform circular
distribution of points. This is what would be expected if the data in
the two columns were independent of each other.
</p>
<p style="text-align: justify;">
In contrast, column 4 against 5 (centre, bottom) shows an elliptical,
pointed shape along the main diagonal. This shows that there is a clear
relationship between these data. Specifically, it indicates that the two
variables recorded in these columns (indices 4 and 5) are <em>not</em>
independent of each other. They exhibit more similarity than would be
expected of independent variables.
</p>
<p style="text-align: justify;">
In this lesson, we aim to obtain an overview of the similarities in a
dataset. We will firstly introduce <strong>bivariate</strong>
visualisation using Matplotlib. We will then go on to demonstrate the
use of NumPy functions in calculating correlation coefficients and
obtaining a correlation matrix, as a means of introducing
<strong>multivariate</strong> analysis. Combined with the basic
statistics covered in the previous lesson, we can obtain a good overview
of a high-dimensional dataset, prior to the application of machine
learning algorithms.
</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="work-through-properties-of-a-dataset">Work-Through: Properties of a Dataset<a class="anchor" aria-label="anchor" href="#work-through-properties-of-a-dataset"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="univariate-properties">
<strong>Univariate properties</strong><a class="anchor" aria-label="anchor" href="#univariate-properties"></a>
</h3>
<p style="text-align: justify;">
For recordings of variables that are contained, for example, in the
columns of a DataFrame, we often assume the independence of samples: the
measurement in one row does not depend on the recording present in
another row. Therefore results of the features obtained under the output
of the <kbd>describe</kbd> function, for instance, will not depend on
the order of the rows. Also, while the numbers obtained from different
rows can be similar (or even the same) by chance, there is no way to
<em>predict</em> the values in one row based on the values of another.
</p>
<p style="text-align: justify;">
Contrastingly, when comparing different variables arranged in columns,
this is not necessarily the case. Let us firstly assume that they are
consistent: that all values in a single row are obtained from the same
subject. The values in one column can be related to the numbers in
another column and, specifically, they can show degrees of similarity.
If, for instance, we have a number of subjects investigated (some of
whom have an inflammatory disease and some of whom are healthy controls)
an inflammatory marker might be expected to be elevated in the diseased
subjects. If several markers are recorded from each subject (i.e. more
than one column in the data frame), the values of several inflammatory
markers may be elevated simultaneously in the diseased subjects. Thus,
the profiles of these markers across the whole group will show a certain
similarity.
</p>
<p style="text-align: justify;">
The goal of multivariate data analysis is to find out whether or not any
relationships exist between recorded variables.
</p>
Let us first import a demonstration dataset and check its basic
statistics.
<p style="text-align: justify;">
For a work-through example, we can start with the ‘patients’ dataset.
Let’s firstly import the data from the .csv file using the function
<kbd>read_csv</kbd> from Pandas and load this into a DataFrame. We can
then assess the number of columns and rows using the <kbd>len</kbd>
function. We can also determine the data type of each column, which will
reveal which columns can be analysed, quantitatively.
</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Please adjust path according to operating system &amp; personal path to file</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>df <span class="op">=</span> read_csv(<span class="st">'data/patients.csv'</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>df.head()</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of columns: '</span>, <span class="bu">len</span>(df.columns))</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of rows: '</span>, <span class="bu">len</span>(df))</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>df.head()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   Age  Height  Weight  Systolic  Diastolic  Smoker  Gender
0   38      71   176.0     124.0       93.0       1    Male
1   43      69   163.0     109.0       77.0       0    Male
2   38      64   131.0     125.0       83.0       0  Female
3   40      67   133.0     117.0       75.0       0  Female
4   49      64   119.0     122.0       80.0       0  Female
Number of columns:  7
Number of rows:  100
   Age  Height  Weight  Systolic  Diastolic  Smoker  Gender
0   38      71   176.0     124.0       93.0       1    Male
1   43      69   163.0     109.0       77.0       0    Male
2   38      64   131.0     125.0       83.0       0  Female
3   40      67   133.0     117.0       75.0       0  Female
4   49      64   119.0     122.0       80.0       0  Female</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The columns are of the following data types:'</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>df.dtypes</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The columns are of the following data types:
Age            int64
Height         int64
Weight       float64
Systolic     float64
Diastolic    float64
Smoker         int64
Gender        object
dtype: object</code></pre>
</div>
<p style="text-align: justify;">
Out of the seven columns, three contain integers, three contain
floating-point (decimal) numbers, and the last one contains gender
specification as ‘female’ or ‘male’ - held as string data. The sixth
column in this dataset contains a binary classification, with a value of
‘0’ indicating a non-smoker individual and ‘1’ indicating a smoker.
Numerical analysis can thus be restricted to columns with indices 0 to
4.
</p>
<div id="practice-exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="practice-exercise-1" class="callout-inner">
<h3 class="callout-title">Practice Exercise 1</h3>
<div class="callout-content">
<p><strong>Univariate properties of the patients dataset</strong></p>
<ol style="list-style-type: decimal">
<li><p>Obtain the basic statistical properties of the first five columns
using the <code>describe</code> function.</p></li>
<li><p>Plot a bar chart of the means of each column. To access a row by
its name, you can use the convention
<code>df_describe.loc['name']</code>.</p></li>
<li><p><strong>Optional:</strong> In the bar chart of the means, try to
add the standard deviation as an errorbar, using the keyword argument
<code>yerr</code> in the form
<code>yerr = df_describe.loc['std']</code>.</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Q1 </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>df <span class="op">=</span> read_csv(<span class="st">'data/patients.csv'</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>df_describe <span class="op">=</span> df.iloc[:, :<span class="dv">5</span>].describe()</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>df_describe.<span class="bu">round</span>(<span class="dv">2</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          Age  Height  Weight  Systolic  Diastolic
count  100.00  100.00  100.00    100.00     100.00
mean    38.28   67.07  154.00    122.78      82.96
std      7.22    2.84   26.57      6.71       6.93
min     25.00   60.00  111.00    109.00      68.00
25%     32.00   65.00  130.75    117.75      77.75
50%     39.00   67.00  142.50    122.00      81.50
75%     44.00   69.25  180.25    127.25      89.00
max     50.00   72.00  202.00    138.00      99.00</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Q2 </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>bins <span class="op">=</span> arange(<span class="dv">5</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>ax.bar(bins, df_describe.loc[<span class="st">'min'</span>])</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-7-3.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Q3 </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>bins <span class="op">=</span> arange(<span class="dv">5</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>ax.bar(bins, df_describe.loc[<span class="st">'min'</span>], yerr<span class="op">=</span>df_describe.loc[<span class="st">'std'</span>])</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>ax.set_xticks(bins)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>ax.set_xticklabels(df.columns[:<span class="dv">5</span>], fontsize<span class="op">=</span><span class="dv">12</span>)<span class="op">;</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-8-5.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="visual-search-for-similarity-the-scatter-plot">
<strong>Visual Search for Similarity: the Scatter Plot</strong><a class="anchor" aria-label="anchor" href="#visual-search-for-similarity-the-scatter-plot"></a>
</h3>
<p style="text-align: justify;">
In Matplotlib, the function <code>scatter</code> allows a user to plot
one variable against another. This is a common way to visually eyeball
your data for relationships between individual columns in a DataFrame.
</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()<span class="op">;</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>ax.scatter(df[<span class="st">'Weight'</span>], df[<span class="st">'Height'</span>])<span class="op">;</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Weight (pounds)'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Height (inches)'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-9-7.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
The data points appear to be grouped into two clouds. We will not deal
with this qualitative aspect further, at this point. Grouping will be
discussed in more detail in L2D’s later lessons on Unsupervised Machine
Learning and Clustering.
</p>
<p style="text-align: justify;">
However, from the information shown on the plot, it is reasonable to
suspect a trend where heavier people are also taller. For instance, we
note that there are no points in the lower right corner of the plot
(weight &gt;160 pounds and height &lt; 65 inches).
</p>
<div id="practice-exercise-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="practice-exercise-2" class="callout-inner">
<h3 class="callout-title">## Practice Exercise 2</h3>
<div class="callout-content">
<p><strong>DIY2: Scatter plot from the patients data</strong></p>
<p style="text-align: justify;">
Plot systolic against diastolic blood pressure. Do the two variables
appear to be independent, or related?
</p>
<p style="text-align: justify;">
Scatter plots are useful for the inspection of select pairs of data.
However, they are only qualitative and thus, it is generally preferred
to have a numerical quantity.
</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()<span class="op">;</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>ax.scatter(df[<span class="st">'Systolic'</span>], df[<span class="st">'Diastolic'</span>])<span class="op">;</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Systolic'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Diastolic'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-10-9.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
From the plot one might suspect that a larger systolic value is
connected with a larger diastolic value. However, the plot in itself is
not conclusive in that respect.
</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="the-correlation-coefficient">The Correlation Coefficient<a class="anchor" aria-label="anchor" href="#the-correlation-coefficient"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
Bivariate measures are quantities that are calculated from two variables
of data. Bivariate features are the most widely used subset of
multivariate features - all of which require more than one variable in
order to be calculated.
</p>
<p style="text-align: justify;">
The concept behind many bivariate measures is to quantify “similarity”
between two datasets. If any similarity is observed, it is assumed that
there is a connection or relationship in the data. For variables
exhibiting similarity, knowledge of one understandably leads to an
expectation surrounding the other.
</p>
<p style="text-align: justify;">
Here we are going to look at a specific bivariate quantity: the <a href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient" class="external-link">Pearson
correlation coefficient</a> <span class="math inline">\(PCC\)</span>.
</p>
<p style="text-align: justify;">
The formula for the <span class="math inline">\(PCC\)</span> is set up
such that two identical datasets yield a <span class="math inline">\(PCC\)</span> of 1. Technically, this is achieved
by normalising all variances to be equal to 1. This also implies that
all data points in a scatter plot of one variable plotted against itself
are aligned along the main diagonal (with a positive slope).
</p>
<p style="text-align: justify;">
In two perfectly antisymmetrical datasets, where one variable can be
obtained by multiplying the other by -1, a value of -1 is obtained. This
implies that all data points in a scatter plot are aligned along the
negative, or anti diagonal, (with a negative slope). All other
possibilities lie in between. A value of 0 refers to precisely balanced
positive and negative contributions to the measure. However - strictly
speaking - the latter does not necessarily indicate that there is no
relationship between the variables.
</p>
<p style="text-align: justify;">
The <span class="math inline">\(PCC\)</span> is an
<strong>undirected</strong> measure. This means that its value for the
comparison between dataset 1 and dataset 2 is exactly the same as the
<span class="math inline">\(PCC\)</span> between dataset 2 and dataset
1.
</p>
<p style="text-align: justify;">
A method to directly calculate the <span class="math inline">\(PCC\)</span> of two datasets, is to use the
function <code>corr</code> and apply this to your DataFrame. For
instance, we can apply it to the Everleys dataset:
</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>df_everley <span class="op">=</span> read_csv(<span class="st">'data/everleys_data.csv'</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>df_everley.corr()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          calcium    sodium
calcium  1.000000 -0.258001
sodium  -0.258001  1.000000</code></pre>
</div>
<p style="text-align: justify;">
The result as a matrix of two-by-two numbers. Along the diagonal (top
left and bottom right) are the values for the comparison of a column to
itself. As any dataset is identical with itself, the values are one by
definition.
</p>
<p style="text-align: justify;">
The non-diagonal elements indicate that <span class="math inline">\(CC
\approx-0.26\)</span> for the two datasets. Both <span class="math inline">\(CC(12)\)</span> and <span class="math inline">\(CC(21)\)</span> are given in the matrix, however
because of the symmetry, we would only need to report one out of the
two.
</p>
<div id="note-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="note-1" class="callout-inner">
<h3 class="callout-title">Note</h3>
<div class="callout-content">
<p style="text-align: justify;">
In this lesson we introduce how to calculate the <span class="math inline">\(PCC\)</span> but do not discuss its significance.
For example, interpreting the value above requires consideration of the
fact that we only have only 18 data points. Specifically, we refrain
from concluding that because the <span class="math inline">\(PCC\)</span> is negative, a high value for the
calcium concentration is associated with a small value for sodium
concentration (relative to their respective means).
</p>
<p style="text-align: justify;">
One quantitative way to assess whether or not a given value of the <span class="math inline">\(PCC\)</span> is meaningful or not, is to use
surrogate data. In our example, we could create random numbers in an
array with shape (18, 2), for instance - such that the two means and
standard deviations are the same as in the Everley dataset, but the two
columns are independent of each other. Creating many realisations, we
can check what distribution of <span class="math inline">\(PCC\)</span>
values is expected from the randomly generated data, and compare this
against the values obtained from the Everleys dataset.
</p>
</div>
</div>
</div>
<p style="text-align: justify;">
Much of what we will cover in the Machine Learning component of L2D will
involve NumPy arrays. Let us, therefore, convert the Everleys dataset
from a Pandas DataFrame into a NumPy array.
</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>everley_numpy <span class="op">=</span> df_everley.to_numpy()</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>everley_numpy</span></code></pre>
</div>
<p>array([[ 3.4555817 , 112.69098 ], [ 3.6690263 , 125.66333 ], [
2.7899104 , 105.82181 ], [ 2.9399 , 98.172772 ], [ 5.42606 , 97.931489
], [ 0.71581063, 120.85833 ], [ 5.6523902 , 112.8715 ], [ 3.5713201 ,
112.64736 ], [ 4.3000669 , 132.03172 ], [ 1.3694191 , 118.49901 ], [
2.550962 , 117.37373 ], [ 2.8941294 , 134.05239 ], [ 3.6649873 ,
105.34641 ], [ 1.3627792 , 123.35949 ], [ 3.7187978 , 125.02106 ], [
1.8658681 , 112.07542 ], [ 3.2728091 , 117.58804 ], [ 3.9175915 ,
101.00987 ]])</p>
<p style="text-align: justify;">
We can see that the numbers remain the same, but the format has changed;
we have lost the names of the columns. Similar to a Pandas DataFrame, we
can also make use of the <kbd>shape</kbd> function to see the dimensions
of the data array.
</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>everley_numpy.shape</span></code></pre>
</div>
<p>(18, 2)</p>
<p>We can now use the NumPy function <kbd>corrcoef</kbd> to calculate
the Pearson correlation:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> corrcoef</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>corr_matrix <span class="op">=</span> corrcoef(everley_numpy, rowvar<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="bu">print</span>(corr_matrix)</span></code></pre>
</div>
<p>[[ 1. -0.25800058] [-0.25800058 1. ]]</p>
<p style="text-align: justify;">
The function <kbd>corrcoef</kbd> takes a two-dimensional array as its
input. The keyword argument <code>rowvar</code> is True by default,
which means that the correlation will be calculated along the rows of
the dataset. As we have the data features contained in the columns, the
value of <code>rowvar</code> needs to be set to False. (You can check
what happens if you set it to ‘True’. Instead of a 2x2 matrix for two
columns you will get a 18x18 matrix for eighteen pair comparisons.)
</p>
<p style="text-align: justify;">
We mentioned that the values of the <span class="math inline">\(PCC\)</span> are calculated such that they must
lie between -1 and 1. This is achieved by normalisation with the
variance. If, for any reason, we don’t want the similarity calculated
using this normalisation, what results is the so-called
<strong>covariance</strong>. In contrast to the <span class="math inline">\(PCC\)</span>, its values will depend on the
absolute size of the numbers in the data array. From the NumPy library,
we can use the function <kbd>cov</kbd> in order to calculate the
covariance:
</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> cov</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>cov_matrix <span class="op">=</span> cov(everley_numpy, rowvar<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="bu">print</span>(cov_matrix)</span></code></pre>
</div>
<p>[[ 1.70733842 -3.62631625] [ -3.62631625 115.70986192]]</p>
<p style="text-align: justify;">
The result shows how covariance is strongly dependent on the actual
numerical values in a data column. The two values along the diagonal are
identical with the variances obtained by squaring the standard deviation
(calculated, for example, using the <kbd>describe</kbd> function).
</p>
<div id="practice-exercise-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="practice-exercise-3" class="callout-inner">
<h3 class="callout-title">Practice Exercise 3</h3>
<div class="callout-content">
<p><strong>Correlations from the patients dataset</strong></p>
<p>Calculate the Pearson <span class="math inline">\(PCC\)</span>
between the systolic and the diastolic blood pressure from the patients
data using:</p>
<ol style="list-style-type: lower-roman">
<li><p>The Pandas DataFrame and</p></li>
<li><p>The data as a NumPy array.</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Q1 </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>df <span class="op">=</span> read_csv(<span class="st">'data/patients.csv'</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>df[[<span class="st">'Systolic'</span>, <span class="st">'Diastolic'</span>]].corr()</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>       <span class="ex">Systolic</span>  Diastolic</span></code></pre>
</div>
<p>Systolic 1.000000 0.511843 Diastolic 0.511843 1.000000</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Q2 </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>df_SysDia_numpy <span class="op">=</span> df[[<span class="st">'Systolic'</span>, <span class="st">'Diastolic'</span>]].to_numpy()</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>df_SysDia_corr <span class="op">=</span> corrcoef(df_SysDia_numpy, rowvar<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Correlation coefficient between Systole and Diastole:'</span>, <span class="bu">round</span>(df_SysDia_corr[<span class="dv">0</span>, <span class="dv">1</span>], <span class="dv">2</span>))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Correlation coefficient between Systole and Diastole: 0.51</code></pre>
</div>
<p style="text-align: justify;">
It is worth noting that it is equally possible to calculate the
correlation between rows of a two-dimension array
(i.e. <code>rowvar=True</code>) but the interpretation will differ.
Imagine a dataset where for two subjects a large number, call it <span class="math inline">\(N\)</span>, of metabolites were determined
quantitatively (a Metabolomics dataset). If that dataset is of shape (2,
N) then one can calculate the correlation between the two rows. This
would be done to determine the correlation of the metabolite profiles
between the two subjects.
</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="the-correlation-matrix">The Correlation Matrix<a class="anchor" aria-label="anchor" href="#the-correlation-matrix"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
If we have more than two columns of data, we can obtain a Pearson
correlation coefficient for each pair. In general, for N columns, we get
<span class="math inline">\(N^2\)</span> pairwise values. We will omit
the correlations of each column relative to itself, of which there are
<span class="math inline">\(N\)</span>, which means we are left with
<span class="math inline">\(N*(N-1)\)</span> pairs. Since each value
appears twice, due to the symmetry of the calculation, we can ignore
half of them, leaving us with <span class="math inline">\(N*(N-1) /
2\)</span> coefficients for <span class="math inline">\(N\)</span>
columns.
</p>
<p>Here is an example using the ‘patients’ data:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>df <span class="op">=</span> read_csv(<span class="st">'data/patients.csv'</span>)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>df.corr()</span></code></pre>
</div>
<p>ValueError: could not convert string to float: ‘Male’</p>
<p style="text-align: justify;">
If we do the calculation with the Pandas DataFrame, the ‘Gender’ is
automatically ignored and, by default, we get <span class="math inline">\(6*5/2=15\)</span> coefficients for the remaining
six columns. Note that the values that involves the ‘Smoker’ column are
meaningless, since they represent a True/False-like binary.
</p>
<p>Let us now convert the DataFrame into a NumPy array, and check its
shape:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>patients_numpy <span class="op">=</span> df.to_numpy()</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>patients_numpy.shape</span></code></pre>
</div>
<p>(100, 7)</p>
<p style="text-align: justify;">
Next, we can try to calculate the correlation matrix for the first five
columns of this data array. If we do this directly to the array, we get
an AttributeError: ‘float’ object has no attribute ‘shape’.
</p>
<p style="text-align: justify;">
This is amended by converting the array to a floating point prior to
using the <kbd>corrcoef</kbd> function. For this, we can convert the
data type using the method <code>astype(float)</code>:
</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>cols <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>patients_numpy_float <span class="op">=</span> patients_numpy[:, :cols].astype(<span class="bu">float</span>)</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>patients_corr <span class="op">=</span> corrcoef(patients_numpy_float, rowvar<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>patients_corr</span></code></pre>
</div>
<p>array([[1. , 0.11600246, 0.09135615, 0.13412699, 0.08059714],
[0.11600246, 1. , 0.6959697 , 0.21407555, 0.15681869], [0.09135615,
0.6959697 , 1. , 0.15578811, 0.22268743], [0.13412699, 0.21407555,
0.15578811, 1. , 0.51184337], [0.08059714, 0.15681869, 0.22268743,
0.51184337, 1. ]])</p>
<p style="text-align: justify;">
The result is called the <strong>correlation matrix</strong>. It
contains all the bivariate comparisons possible for the five chosen
columns.
</p>
<p style="text-align: justify;">
In the calculation above, we used the <span class="math inline">\(PCC\)</span> in order to calculate the matrix. In
general, any bivariate measure can be used to obtain a matrix of the
same shape.
</p>
<div class="section level3">
<h3 id="heatmaps-in-matplotlib">
<strong>Heatmaps in Matplotlib</strong><a class="anchor" aria-label="anchor" href="#heatmaps-in-matplotlib"></a>
</h3>
<p style="text-align: justify;">
To get an illustration of the correlation pattern in a dataset, we can
plot the correlation matrix as a heatmap.
</p>
<p style="text-align: justify;">
Below are three lines of code, that make use of functionality within
<code>Matplotlib</code>, to plot a heatmap of the correlation matrix
from the ‘patients’ dataset. We make use of the function
<kbd>imshow</kbd>:
</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">5</span>,<span class="dv">5</span>))</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>im <span class="op">=</span> ax.imshow(patients_corr, cmap<span class="op">=</span><span class="st">'coolwarm'</span>)<span class="op">;</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-21-11.png" width="480" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
Note: we have specified the colour map <code>coolwarm</code>, using the
keyword argument <code>cmap</code>. For a list of
<code>Matplotlib</code> colour maps, please refer to the <a href="https://matplotlib.org/3.1.1/gallery/color/colormap_reference.html" class="external-link">gallery
in the documentation</a>. The names to use in the code are on the left
hand side of the colour bar.
</p>
Let us add two more features to improve this figure.
<p style="text-align: justify;">
Firstly, in order to highlight true correlations stand out (rather than
the trivial self-correlations along the diagonal, which are always equal
to 1) we can deliberately set the diagonal as being equal to 0. To
achieve this, we use the NumPy function <kbd>fill_diagonal</kbd>.
</p>
<p style="text-align: justify;">
Secondly, the <kbd>imshow</kbd> function, by default, will scale the
colours to the minimum and maximum values present in the array. As such,
we do not know what red or blue means. To see the colour bar, it can be
added to the figure environment ‘fig’ using <code>colorbar</code>.
</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> fill_diagonal</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>fill_diagonal(patients_corr, <span class="dv">0</span>)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">7</span>,<span class="dv">7</span>))</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>im <span class="op">=</span> ax.imshow(patients_corr, cmap<span class="op">=</span><span class="st">'coolwarm'</span>)<span class="op">;</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>fig.colorbar(im, orientation<span class="op">=</span><span class="st">'horizontal'</span>, shrink<span class="op">=</span><span class="fl">0.7</span>)<span class="op">;</span></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-22-13.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
The result is that the correlation between columns ‘Height’ and ‘Weight’
is the strongest, and presumably higher than would be expected if these
two measures were independent. We can confirm this by plotting a scatter
plot for these two columns, and refer to the scatter plot for columns 2
(Height) and 5 (Diastolic blood pressure):
</p>
<div id="practice-exercise-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="practice-exercise-4" class="callout-inner">
<h3 class="callout-title">Practice Exercise 4</h3>
<div class="callout-content">
<strong>Spearman Correlations from the patients dataset</strong>
<p style="text-align: justify;">
Calculate and plot the correlation matrix of the first five columns, as
above, based on the <a href="https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient" class="external-link">Spearman
rank correlation coefficient</a>. This is based on the ranking of values
instead of their numerical values as for the Pearson coefficient.
Spearman therefore tests for monotonic relationships, whereas Pearson
tests for linear relationships.
</p>
<p>To import the function in question:</p>
<pre><code>from scipy.stats import spearmanr</code></pre>
<p>You can then apply it:</p>
<pre><code>data_spearman_corr = spearmanr(data).correlation</code></pre>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7"> Show me the solution </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" data-bs-parent="#accordionSolution7" aria-labelledby="headingSolution7">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> spearmanr</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>patients_numpy <span class="op">=</span> df.to_numpy()</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>cols <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>patients_numpy_float <span class="op">=</span> patients_numpy[:, :cols].astype(<span class="bu">float</span>)</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>patients_spearman <span class="op">=</span> spearmanr(patients_numpy_float).correlation</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>patients_spearman</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>array([[1.        , 0.11636668, 0.09327152, 0.12105741, 0.08703685],
       [0.11636668, 1.        , 0.65614849, 0.20036338, 0.14976559],
       [0.09327152, 0.65614849, 1.        , 0.12185782, 0.19738765],
       [0.12105741, 0.20036338, 0.12185782, 1.        , 0.48666928],
       [0.08703685, 0.14976559, 0.19738765, 0.48666928, 1.        ]])</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> fill_diagonal</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>fill_diagonal(patients_spearman, <span class="dv">0</span>)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">7</span>,<span class="dv">7</span>))</span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>im <span class="op">=</span> ax.imshow(patients_spearman, cmap<span class="op">=</span><span class="st">'coolwarm'</span>)<span class="op">;</span></span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>fig.colorbar(im, orientation<span class="op">=</span><span class="st">'horizontal'</span>, shrink<span class="op">=</span><span class="fl">0.7</span>)<span class="op">;</span></span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-24-15.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="analysis-of-the-correlation-matrix">Analysis of the Correlation matrix<a class="anchor" aria-label="anchor" href="#analysis-of-the-correlation-matrix"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="the-correlation-coefficients">
<strong>The Correlation Coefficients</strong><a class="anchor" aria-label="anchor" href="#the-correlation-coefficients"></a>
</h3>
<p style="text-align: justify;">
To analyse the correlations in a dataset, we are only interested in the
<span class="math inline">\(N*(N-1)/2\)</span> unduplicated correlation
coefficients. Here is a way to extract them and assign them to a
variable.
</p>
<p style="text-align: justify;">
Firstly, we must import the function <kbd>triu_indices</kbd>. It
provides the indices of a matrix with specified size. The required size
is obtained from our correlation matrix, using <kbd>len</kbd>. It is
identical to the number of columns for which we calculated the <span class="math inline">\(CCs\)</span>.
</p>
<p style="text-align: justify;">
We also need to specify that we do not want the diagonal to be included.
For this, there is an offset parameter ‘k’, which collects the indices
excluding the diagonal, provided it is set to 1. (To include the indices
of the diagonal, it would have to be set to 0).
</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> triu_indices</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a><span class="co"># Get the number of rows of the correlation matrix</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>no_cols <span class="op">=</span> <span class="bu">len</span>(patients_corr)</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="co"># Get the indices of the 10 correlation coefficients for 5 data columns</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>corr_coeff_indices <span class="op">=</span> triu_indices(no_cols, k<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a><span class="co"># Get the 10 correlation coefficients</span></span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>corr_coeffs <span class="op">=</span> patients_corr[corr_coeff_indices]</span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a><span class="bu">print</span>(corr_coeffs)</span></code></pre>
</div>
<p>[0.11600246 0.09135615 0.13412699 0.08059714 0.6959697 0.21407555
0.15681869 0.15578811 0.22268743 0.51184337]</p>
<p>Now we plot these correlation coefficients as a bar chart to see them
one next to each other.</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>bins <span class="op">=</span> arange(<span class="bu">len</span>(corr_coeffs))</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>ax.bar(bins, corr_coeffs)<span class="op">;</span></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-26-17.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>If there are a large number of coefficients, we can also display
their histogram or boxplot as summary statistics.</p>
</div>
<div class="section level3">
<h3 id="the-average-correlation-per-column">
<strong>The Average Correlation per Column</strong><a class="anchor" aria-label="anchor" href="#the-average-correlation-per-column"></a>
</h3>
<p style="text-align: justify;">
On a higher level, we can calculate the overall, or average correlation
per data column. This can be achieved by averaging over either the rows
or the columns of the correlation matrix. Because our similarity measure
is undirected, both ways of summing yield the same result.
</p>
<p style="text-align: justify;">
However, we need to consider whether the value is positive or negative.
Correlation coefficients can be either positive or negative. As such,
adding for instance +1 and -1 would yield an average of 0, even though
both indicate perfect correlation and anti-correlation, respectively.
This can be addressed by using the absolute value <code>abs</code>, and
ignoring the sign.
</p>
<p style="text-align: justify;">
In order to average, we can use the NumPy function: <kbd>mean</kbd>.
This function defaults to averaging over all values of the matrix. In
order to obtain the five values by averaging over the columns, we
specify the ‘axis’ keyword argument must be specified as 0.
</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> <span class="bu">abs</span>, mean</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a><span class="co"># Absolute values of correlation matrix</span></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>corr_matrix_abs <span class="op">=</span> <span class="bu">abs</span>(patients_corr)</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a><span class="co"># Average of the correlation strengths</span></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>corr_column_average <span class="op">=</span> mean(corr_matrix_abs, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>bins <span class="op">=</span> arange(corr_column_average.shape[<span class="dv">0</span>])</span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a>ax.bar(bins, corr_column_average )<span class="op">;</span></span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a><span class="bu">print</span>(corr_column_average)</span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a>show()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[0.08441655 0.23657328 0.23316028 0.20316681 0.19438933]</code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-27-19.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
The result is that the average column correlation is on the order of 0.2
for the columns with indices 1 to 4, and less than 0.1 for the column
with index 0 (which is age).
</p>
</div>
<div class="section level3">
<h3 id="the-average-dataset-correlation">
<strong>The Average Dataset Correlation</strong><a class="anchor" aria-label="anchor" href="#the-average-dataset-correlation"></a>
</h3>
<p style="text-align: justify;">
The sum over rows or columns has given us a reduced set of values to
look at. We can now take the final step and average over all correlation
coefficients. This will yield the average correlation of the dataset. It
condenses the full bivariate analysis into a single number, and can be a
starting point when comparing different datasets of the same type, for
example.
</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="co"># Average of the correlation strengths</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>corr_matrix_average <span class="op">=</span> mean(corr_matrix_abs)</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Average correlation strength: '</span>, <span class="bu">round</span>(corr_matrix_average, <span class="dv">3</span>))</span></code></pre>
</div>
<p>Average correlation strength: 0.19</p>
</div>
</section><section><h2 class="section-heading" id="application-the-diabetes-dataset">Application: The Diabetes Dataset<a class="anchor" aria-label="anchor" href="#application-the-diabetes-dataset"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
We now return to the dataset that began our enquiry into DataFrames in
the previous lesson. Let us apply the above, and perform a summary
analysis of its bivariate features.
</p>
<p style="text-align: justify;">
Firstly, import the data. This is one of the example datasets from
scikit-learn: a Python library used for Machine Learning. It is already
included in the Anaconda distribution of Python, and can therefore be
directly imported, if you have installed this.
</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> datasets</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>diabetes <span class="op">=</span> datasets.load_diabetes()</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>data_diabetes <span class="op">=</span> diabetes.data</span></code></pre>
</div>
<p style="text-align: justify;">
For the bivariate features, let us get the correlation matrix and plot
it as a heatmap. We can make use of code that introduced above.
</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> fill_diagonal</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>data_corr_matrix <span class="op">=</span> corrcoef(data_diabetes, rowvar<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>fill_diagonal(data_corr_matrix, <span class="dv">0</span>)</span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a>im <span class="op">=</span> ax.imshow(data_corr_matrix, cmap<span class="op">=</span><span class="st">'coolwarm'</span>)<span class="op">;</span></span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a>fig.colorbar(im, orientation<span class="op">=</span><span class="st">'horizontal'</span>, shrink<span class="op">=</span><span class="fl">0.5</span>)<span class="op">;</span></span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-30-21.png" width="768" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
There is one strongly correlated pair (column indices 4 and 5) and one
strongly anti-correlated pair (column indices 6 and 7).
</p>
<p>Let’s calculate the <span class="math inline">\(10*9/2 = 45\)</span>
correlation coefficients and plot them as a histogram:</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> triu_indices</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>data_corr_coeffs <span class="op">=</span> data_corr_matrix[triu_indices(data_corr_matrix.shape[<span class="dv">0</span>], k<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>ax.hist(data_corr_coeffs, bins<span class="op">=</span><span class="dv">10</span>)<span class="op">;</span></span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-31-23.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
This histogram shows that the data have a distribution that is shifted
towards positive correlations. However, only four values are
(absolutely) larger than 0.5 (three positive, one negative).
</p>
<p>Next, let’s obtain the average (absolute) correlation per column.</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>data_column_average <span class="op">=</span> mean(<span class="bu">abs</span>(data_corr_matrix), axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a>bins <span class="op">=</span> arange(<span class="bu">len</span>(data_column_average))</span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a>ax.bar(bins, data_column_average)<span class="op">;</span></span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a>ax.set_title(<span class="st">'Average Correlation Strength per Column'</span>)</span>
<span id="cb42-9"><a href="#cb42-9" tabindex="-1"></a>ax.set_xticks(arange(<span class="bu">len</span>(diabetes.feature_names)))</span>
<span id="cb42-10"><a href="#cb42-10" tabindex="-1"></a>ax.set_xticklabels(diabetes.feature_names)<span class="op">;</span></span>
<span id="cb42-11"><a href="#cb42-11" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-data_frames_2-rendered-unnamed-chunk-32-25.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>In the plot, note how the column names were extracted from the
‘diabetes’ data using <code>diabetes.feature_names</code>.</p>
<p>Finally, let’s obtain the average correlation of the entire
dataset.</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="co"># Average of the correlation strengths</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>data_corr_matrix_average <span class="op">=</span> mean(<span class="bu">abs</span>(data_corr_matrix))</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Average Correlation Strength: '</span>, <span class="bu">round</span>(data_corr_matrix_average, <span class="dv">3</span>))</span></code></pre>
</div>
<p>Average Correlation Strength: 0.29</p>
</section><section><h2 class="section-heading" id="exercises">Exercises<a class="anchor" aria-label="anchor" href="#exercises"></a>
</h2>
<hr class="half-width">
<div id="end-of-chapter-exercises" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="end-of-chapter-exercises" class="callout-inner">
<h3 class="callout-title">End of chapter Exercises</h3>
<div class="callout-content">
<p><strong>Assignment: The Breast Cancer Dataset</strong></p>
<p>Import the breast cancer dataset using <kbd>read_csv</kbd>. Based on
the code in this lesson, try to do the following:</p>
<ol style="list-style-type: decimal">
<li><p>Get the summary (univariate) statistics of columns 2-10
(accessing indices 1:10) using <kbd>describe</kbd></p></li>
<li><p>Plot the means of each column as a bar chart with standard
deviations displayed as error bars. Why are some bars
invisible?</p></li>
<li><p>Extract the values as a NumPy array using the <kbd>to_numpy</kbd>
function. The shape of the array should be (569, 31).</p></li>
<li><p>Calculate the correlation matrix using <kbd>corrcoef</kbd> from
NumPy and plot it as a heatmap. The shape of the matrix should be (31,
31). Use <code>fill_diagonal</code> to set the diagonal elements to
0.</p></li>
<li><p>Calculate the average column correlation and plot it as a bar
chart.</p></li>
<li><p>Calculate the average correlation strength of the
dataset.</p></li>
</ol>
<p>In case of doubt, try to get help from the respective documentation
available for Pandas DataFrames, NumPy and Matplotlib.</p>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8"> Solutions are provided after assignments are marked. </h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" data-bs-parent="#accordionSolution8" aria-labelledby="headingSolution8">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Quantities based on data from two variables are referred to as
bivariate measures.</li>
<li>Bivariate properties can be studied and visualised using
<code>matplotlib</code> and <code>NumPy</code>.</li>
<li>Multivariate data analyses can help to uncover relationships between
recorded variables.</li>
<li>The functions <code>corr</code> and <code>corrcoef</code> can be
used to calculate the <span class="math inline">\(PCC\)</span>.</li>
<li>A correlation matrix can be visualised as a heatmap.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-03-image_handling"><p>Content from <a href="03-image_handling.html">Image Handling</a></p>
<hr>
<p>Last updated on 2025-01-05 |

        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/03-image_handling.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 120 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p><a href="https://drive.usercontent.google.com/u/1/uc?id=1tM6WLCjhUMvn8fcTyms7CCnh5Wvh7__q&amp;export=download" class="external-link"><strong>Download
chapter PDF (.pdf).</strong></a></p>
<p><a href="https://drive.usercontent.google.com/u/1/uc?id=10XSHRRCH5Sa3JRtVy4utalwucgCAbgm2&amp;export=download" class="external-link"><strong>Download
chapter notebook (.ipynb).</strong></a></p>
<p><a href="https://docs.google.com/forms/d/e/1FAIpQLSdr0capF7jloJhPH3Pki1B3LZoKOG16poOpuVJ7SL2LkwLHQA/viewform?pli=1" class="external-link"><span style="color: rgb(255, 0, 0);"><strong>Mandatory Lesson Feedback
Survey</strong></span></a></p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How to read and process images in Python?</li>
<li>How is an image mask created?</li>
<li>What are colour channels in images?</li>
<li>How do you deal with big images?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understanding 2-dimensional greyscale images</li>
<li>Learning image masking</li>
<li>2-dimensional colour images and colour channels</li>
<li>Decreasing memory load when dealing with images</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<br><p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/Wn2GCHu-Glw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</p>
<p><br></p>
<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/JVx2szMOZc8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</p>
<p><br></p>
<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/xJsCInqgLz4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</p>
<p><br></p>
<div id="prerequisites" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="prerequisites" class="callout-inner">
<h3 class="callout-title">Prerequisites</h3>
<div class="callout-content">
<ul>
<li>NumPy arrays</li>
<li>Plots and subplots with matplotlib</li>
</ul>
</div>
</div>
</div>
<div id="practice-exercises" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="practice-exercises" class="callout-inner">
<h3 class="callout-title">Practice Exercises</h3>
<div class="callout-content">
<p style="text-align: justify;">
This lesson has no explicit practice exercises. At each step, use images
of your own choice to practice. There are many image file formats,
different colour schemes etc for which you can try to find similar or
analogous solutions.
</p>
</div>
</div>
</div>
<section><h2 class="section-heading" id="challenge">Challenge<a class="anchor" aria-label="anchor" href="#challenge"></a>
</h2>
<hr class="half-width"></section><section><h2 class="section-heading" id="reading-and-processing-images">
<strong>Reading and Processing Images</strong><a class="anchor" aria-label="anchor" href="#reading-and-processing-images"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
In biology, we often deal with images; for example, microscopy and
different medical imaging modalities often output images and image data
for analysis. In many cases, we wish to extract some quantitative
information from these images. The focus of this lesson is to read and
process images in Python. This will include:
</p>
<ul>
<li>Working with 2-dimensional greyscale images</li>
<li>Creating and applying binary image masks</li>
<li>Working with 2-dimensional colour images, and interpreting colour
channels</li>
<li>Decreasing the memory for further processing by reducing resolution
or patching</li>
<li>Working with 3-dimensional images</li>
</ul>
<div class="section level3">
<h3 id="image-example">
<strong>Image Example</strong><a class="anchor" aria-label="anchor" href="#image-example"></a>
</h3>
<p>The example in <a href="#ratCerebellum">Figure 1</a> is an image from
the cell <a href="http://cellimagelibrary.org/home" class="external-link">image library</a>
with the following description:</p>
<blockquote>
<p>“Midsaggital section of rat cerebellum, captured using confocal
imaging. Section shows inositol trisphosphate receptor (IP3R) labelled
in green, DNA in blue, and synaptophysin in magenta. Honorable Mention,
2010 Olympus BioScapes Digital Imaging Competition®.”</p>
</blockquote>
<p style="text-align: justify;">
Given this information, we might want to determine the relative amounts
of IP3R, DNA and synaptophysin in this image. This tutorial will guide
you through some of the steps to get you started with processing images
of all types, using Python. You can then refer back to this image
analysis example, and perform some analyses of your own.
</p>
<figure id="ratCerebellum"><img src="../fig/rat_cerebellum.jpg" alt="Figure 1: Example image, rat cerebellum" class="figure mx-auto d-block"><div class="figcaption">Figure 1: Example image, rat cerebellum</div>
</figure>
</div>
<div class="section level3">
<h3 id="work-through-example">Work-Through Example<a class="anchor" aria-label="anchor" href="#work-through-example"></a>
</h3>
</div>
</section><section><h2 class="section-heading" id="reading-and-plotting-a-2-dimensional-image">
<strong>Reading and Plotting a 2-Dimensional Image</strong><a class="anchor" aria-label="anchor" href="#reading-and-plotting-a-2-dimensional-image"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
Firstly, we must read an image in. To demonstrate this we can use the
example of a histological slice through an axon bundle. We use
Matplotlib’s image module, from which we import the function
<code>imread</code>, used to store the image in a variable that we will
name <code>img</code>. The function <code>imread</code> can interpret
many different image formats, including .jpg, .png and .tif images.
</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">from</span> matplotlib.image <span class="im">import</span> imread</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>img <span class="op">=</span> imread(<span class="st">'fig/axon_slice.jpg'</span>)</span></code></pre>
</div>
<p>We can then check what type of variable is, using the type()
function:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(img))</span></code></pre>
</div>
<p>&lt;class ‘numpy.ndarray’&gt;</p>
<p>This tells us that the image is stored in a NumPy array;
<code>ndarray</code> here refers to an N-dimensional array. We can check
some other properties of this array, for example, what the image
dimensions are, using the .shape attribute:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="bu">print</span>(img.shape)</span></code></pre>
</div>
<p>(2300, 3040)</p>
<p style="text-align: justify;">
This tells us that our image is composed of 2300 by 3040 data units, or
<em>pixels</em> as we are dealing with an image. The total number of
pixels in the image, is equivalent to its resolution. In digital
imaging, a pixel is simply a numerical value that represents either
intensity, in a greyscale image; or colour in a colour image. Therefore,
as data, a two-dimensional (2-D) greyscale image comprises a 2-D array
of these intensity values, or elements; hence the name ‘pixel’ is an
amalgamation of ‘picture’ and ‘element’. The array in our example has
two dimensions, and so we can expect the image to be 2-D as well. Let us
now use matplotlib.pyplot’s <code>imshow</code> function to plot the
image to see what it looks like. We can set the colour map to
<code>gray</code> in order to overwrite the default colour map.
</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> subplots, show</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">25</span>, <span class="dv">15</span>))</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>ax.imshow(img, cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-image_handling-rendered-unnamed-chunk-4-1.png" width="2400" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
<code>imshow</code> has allowed us to plot the NumPy array of our image
data as a picture. The figure is divided up into a number of pixels, and
each of these is assigned an intensity value, which is held in the NumPy
array. Let’s have a closer look by selecting a smaller region of our
image and plotting that.
</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> subplots, show</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">25</span>, <span class="dv">15</span>))</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>ax.imshow(img[:<span class="dv">50</span>, :<span class="dv">70</span>], cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-image_handling-rendered-unnamed-chunk-5-3.png" width="2400" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
By using <code>img[:50, :70]</code> we can select the first 50 values
from the first dimension, and the first 70 values from the second
dimension. Note that using a colon denotes ‘all’, where ‘:50’ is
inclusive of every number up to 50, for example. Thus, the image above
shows a very small part of the upper left corner of our original image.
As we are now zoomed in quite close to that corner, we can easily see
the individual pixels here.
</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">25</span>, <span class="dv">15</span>))</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>ax.imshow(img[:<span class="dv">20</span>, :<span class="dv">15</span>], cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-image_handling-rendered-unnamed-chunk-6-5.png" width="2400" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
We have now displayed an even smaller section from that same upper left
corner of the image. Each square is a pixel and it has a single grey
value. Thus, the pixel intensity values are assigned by the numbers
stored in the NumPy array, <code>img</code>. Let us have a look at these
values by producing a slice from the array.
</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="bu">print</span>(img[:<span class="dv">20</span>, :<span class="dv">15</span>])</span></code></pre>
</div>
<p>[[ 18 9 3 4 4 1 2 7 6 8 10 12 13 14 13] [ 14 7 3 4 4 2 2 6 6 7 9 11
12 12 12] [ 8 3 1 3 5 3 2 4 6 7 8 9 10 10 9] [ 2 0 0 2 4 4 3 2 6 6 7 8 8
8 8] [ 0 0 0 1 3 5 3 1 6 6 7 7 8 9 10] [ 0 0 0 0 2 6 5 0 7 7 7 8 9 11
13] [ 0 2 1 0 1 6 5 1 8 8 8 10 11 14 17] [ 1 3 2 0 0 6 6 1 9 9 9 10 13
16 19] [ 1 0 0 1 4 7 8 8 10 12 15 16 18 20 24] [ 1 1 1 2 4 7 8 8 14 16
19 22 24 28 33] [ 4 5 5 6 8 10 12 13 19 22 26 30 34 40 46] [ 9 11 12 13
14 16 18 21 24 27 32 36 42 49 57] [ 12 15 17 18 19 21 25 28 32 34 38 43
49 57 65] [ 14 17 21 23 24 26 32 36 43 45 47 51 56 63 72] [ 18 23 28 31
31 35 41 47 56 57 58 60 64 70 78] [ 24 29 35 38 39 42 50 56 65 65 66 67
69 75 82] [ 32 39 40 44 51 48 52 69 77 82 83 80 81 89 94] [ 35 43 46 51
58 55 58 74 80 85 88 85 87 94 98] [ 38 50 56 61 69 66 67 80 85 90 94 95
97 102 105] [ 41 56 64 70 78 76 75 84 90 95 100 104 106 109 111]]</p>
<p>Each of these numbers corresponds to an intensity in the specified
colourmap. These numbers range from 0 to 255, implying 256 shades of
grey.</p>
<p style="text-align: justify;">
We chose <code>cmap = gray</code>, which assigns darker grey colours to
smaller numbers, and lighter grey colours to higher numbers. However, we
can also pick a non-greyscale colour map to plot the same image. We can
even display a colourbar to keep track of the intensity values.
Matplotlib has a diverse palette of colour maps that you can look
through, linked <a href="https://matplotlib.org/tutorials/colors/colormaps.html" class="external-link">here</a>.
Let’s take a look at two commonly-used Matplotlib colour maps called
<code>viridis</code> and <code>magma</code>:
</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">25</span>, <span class="dv">15</span>))</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>p1 <span class="op">=</span> ax[<span class="dv">0</span>].imshow(img[:<span class="dv">20</span>, :<span class="dv">15</span>], cmap<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>p2 <span class="op">=</span> ax[<span class="dv">1</span>].imshow(img[:<span class="dv">20</span>, :<span class="dv">15</span>], cmap<span class="op">=</span><span class="st">'magma'</span>)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>fig.colorbar(p1, ax<span class="op">=</span>ax[<span class="dv">0</span>], shrink <span class="op">=</span> <span class="fl">0.8</span>)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>fig.colorbar(p2, ax<span class="op">=</span>ax[<span class="dv">1</span>], shrink <span class="op">=</span> <span class="fl">0.8</span>)<span class="op">;</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-image_handling-rendered-unnamed-chunk-8-7.png" width="2400" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
Note, that even though we can plot our greyscale image with colourful
colour schemes, it still does not qualify as a colour image. These are
just false-colour, Matplotlib-overlayed interpretations of rudimentary
intensity values. The reason for this is that a pixel in a standard
colour image actually comprises <strong>three sets</strong> of
intensities per pixel; not just the one, as in this greyscale example.
In the case above, the number in the array represented a grey value and
the colour was assigned to that grey value by <code>Matplotlib</code>.
These represent ‘false’ colours.
</p>
</section><section><h2 class="section-heading" id="creating-an-image-mask">
<strong>Creating an Image Mask</strong><a class="anchor" aria-label="anchor" href="#creating-an-image-mask"></a>
</h2>
<hr class="half-width">
<p>Now that we know that images essentially comprise arrays of numerical
intensities held in a NumPy array, we can start processing images using
these numbers.</p>
<p style="text-align: justify;">
As an initial approach, we can plot a histogram of the intensity values
that comprise an image. We can make use of the <code>.flatten()</code>
method to turn the original 2300 x 3040 array into a one-dimensional
array with 6,992,000 values. This rearrangement allows the numbers
within the image to be represented by a single column inside a matrix or
DataFrame.
</p>
<p>The histogram plot shows how several instances of each intensity make
up this image:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>ax.hist(img.flatten(), bins <span class="op">=</span> <span class="dv">50</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Pixel intensity"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-image_handling-rendered-unnamed-chunk-9-9.png" width="960" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
The histogram is a distribution, with intensities mostly lying between
values of 50 and 250.
<p style="text-align: justify;">
The image displays a slice through an axon bundle. For the sake of
example, let’s say that we are now interested in the myelin sheath
surrounding the axons (the dark rings). We can create a
<strong>mask</strong> that isolates pixels whose intensity value is
below a certain threshold (because darker pixels have lower intensity
values). Everything below this threshold can be assigned to, for
instance, a value of 1 (representing True), and everything above will be
assigned a value of 0 (representing False). This is called a binary or
Boolean mask.
</p>
<p style="text-align: justify;">
Based on the histogram above, we might want to try adjusting that
threshold somewhere between 100 and 200. Let’s see what we get with a
threshold set to 125. Firstly, we must implement a conditional statement
in order to create the mask. It is then possible to apply this mask to
the image. The result can be that we plot both the mask and the masked
image.
</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>threshold <span class="op">=</span> <span class="dv">125</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>mask <span class="op">=</span> img <span class="op">&lt;</span> threshold</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>img_masked <span class="op">=</span> img<span class="op">*</span>mask</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>ax[<span class="dv">0</span>].imshow(mask, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Binary mask'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>ax[<span class="dv">1</span>].imshow(img_masked, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Masked image'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-image_handling-rendered-unnamed-chunk-10-11.png" width="1920" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
The left subplot shows the binary mask itself. White represents values
where our condition is true, and black where our condition is false. The
right image shows the original image after we have applied the binary
mask, it shows the original pixel intensities in regions where the mask
value is true.
</p>
<p style="text-align: justify;">
Note that applying the mask means that the intensities where the
condition is true are left unchanged. The intensities where the
condition is false are multiplied by zero, and therefore set to zero.
</p>
<p>Let’s have a look at the resulting image histograms.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">5</span>))</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>ax[<span class="dv">0</span>].hist(img_masked.flatten(), bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Histogram of masked image'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">"Pixel intensity"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>ax[<span class="dv">1</span>].hist(img_masked[img_masked <span class="op">!=</span> <span class="dv">0</span>].flatten(), bins<span class="op">=</span><span class="dv">25</span>)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Histogram of masked image after zeros are removed'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">"Pixel intensity"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-image_handling-rendered-unnamed-chunk-11-13.png" width="1920" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
The left subplot displays the values for the masked image. Note that
there is a large peak at zero, as a large part of the image is masked.
The right subplot histogram, however, displays only the non-zero pixel
intensities. From this, we can see that our mask has worked as expected,
where only values up to 125 are found. This is because our threshold
causes a sharp cut-off at a pixel intensity of 125.
</p>
</section><section><h2 class="section-heading" id="colour-images">Colour Images<a class="anchor" aria-label="anchor" href="#colour-images"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
So far, our image has had a single intensity value for each pixel. In
colour images, we have multiple channels of information per pixel; most
commonly, colour images are RGB, comprising three corresponding to
intensities of red, green and blue. There are many other formats of
colour image, but these will be beyond the scope of this lesson. In a
RGB colour image, any colour will be a composite of the intensity value
for each of these colours. Our chosen example for a colour image is one
of the rat cerebellar cortex. Let us firstly import it and check its
shape.
</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>img_col <span class="op">=</span> imread(<span class="st">'fig/rat_brain_low_res.jpg'</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>img_col.shape</span></code></pre>
</div>
<p>(929, 1000, 3)</p>
<p style="text-align: justify;">
Our image array now contains three dimensions: the first two are the
spatial dimensions corresponding to the pixel positions as x-y
coordinates. The third dimension contains the three colour channels,
corresponding to three layers of intensity values (red, blue and green)
on top of each other, per pixel. First, let us plot the entire image
using Matplotlib’s imshow method.
</p>
<p>First, let us plot the whole image.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">25</span>, <span class="dv">15</span>))</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>ax.imshow(img_col)<span class="op">;</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-image_handling-rendered-unnamed-chunk-13-15.png" width="2400" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
The sample is labeled for Hoechst stain (blue), the Inositol
trisphosphate (IP3) receptor (green) and Glial fibrillary acidic protein
(GFAP) (red).
<p style="text-align: justify;">
We can then visualise the three colour channels individually by slicing
the NumPy array comprising our image. The stack with index 0 corresponds
to ‘red’, index 1 corresponds to ‘green’ and index 2 corresponds to
‘blue’:
</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>red_channel   <span class="op">=</span> img_col[:, :, <span class="dv">0</span>]</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>green_channel <span class="op">=</span> img_col[:, :, <span class="dv">1</span>]</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>blue_channel  <span class="op">=</span> img_col[:, :, <span class="dv">2</span>]</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>imgplot_red <span class="op">=</span> ax[<span class="dv">0</span>].imshow(red_channel, cmap<span class="op">=</span><span class="st">"Reds"</span>)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>imgplot_green <span class="op">=</span> ax[<span class="dv">1</span>].imshow(green_channel, cmap<span class="op">=</span><span class="st">"Greens"</span>)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>imgplot_blue <span class="op">=</span> ax[<span class="dv">2</span>].imshow(blue_channel, cmap<span class="op">=</span><span class="st">"Blues"</span>)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>fig.colorbar(imgplot_red, ax<span class="op">=</span>ax[<span class="dv">0</span>], shrink<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>fig.colorbar(imgplot_green, ax<span class="op">=</span>ax[<span class="dv">1</span>], shrink<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>fig.colorbar(imgplot_blue, ax<span class="op">=</span>ax[<span class="dv">2</span>], shrink<span class="op">=</span><span class="fl">0.4</span>)<span class="op">;</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-image_handling-rendered-unnamed-chunk-15-17.png" width="1920" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
This shows what colour combinations each of the pixels is made up of.
Notice that the intensities go up to 255. This is because RGB (red,
green and blue) colours are defined within an intensity range of 0-255.
This gives a vast total 16,777,216 possible colour combinations.
</p>
<p>We can plot histograms of each of the colour channels.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">5</span>))</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>ax[<span class="dv">0</span>].hist(red_channel.flatten(), bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">"Pixel intensity"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">"Red channel"</span>)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>ax[<span class="dv">1</span>].hist(green_channel.flatten(), bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">"Pixel intensity"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">"Green channel"</span>)</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>ax[<span class="dv">2</span>].hist(blue_channel.flatten(), bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>ax[<span class="dv">2</span>].set_xlabel(<span class="st">"Pixel intensity"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>ax[<span class="dv">2</span>].set_xlabel(<span class="st">"Blue channel"</span>)</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-image_handling-rendered-unnamed-chunk-16-19.png" width="1920" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="dealing-with-large-images">
<strong>Dealing with Large Images</strong><a class="anchor" aria-label="anchor" href="#dealing-with-large-images"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
Often, we encounter situations where we have to deal with very large
images that are composed of many pixels. Images such as these are often
difficult to process, as they can require a lot of computer memory to do
so. We will explore two different strategies for dealing with this
problem - decreasing resolution, and using patches from the original
image. To demonstrate this, we can make use of the full-resolution
version of the rat brain image in the previous example.
</p>
<p style="text-align: justify;">
Since the file is quite large, and this is an instructional course where
you may wish to use one of our provided GitHub Codespaces to practise
these examples, we will use an online, remotely-hosted copy of the
image.
</p>
<p style="text-align: justify;">
In order to do this, we will firstly store our image URL in a variable
for ease of handling:
</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># URL to the remotely hosted PNG image</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://media.githubusercontent.com/media/L2D-Assets/Assets/refs/heads/master/rat_brain.png"</span></span></code></pre>
</div>
<p style="text-align: justify;">
Next, we must bypass the validation of the server’s certificate, for
ease. SSL stands for Secure Sockets Layer, which is a standard way of
providing an encrypted connection between a server and a client. As this
is an instructional material, we are disabling this, as we trust the
issuing author of the source file (ourselves).
</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="im">import</span> ssl</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co"># Disable SSL verification</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>ssl_context <span class="op">=</span> ssl._create_unverified_context()</span></code></pre>
</div>
<p style="text-align: justify;">
Lastly, we must then import the function <code>urlopen</code> and the
class <code>BytesIO</code>, where the former allows us to open the URL
as raw binary data, and the latter wraps this into memory, simulating a
file object. This allows us to work with this online, remotely-hosted
large image, from its remote location. Please be patient - this step can
take time, and will depend on the speed of your internet connection.
</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="im">from</span> urllib.request <span class="im">import</span> urlopen</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> BytesIO</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co"># Consolidate into 'remote_image'</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>remote_image <span class="op">=</span> BytesIO(urlopen(url, context<span class="op">=</span>ssl_context).read())</span></code></pre>
</div>
<p style="text-align: justify;">
Next, we can read the image into Python, using the imread() function.
However, if we do this plainly, we will receive a warning from Python
indicating that the “Image size (324649360 pixels) exceeds limit of
178956970 pixels, could be decompression bomb DOS attack.” This is
alludes to a potential malicious file, designed to crash or cause
disruption by using consuming large amounts of memory.
</p>
<div id="note" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note" class="callout-inner">
<h3 class="callout-title">Note</h3>
<div class="callout-content">
<p>This demonstrates how to read a remotely-hosted image into memory,
and code using this. However, if you wish to try this with a large image
stored locally on your computer you can bypass the steps above and use
the lines of code that is commented out in the cells below, instead of
the line directly above.</p>
</div>
</div>
</div>

<p>We can get around this by changing the maximum pixel limit, for which
we will require the Image module from the Python Imaging Library (PIL).
We will make use of the <code>MAX_IMAGE_PIXELS</code> class-level
attribute in order to do this, as follows:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co"># Disables the decompression bomb check:</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>Image.MAX_IMAGE_PIXELS <span class="op">=</span> <span class="dv">1000000000</span></span></code></pre>
</div>
<p>Let’s try to use <code>imread</code>, again. Please be patient, as
this may take a moment to execute.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># Use 'remote_image' with imread:</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>img_hr <span class="op">=</span> imread(remote_image)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="co"># img_hr = imread('fig/rat_brain.png') # Or for local image processing.</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>img_hr.shape</span></code></pre>
</div>
<p>(17360, 18701, 3)</p>
<p>Now we can plot the full high-resolution image:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">25</span>, <span class="dv">15</span>))</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>ax.imshow(img_hr, cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-image_handling-rendered-unnamed-chunk-22-21.png" width="2400" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
Although now we can plot this image, it does still consist of over 300
million pixels, which could run us into memory problems when attempting
to process it. One approach is simply to reduce the resolution by
importing the image using the Image module from the PIL library: which
we imported in the code given, above. This library gives us a wealth of
tools to process images, including methods to decrease an image’s
resolution. PIL is a very rich library with a multitude of useful tools.
As always, having a look at the official <a href="https://pillow.readthedocs.io/en/stable/" class="external-link">documentation</a> and
playing around with it yourself is highly encouraged.
</p>
<p>We can make use of the <code>resize</code> method to downsample the
image, providing the desired width and height as numerical arguments, as
follows:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># Open the remotely hosted image:</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>img_pil <span class="op">=</span> Image.<span class="bu">open</span>(remote_image) </span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co"># img_pil = Image.open('fig/rat_brain.png') # Or for local image processing.</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>img_small <span class="op">=</span> img_pil.resize((<span class="dv">174</span>, <span class="dv">187</span>))</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(img_small))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'PIL.Image.Image'&gt;</code></pre>
</div>
<p>Plotting should now be considerably quicker.</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">25</span>, <span class="dv">15</span>))</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>ax.imshow(img_small, cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-image_handling-rendered-unnamed-chunk-24-23.png" width="2400" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
Using the above code, we have successfully resized the image to a
resolution of 174 x 187 pixels. It is, however, important to note that
our image is no longer in the format of a NumPy array, but rather it now
has the type <code>PIL.Image.Image</code>. We can, however, easily
convert it back into a NumPy array using the array function, if we so
wish.
</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> array</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>img_numpy <span class="op">=</span> array(img_small)</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(img_numpy))</span></code></pre>
</div>
<p>&lt;class ‘numpy.ndarray’&gt;</p>
<p style="text-align: justify;">
Despite the above, it is often desired to keep images in their full
resolution, as resizing effectively results in a loss of information. An
commonly used, alternative approach to such downsampling is to
<strong>patch</strong> the images. Patching an image essentially divides
the picture up into smaller chunks that are termed patches.
</p>
<p>For this, we can implement functionality from the <a href="https://scikit-learn.org/stable/" class="external-link">Scikit-Learn</a> machine
learning library.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.image <span class="im">import</span> extract_patches_2d</span></code></pre>
</div>
<p>The <code>extract_patches_2d</code> function is used to extract parts
of the image. The shape of each patch, together with the maximal number
of patches, can be specified, as follows:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>patches <span class="op">=</span> extract_patches_2d(img_hr, (<span class="dv">174</span>, <span class="dv">187</span>), max_patches<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>patches.shape</span></code></pre>
</div>
<p>(100, 174, 187, 3)</p>
<p style="text-align: justify;">
When using the <code>.shape</code> attribute, the output given here
shows that the image has been successfully subdivided into 100 patches,
with resolution 174 x 187 pixels, across three channels: red, blue and
green (as this is an RGB, colour image). Note that patching itself can
be a memory-intensive task. Extracting lots and lots of patches may take
a long time. To look at the patches, we can make use of a for loop to
iterate through the first element of the <code>.shape</code> array (the
100 patches), and visualise each one on its own subplot using the
<code>.imshow</code> method, as follows:
</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(nrows<span class="op">=</span><span class="dv">10</span>, ncols<span class="op">=</span><span class="dv">10</span>, figsize<span class="op">=</span>(<span class="dv">25</span>, <span class="dv">25</span>))</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>ax <span class="op">=</span> ax.flatten()</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> <span class="bu">range</span>(patches.shape[<span class="dv">0</span>]):</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>    ax[index].imshow(patches[index, :, :, :])</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-image_handling-rendered-unnamed-chunk-28-25.png" width="2400" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Working with these smaller, individual patches will be much more
manageable and computationally resourceful.</p>
</section><section><h2 class="section-heading" id="d-images">
<strong>3-D Images</strong><a class="anchor" aria-label="anchor" href="#d-images"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
So far, we have covered how to handle two-dimensional image data in a
variety of ways. But scenarios will often arise whereby the analysis of
three-dimensional image data is required. A good example of such 3-D
images that is commonly encountered, is MRI scans. These don’t natively
exist as .csv format, but are often delivered in specialised image
formats. One such format is nii: the <strong>Neuroimaging Informatics
Technology Initiative (NIfTI)</strong> open file format. Handling these
types of images requires specialised software. In particular, we will be
using an open-source library called <strong>nibabel</strong>.
Documentation for this package is available at <a href="https://nipy.org/nibabel/" class="external-link uri">https://nipy.org/nibabel/</a>.
</p>
<p>As it is not contained in your Python installation by default, it
needs to be installed first.</p>
<p>Two methods for installing this, are given here. If you have
previously installed the <strong>Anaconda distribution</strong> of
Python, paste the following onto your command line or terminal, and hit
return:</p>
<pre><code>conda install -c conda-forge nibabel</code></pre>
<p>Alternatively, you can also install it using Python’s default package
installer ‘pip’ by pasting the following onto your command line or
terminal, and hitting return:</p>
<pre><code>pip install nibabel</code></pre>
<p>in your command line or terminal.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="im">import</span> nibabel <span class="im">as</span> nib</span></code></pre>
</div>
<p>The package is now available for use. To shorten how we call on the
nibabel package in our code, we can use the above import statement,
using the alias nib to refer to <code>nibabel</code>. Thus we can call
on any function in nibabel, by using <code>nib</code> is followed by a
period and the name of that specific function, as follows:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>img_3d <span class="op">=</span> nib.load(<span class="st">'fig/brain.nii'</span>)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>img_data <span class="op">=</span> img_3d.get_fdata()</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(img_data))</span></code></pre>
</div>
<p>&lt;class ‘numpy.memmap’&gt;</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="bu">print</span>(img_data.shape)</span></code></pre>
</div>
<p>(256, 256, 124)</p>
<p style="text-align: justify;">
We can see that the .shape attribute revelas that this image has three
dimensions, and a total of 256 x 256 x 124 volume pixels (or voxels). To
visualise our image, we can plot one slice at a time. The example below
shows three different slices, in the transverse direction (from chin to
the top of the head). To access an image across the transverse
orientation, a single value is selected from the third dimension of the
image, as follows. As always, the colons indicate that all data on the
remaining two axes is selected and visualised:
</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">25</span>, <span class="dv">15</span>))</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>p1 <span class="op">=</span> ax[<span class="dv">0</span>].imshow(img_data[:, :, <span class="dv">60</span>], cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>p2 <span class="op">=</span> ax[<span class="dv">1</span>].imshow(img_data[:, :, <span class="dv">75</span>], cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>p3 <span class="op">=</span> ax[<span class="dv">2</span>].imshow(img_data[:, :, <span class="dv">90</span>], cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>fig.colorbar(p1, ax<span class="op">=</span>ax[<span class="dv">0</span>], shrink<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>fig.colorbar(p2, ax<span class="op">=</span>ax[<span class="dv">1</span>], shrink<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>fig.colorbar(p3, ax<span class="op">=</span>ax[<span class="dv">2</span>], shrink<span class="op">=</span><span class="fl">0.4</span>)<span class="op">;</span></span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-image_handling-rendered-unnamed-chunk-31-27.png" width="2400" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>These look fairly dark. We can improve the contrast, by adjusting the
intensity range. This requires intentionally overriding the default
values, and specifying our own for the keyword arguments
<code>vmin</code> and <code>vmax</code>.</p>
<p style="text-align: justify;">
The <code>vmin</code> and <code>vmax</code> parameters in matplotlib
define the data range that the colormap (in our case the
<code>grey</code> map) covers; thus they control the range of data
values indicated by the colormap in use. By default, the colormap covers
the complete value range of the supplied data. For instance, in many
images this will typically be somewhere between 0 and 255. If we want to
brighten up the darker shades of grey in our example MRI slices, for
example, we can reduce the value of the <code>vmax</code> parameter.
</p>
<p>Expanding upon the above code:</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">25</span>, <span class="dv">15</span>))</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>p1 <span class="op">=</span> ax[<span class="dv">0</span>].imshow(img_data[:, :, <span class="dv">60</span>], cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">150</span>)</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>p2 <span class="op">=</span> ax[<span class="dv">1</span>].imshow(img_data[:, :, <span class="dv">75</span>], cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">150</span>)</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>p3 <span class="op">=</span> ax[<span class="dv">2</span>].imshow(img_data[:, :, <span class="dv">90</span>], cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">150</span>)</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>fig.colorbar(p1, ax<span class="op">=</span>ax[<span class="dv">0</span>], shrink<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>fig.colorbar(p2, ax<span class="op">=</span>ax[<span class="dv">1</span>], shrink<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>fig.colorbar(p3, ax<span class="op">=</span>ax[<span class="dv">2</span>], shrink<span class="op">=</span><span class="fl">0.4</span>)<span class="op">;</span></span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-image_handling-rendered-unnamed-chunk-32-29.png" width="2400" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>What about the other dimensions? We can also plot coronal and
sagittal slices, for example. But take note that, in this case, the
respective slices have different pixel resolutions. Let us expand our
code even further, to display all three desired viewing planes in our
MRI scan, as follows:</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(nrows<span class="op">=</span><span class="dv">3</span>, ncols<span class="op">=</span><span class="dv">5</span>, figsize<span class="op">=</span>(<span class="dv">26</span>, <span class="dv">18</span>))</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>t1 <span class="op">=</span> ax[<span class="dv">0</span>, <span class="dv">0</span>].imshow(img_data[:, :, <span class="dv">45</span>].T, cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">150</span>, origin<span class="op">=</span><span class="st">'lower'</span>)</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>t2 <span class="op">=</span> ax[<span class="dv">0</span>, <span class="dv">1</span>].imshow(img_data[:, :, <span class="dv">60</span>].T, cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">150</span>, origin<span class="op">=</span><span class="st">'lower'</span>)</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>t3 <span class="op">=</span> ax[<span class="dv">0</span>, <span class="dv">2</span>].imshow(img_data[:, :, <span class="dv">75</span>].T, cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">150</span>, origin<span class="op">=</span><span class="st">'lower'</span>)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>t4 <span class="op">=</span> ax[<span class="dv">0</span>, <span class="dv">3</span>].imshow(img_data[:, :, <span class="dv">90</span>].T, cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">150</span>, origin<span class="op">=</span><span class="st">'lower'</span>)</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>t5 <span class="op">=</span> ax[<span class="dv">0</span>, <span class="dv">4</span>].imshow(img_data[:, :, <span class="dv">105</span>].T, cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">150</span>, origin<span class="op">=</span><span class="st">'lower'</span>)</span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>c1 <span class="op">=</span> ax[<span class="dv">1</span>, <span class="dv">0</span>].imshow(img_data[:, <span class="dv">50</span>, :].T, cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">150</span>, origin<span class="op">=</span><span class="st">'lower'</span>)</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a>c2 <span class="op">=</span> ax[<span class="dv">1</span>, <span class="dv">1</span>].imshow(img_data[:, <span class="dv">75</span>, :].T, cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">150</span>, origin<span class="op">=</span><span class="st">'lower'</span>)</span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a>c3 <span class="op">=</span> ax[<span class="dv">1</span>, <span class="dv">2</span>].imshow(img_data[:, <span class="dv">90</span>, :].T, cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">150</span>, origin<span class="op">=</span><span class="st">'lower'</span>)</span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a>c4 <span class="op">=</span> ax[<span class="dv">1</span>, <span class="dv">3</span>].imshow(img_data[:, <span class="dv">105</span>, :].T, cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">150</span>, origin<span class="op">=</span><span class="st">'lower'</span>)</span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a>c5 <span class="op">=</span> ax[<span class="dv">1</span>, <span class="dv">4</span>].imshow(img_data[:, <span class="dv">120</span>, :].T, cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">150</span>, origin<span class="op">=</span><span class="st">'lower'</span>)</span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" tabindex="-1"></a>s1 <span class="op">=</span> ax[<span class="dv">2</span>, <span class="dv">0</span>].imshow(img_data[<span class="dv">75</span>, :, :].T, cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">150</span>, origin<span class="op">=</span><span class="st">'lower'</span>)</span>
<span id="cb37-16"><a href="#cb37-16" tabindex="-1"></a>s2 <span class="op">=</span> ax[<span class="dv">2</span>, <span class="dv">1</span>].imshow(img_data[<span class="dv">90</span>, :, :].T, cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">150</span>, origin<span class="op">=</span><span class="st">'lower'</span>)</span>
<span id="cb37-17"><a href="#cb37-17" tabindex="-1"></a>s3 <span class="op">=</span> ax[<span class="dv">2</span>, <span class="dv">2</span>].imshow(img_data[<span class="dv">105</span>, :, :].T, cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">150</span>, origin<span class="op">=</span><span class="st">'lower'</span>)</span>
<span id="cb37-18"><a href="#cb37-18" tabindex="-1"></a>s4 <span class="op">=</span> ax[<span class="dv">2</span>, <span class="dv">3</span>].imshow(img_data[<span class="dv">120</span>, :, :].T, cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">150</span>, origin<span class="op">=</span><span class="st">'lower'</span>)</span>
<span id="cb37-19"><a href="#cb37-19" tabindex="-1"></a>s5 <span class="op">=</span> ax[<span class="dv">2</span>, <span class="dv">4</span>].imshow(img_data[<span class="dv">135</span>, :, :].T, cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">150</span>, origin<span class="op">=</span><span class="st">'lower'</span>)<span class="op">;</span></span>
<span id="cb37-20"><a href="#cb37-20" tabindex="-1"></a></span>
<span id="cb37-21"><a href="#cb37-21" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-image_handling-rendered-unnamed-chunk-33-31.png" width="2496" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The result is that we have clearly visualised slices of our 3-D
image, representing all three viewing planes in this 3-dimensional brain
scan.</p>
</section><section><h2 class="section-heading" id="exercises">Exercises<a class="anchor" aria-label="anchor" href="#exercises"></a>
</h2>
<hr class="half-width">
<div id="end-of-chapter-exercises" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="end-of-chapter-exercises" class="callout-inner">
<h3 class="callout-title">End of chapter Exercises</h3>
<div class="callout-content">
<p><strong>Assignment</strong></p>
<p>Using the image from the beginning of this lesson
(rat_cerebellum.jpg) to perform the following tasks:</p>
<ol style="list-style-type: decimal">
<li><p>Import the image and display it.</p></li>
<li><p>Show histograms for each of the colour channels and plot the
contributions of each of the RGB colours to the final image,
separately.</p></li>
<li><p>Create three different binary masks using manually determined
thresholds: one for mostly red pixels, one for mostly green pixels, and
one for mostly blue pixels. Note that you can apply conditions that are
either greater or smaller than a threshold of your choice.</p></li>
<li><p>Plot the three masks and the corresponding masked
images.</p></li>
<li><p>Using your masks, approximate the relative amounts of
synaptophysin, IP3R, and DNA in the image. To do this, you can assume
that the number of red pixels represents synaptophysin, green pixels
represents IP3R and blue pixels represent DNA. The results will vary
depending on the setting of the thresholds. How do different threshold
values change your results?</p></li>
<li><p>Change the resolution of your image to different values. How does
the resolution affect your results?</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Solutions are provided after assignments are marked.
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>The <code>imread</code> function can be used to read in and
interpret multiple image formats.</li>
<li>Masking isolates pixels whose intensity value is below a certain
threshold.</li>
<li>Colour images typically comprise three channels (corresponding to
red, green and blue intensities).</li>
<li>Python Imaging Library (PIL) helps to set and raise default pixel
limits for reading in and handling larger images.</li>
</ul>
</div>
</div>
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/carpentries/workbench-template-rmd/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries/workbench-template-rmd/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries/workbench-template-rmd/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/69aaefee46a17928e2a1694825599e169b9793e3" class="external-link">sandpaper (0.16.10)</a>, <a href="https://github.com/carpentries/pegboard/tree/bad0be19a12f0c6545801b276ddf26c945f8bfd1" class="external-link">pegboard (0.7.7)</a>, and <a href="https://github.com/milanmlft/varnish/tree/milanmlft/sticky-sidebar" class="external-link">varnish (1.0.3.9000)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://carpentries.github.io/workbench-template-rmd/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://carpentries.github.io/workbench-template-rmd/instructor/aio.html",
  "identifier": "https://carpentries.github.io/workbench-template-rmd/instructor/aio.html",
  "dateCreated": "2022-06-14",
  "dateModified": "2025-01-05",
  "datePublished": "2025-01-05"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

